import{$ as nt,$a as fa,A as Yi,Aa as Qh,B as pt,Ba as Fe,C as Cr,Ca as Le,D as Ce,Da as Ue,E as Rr,Ea as Mr,F as Ee,Fa as es,G as ce,Ga as ts,H as Pt,Ha as Jh,I as mt,Ia as Yh,J as Dr,Ja as Xh,K as Xi,Ka as ns,L as Pr,La as Zh,M as Ye,Ma as ed,N as gt,Na as td,O as Bh,Oa as nd,P as ia,Pa as ha,Q as Y,Qa as Fr,R as X,Ra as Vt,S as sa,Sa as Tn,T as Jt,Ta as rd,U as Nr,Ua as id,V as xe,Va as Ze,W as oa,Wa as sd,X as aa,Xa as od,Y as jh,Ya as ad,Z as ca,Za as da,_ as qh,_a as cd,a as me,aa as Gh,ab as pa,b as Me,ba as ua,bb as ud,ca as kr,d as A,da as G,e as Ar,ea as Ie,f as Qi,fa as $h,g as Vh,ga as zh,h as xh,ha as Zi,i as Xo,ia as la,j as Zo,ja as Wh,k as ea,ka as Vr,l as br,la as Nt,m as Ji,ma as kt,n as Oh,na as Hh,o as ze,oa as Xe,p as Mh,pa as _t,q as ta,qa as Kh,r as Fh,ra as V,s as na,sa as M,t as ra,ta as xr,u as En,ua as We,v as In,va as ue,w as Qt,wa as $,x as Lh,xa as B,y as Uh,ya as wn,z as Sr,za as Or}from"./chunk-YEMWCELP.js";var _a=class extends id{constructor(){super(...arguments),this.supportsDOMEvents=!0}},ya=class n extends _a{static makeCurrent(){rd(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=Eg();return t==null?null:Ig(t)}resetBaseElement(){Lr=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return sd(document.cookie,e)}},Lr=null;function Eg(){return Lr=Lr||document.querySelector("base"),Lr?Lr.getAttribute("href"):null}function Ig(n){return new URL(n,document.baseURI).pathname}var wg=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Ce({token:n,factory:n.\u0275fac})}}return n})(),rs=new Ee(""),dd=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new pt(5101,!1);return this._eventNameToPlugin.set(t,r),r}static{this.\u0275fac=function(r){return new(r||n)(ce(rs),ce(xe))}}static{this.\u0275prov=Ce({token:n,factory:n.\u0275fac})}}return n})(),Ur=class{constructor(e){this._doc=e}},ma="ng-app-id",fd=(()=>{class n{constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=pa(o),this.resetHostNodes()}addStyles(t){for(let r of t)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(t){for(let r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){let r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${ma}="${this.appId}"]`);if(t?.length){let r=new Map;return t.forEach(i=>{i.textContent!=null&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){let i=this.styleRef;if(i.has(t)){let o=i.get(t);return o.usage+=r,o.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){let i=this.styleNodesInDOM,o=i?.get(r);if(o?.parentNode===t)return i.delete(r),o.removeAttribute(ma),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=r,this.platformIsServer&&a.setAttribute(ma,this.appId),t.appendChild(a),a}}addStyleToHost(t,r){let i=this.getStyleElement(t,r),o=this.styleRef,a=o.get(r)?.elements;a?a.push(i):o.set(r,{elements:[i],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||n)(ce(Ze),ce(ca),ce(ua,8),ce(nt))}}static{this.\u0275prov=Ce({token:n,factory:n.\u0275fac})}}return n})(),ga={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Ea=/%COMP%/g,pd="%COMP%",Tg=`_nghost-${pd}`,Ag=`_ngcontent-${pd}`,bg=!0,Sg=new Ee("",{providedIn:"root",factory:()=>bg});function Cg(n){return Ag.replace(Ea,n)}function Rg(n){return Tg.replace(Ea,n)}function md(n,e){return e.map(t=>t.replace(Ea,n))}var is=(()=>{class n{constructor(t,r,i,o,a,u,h,d=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=u,this.ngZone=h,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=pa(u),this.defaultRenderer=new Br(t,a,h,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Dr.ShadowDom&&(r=Me(me({},r),{encapsulation:Dr.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof ss?i.applyToHost(t):i instanceof jr&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let a=this.doc,u=this.ngZone,h=this.eventManager,d=this.sharedStylesHost,p=this.removeStylesOnCompDestroy,I=this.platformIsServer;switch(r.encapsulation){case Dr.Emulated:o=new ss(h,d,r,this.appId,p,a,u,I);break;case Dr.ShadowDom:return new va(h,d,t,r,a,u,this.nonce,I);default:o=new jr(h,d,r,p,a,u,I);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||n)(ce(dd),ce(fd),ce(ca),ce(Sg),ce(Ze),ce(nt),ce(xe),ce(ua))}}static{this.\u0275prov=Ce({token:n,factory:n.\u0275fac})}}return n})(),Br=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(ga[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(ld(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(ld(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new pt(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=ga[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=ga[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(kr.DashCase|kr.Important)?e.style.setProperty(t,r,i&kr.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&kr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=Tn().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function ld(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var va=class extends Br{constructor(e,t,r,i,o,a,u,h){super(e,o,a,h),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let d=md(i.id,i.styles);for(let p of d){let I=document.createElement("style");u&&I.setAttribute("nonce",u),I.textContent=p,this.shadowRoot.appendChild(I)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},jr=class extends Br{constructor(e,t,r,i,o,a,u,h){super(e,o,a,u),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=h?md(h,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},ss=class extends jr{constructor(e,t,r,i,o,a,u,h){let d=i+"-"+r.id;super(e,t,r,o,a,u,h,d),this.contentAttr=Cg(d),this.hostAttr=Rg(d)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},Dg=(()=>{class n extends Ur{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||n)(ce(Ze))}}static{this.\u0275prov=Ce({token:n,factory:n.\u0275fac})}}return n})(),Pg=(()=>{class n extends Ur{constructor(t){super(t),this.delegate=Pt(nd,{optional:!0})}supports(t){return this.delegate?this.delegate.supports(t):!1}addEventListener(t,r,i){return this.delegate.addEventListener(t,r,i)}removeEventListener(t,r,i){return this.delegate.removeEventListener(t,r,i)}static{this.\u0275fac=function(r){return new(r||n)(ce(Ze))}}static{this.\u0275prov=Ce({token:n,factory:n.\u0275fac})}}return n})(),hd=["alt","control","meta","shift"],Ng={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},kg={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Vg=(()=>{class n extends Ur{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i){let o=n.parseEventName(r),a=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Tn().onAndCancel(t,o.domEventName,a))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=n._normalizeKey(r.pop()),a="",u=r.indexOf("code");if(u>-1&&(r.splice(u,1),a="code."),hd.forEach(d=>{let p=r.indexOf(d);p>-1&&(r.splice(p,1),a+=d+".")}),a+=o,r.length!=0||o.length===0)return null;let h={};return h.domEventName=i,h.fullKey=a,h}static matchEventFullKeyCode(t,r){let i=Ng[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),hd.forEach(a=>{if(a!==i){let u=kg[a];u(t)&&(o+=a+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{n.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(r){return new(r||n)(ce(Ze))}}static{this.\u0275prov=Ce({token:n,factory:n.\u0275fac})}}return n})();function gd(n,e){return td(me({rootComponent:n},xg(e)))}function xg(n){return{appProviders:[...Ug,...n?.providers??[]],platformProviders:Lg}}function Og(){ya.makeCurrent()}function Mg(){return new oa}function Fg(){return jh(document),document}var Lg=[{provide:nt,useValue:cd},{provide:qh,useValue:Og,multi:!0},{provide:Ze,useFactory:Fg,deps:[]}];var Ug=[{provide:Bh,useValue:"root"},{provide:oa,useFactory:Mg,deps:[]},{provide:rs,useClass:Dg,multi:!0,deps:[Ze,xe,nt]},{provide:rs,useClass:Vg,multi:!0,deps:[Ze]},{provide:rs,useClass:Pg,multi:!0},is,fd,dd,{provide:Zi,useExisting:is},{provide:ud,useClass:wg,deps:[]},[]];var bd=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(r){return new(r||n)(Ie(la),Ie(aa))}}static{this.\u0275dir=Ye({type:n})}}return n})(),Bg=(()=>{class n extends bd{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=sa(n)))(i||n)}})()}static{this.\u0275dir=Ye({type:n,features:[Nt]})}}return n})(),Sd=new Ee("");var jg={provide:Sd,useExisting:Cr(()=>fs),multi:!0};function qg(){let n=Tn()?Tn().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var Gg=new Ee(""),fs=(()=>{class n extends bd{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!qg())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(r){return new(r||n)(Ie(la),Ie(aa),Ie(Gg,8))}}static{this.\u0275dir=Ye({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&ue("input",function(a){return i._handleInput(a.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(a){return i._compositionEnd(a.target.value)})},features:[Mr([jg]),Nt]})}}return n})();function $g(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}var wa=new Ee(""),Cd=new Ee("");function zg(n){return $g(n.value)?{required:!0}:null}function _d(n){return null}function Rd(n){return n!=null}function Dd(n){return Yh(n)?br(n):n}function Pd(n){let e={};return n.forEach(t=>{e=t!=null?me(me({},e),t):e}),Object.keys(e).length===0?null:e}function Nd(n,e){return e.map(t=>t(n))}function Wg(n){return!n.validate}function kd(n){return n.map(e=>Wg(e)?e:t=>e.validate(t))}function Hg(n){if(!n)return null;let e=n.filter(Rd);return e.length==0?null:function(t){return Pd(Nd(t,e))}}function Ta(n){return n!=null?Hg(kd(n)):null}function Kg(n){if(!n)return null;let e=n.filter(Rd);return e.length==0?null:function(t){let r=Nd(t,e).map(Dd);return Fh(r).pipe(ze(Pd))}}function Aa(n){return n!=null?Kg(kd(n)):null}function yd(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Qg(n){return n._rawValidators}function Jg(n){return n._rawAsyncValidators}function Ia(n){return n?Array.isArray(n)?n:[n]:[]}function as(n,e){return Array.isArray(n)?n.includes(e):n===e}function vd(n,e){let t=Ia(e);return Ia(n).forEach(i=>{as(t,i)||t.push(i)}),t}function Ed(n,e){return Ia(e).filter(t=>!as(n,t))}var cs=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Ta(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Aa(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Cn=class extends cs{get formDirective(){return null}get path(){return null}},Hr=class extends cs{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},us=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},Yg={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},NT=Me(me({},Yg),{"[class.ng-submitted]":"isSubmitted"}),Vd=(()=>{class n extends us{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(Ie(Hr,2))}}static{this.\u0275dir=Ye({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&_t("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Nt]})}}return n})(),xd=(()=>{class n extends us{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(Ie(Cn,10))}}static{this.\u0275dir=Ye({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&_t("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Nt]})}}return n})();var qr="VALID",os="INVALID",bn="PENDING",Gr="DISABLED",Rn=class{},ls=class extends Rn{constructor(e,t){super(),this.value=e,this.source=t}},zr=class extends Rn{constructor(e,t){super(),this.pristine=e,this.source=t}},Wr=class extends Rn{constructor(e,t){super(),this.touched=e,this.source=t}},Sn=class extends Rn{constructor(e,t){super(),this.status=e,this.source=t}};function Od(n){return(ps(n)?n.validators:n)||null}function Xg(n){return Array.isArray(n)?Ta(n):n||null}function Md(n,e){return(ps(e)?e.asyncValidators:n)||null}function Zg(n){return Array.isArray(n)?Aa(n):n||null}function ps(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function e_(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new pt(1e3,"");if(!r[t])throw new pt(1001,"")}function t_(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new pt(1002,"")})}var hs=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=Fr(()=>this.statusReactive()),this.statusReactive=Vr(void 0),this._pristine=Fr(()=>this.pristineReactive()),this.pristineReactive=Vr(!0),this._touched=Fr(()=>this.touchedReactive()),this.touchedReactive=Vr(!1),this._events=new Qi,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Vt(this.statusReactive)}set status(e){Vt(()=>this.statusReactive.set(e))}get valid(){return this.status===qr}get invalid(){return this.status===os}get pending(){return this.status==bn}get disabled(){return this.status===Gr}get enabled(){return this.status!==Gr}get pristine(){return Vt(this.pristineReactive)}set pristine(e){Vt(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return Vt(this.touchedReactive)}set touched(e){Vt(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(vd(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(vd(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Ed(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Ed(e,this._rawAsyncValidators))}hasValidator(e){return as(this._rawValidators,e)}hasAsyncValidator(e){return as(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(Me(me({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Wr(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new Wr(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(Me(me({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new zr(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new zr(!0,r))}markAsPending(e={}){this.status=bn;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Sn(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(Me(me({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Gr,this.errors=null,this._forEachChild(i=>{i.disable(Me(me({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ls(this.value,r)),this._events.next(new Sn(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Me(me({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=qr,this._forEachChild(r=>{r.enable(Me(me({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Me(me({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===qr||this.status===bn)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ls(this.value,t)),this._events.next(new Sn(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(Me(me({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Gr:qr}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=bn,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=Dd(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Sn(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new Nr,this.statusChanges=new Nr}_calculateStatus(){return this._allControlsDisabled()?Gr:this.errors?os:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(bn)?bn:this._anyControlsHaveStatus(os)?os:qr}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new zr(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Wr(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){ps(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=Xg(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=Zg(this._rawAsyncValidators)}},ds=class extends hs{constructor(e,t,r){super(Od(t),Md(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){t_(this,!0,e),Object.keys(e).forEach(r=>{e_(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,o)=>{r=t(r,i,o)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var ba=new Ee("CallSetDisabledState",{providedIn:"root",factory:()=>Sa}),Sa="always";function n_(n,e){return[...e.path,n]}function Fd(n,e,t=Sa){Ld(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),i_(n,e),o_(n,e),s_(n,e),r_(n,e)}function Id(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function r_(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Ld(n,e){let t=Qg(n);e.validator!==null?n.setValidators(yd(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=Jg(n);e.asyncValidator!==null?n.setAsyncValidators(yd(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();Id(e._rawValidators,i),Id(e._rawAsyncValidators,i)}function i_(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&Ud(n,e)})}function s_(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&Ud(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function Ud(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function o_(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function a_(n,e){n==null,Ld(n,e)}function c_(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function u_(n){return Object.getPrototypeOf(n.constructor)===Bg}function l_(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function h_(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(o=>{o.constructor===fs?t=o:u_(o)?r=o:i=o}),i||r||t||null}var d_={provide:Cn,useExisting:Cr(()=>Ca)},$r=Promise.resolve(),Ca=(()=>{class n extends Cn{get submitted(){return Vt(this.submittedReactive)}constructor(t,r,i){super(),this.callSetDisabledState=i,this._submitted=Fr(()=>this.submittedReactive()),this.submittedReactive=Vr(!1),this._directives=new Set,this.ngSubmit=new Nr,this.form=new ds({},Ta(t),Aa(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){$r.then(()=>{let r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),Fd(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){$r.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){$r.then(()=>{let r=this._findContainer(t.path),i=new ds({});a_(i,t),r.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){$r.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){$r.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),l_(this.form,this._directives),this.ngSubmit.emit(t),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static{this.\u0275fac=function(r){return new(r||n)(Ie(wa,10),Ie(Cd,10),Ie(ba,8))}}static{this.\u0275dir=Ye({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,i){r&1&&ue("submit",function(a){return i.onSubmit(a)})("reset",function(){return i.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Mr([d_]),Nt]})}}return n})();function wd(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Td(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var f_=class extends hs{constructor(e=null,t,r){super(Od(t),Md(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ps(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Td(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){wd(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){wd(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Td(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var p_={provide:Hr,useExisting:Cr(()=>Ra)},Ad=Promise.resolve(),Ra=(()=>{class n extends Hr{constructor(t,r,i,o,a,u){super(),this._changeDetectorRef=a,this.callSetDisabledState=u,this.control=new f_,this._registered=!1,this.name="",this.update=new Nr,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=h_(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),c_(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Fd(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){Ad.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&ha(r);Ad.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?n_(t,this._parent):[t]}static{this.\u0275fac=function(r){return new(r||n)(Ie(Cn,9),Ie(wa,10),Ie(Cd,10),Ie(Sd,10),Ie(ed,8),Ie(ba,8))}}static{this.\u0275dir=Ye({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Mr([p_]),Nt,ia]})}}return n})(),Bd=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=Ye({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return n})();var m_=(()=>{class n{constructor(){this._validator=_d}ngOnChanges(t){if(this.inputName in t){let r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):_d,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=Ye({type:n,features:[ia]})}}return n})();var g_={provide:wa,useExisting:Cr(()=>Da),multi:!0};var Da=(()=>{class n extends m_{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=ha,this.createValidator=t=>zg}enabled(t){return t}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=sa(n)))(i||n)}})()}static{this.\u0275dir=Ye({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){r&2&&Hh("required",i._enabled?"":null)},inputs:{required:"required"},features:[Mr([g_]),Nt]})}}return n})();var __=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Pr({type:n})}static{this.\u0275inj=Rr({})}}return n})();var jd=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:ba,useValue:t.callSetDisabledState??Sa}]}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Pr({type:n})}static{this.\u0275inj=Rr({imports:[__]})}}return n})();var Gd=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},v_=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],a=n[t++],u=n[t++],h=((i&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{let o=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},$d={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],a=i+1<n.length,u=a?n[i+1]:0,h=i+2<n.length,d=h?n[i+2]:0,p=o>>2,I=(o&3)<<4|u>>4,S=(u&15)<<2|d>>6,C=d&63;h||(C=64,a||(S=64)),r.push(t[p],t[I],t[S],t[C])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Gd(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):v_(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let I=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||u==null||d==null||I==null)throw new Na;let S=o<<2|u>>4;if(r.push(S),d!==64){let C=u<<4&240|d>>2;if(r.push(C),I!==64){let k=d<<6&192|I;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Na=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},E_=function(n){let e=Gd(n);return $d.encodeByteArray(e,!0)},Kr=function(n){return E_(n).replace(/\./g,"")},Va=function(n){try{return $d.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function I_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var w_=()=>I_().__FIREBASE_DEFAULTS__,T_=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},A_=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Va(n[1]);return e&&JSON.parse(e)},gs=()=>{try{return w_()||T_()||A_()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},zd=n=>{var e,t;return(t=(e=gs())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Wd=n=>{let e=zd(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},xa=()=>{var n;return(n=gs())===null||n===void 0?void 0:n.config},Hd=n=>{var e;return(e=gs())===null||e===void 0?void 0:e[`_${n}`]};var ms=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Kd(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Kr(JSON.stringify(t)),Kr(JSON.stringify(a)),""].join(".")}function je(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Qd(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(je())}function b_(){var n;let e=(n=gs())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Jd(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Yd(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Xd(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Zd(){return!b_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Oa(){try{return typeof indexedDB=="object"}catch{return!1}}function ef(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}var S_="FirebaseError",He=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=S_,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yt.prototype.create)}},yt=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?C_(o,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new He(i,u,r)}};function C_(n,e){return n.replace(R_,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var R_=/\{\$([^}]+)}/g;function Dn(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],a=e[i];if(qd(o)&&qd(a)){if(!Dn(o,a))return!1}else if(o!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function qd(n){return n!==null&&typeof n=="object"}function Ma(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function tf(n,e){let t=new ka(n,e);return t.subscribe.bind(t)}var ka=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");D_(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Pa),i.error===void 0&&(i.error=Pa),i.complete===void 0&&(i.complete=Pa);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function D_(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Pa(){}var xT=4*60*60*1e3;function Oe(n){return n&&n._delegate?n._delegate:n}var Ke=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Yt="[DEFAULT]";var Fa=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new ms;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(N_(e))try{this.getOrInitializeService({instanceIdentifier:Yt})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Yt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return A(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Yt){return this.instances.has(e)}getOptions(e=Yt){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(o);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);let a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:P_(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Yt){return this.component?this.component.multipleInstances?e:Yt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function P_(n){return n===Yt?void 0:n}function N_(n){return n.instantiationMode==="EAGER"}var _s=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Fa(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var k_=[],W=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(W||{}),V_={debug:W.DEBUG,verbose:W.VERBOSE,info:W.INFO,warn:W.WARN,error:W.ERROR,silent:W.SILENT},x_=W.INFO,O_={[W.DEBUG]:"log",[W.VERBOSE]:"log",[W.INFO]:"info",[W.WARN]:"warn",[W.ERROR]:"error"},M_=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=O_[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},xt=class{constructor(e){this.name=e,this._logLevel=x_,this._logHandler=M_,this._userLogHandler=null,k_.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in W))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?V_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,W.DEBUG,...e),this._logHandler(this,W.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,W.VERBOSE,...e),this._logHandler(this,W.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,W.INFO,...e),this._logHandler(this,W.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,W.WARN,...e),this._logHandler(this,W.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,W.ERROR,...e),this._logHandler(this,W.ERROR,...e)}};var F_=(n,e)=>e.some(t=>n instanceof t),nf,rf;function L_(){return nf||(nf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function U_(){return rf||(rf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var sf=new WeakMap,Ua=new WeakMap,of=new WeakMap,La=new WeakMap,ja=new WeakMap;function B_(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(rt(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&sf.set(t,n)}).catch(()=>{}),ja.set(e,n),e}function j_(n){if(Ua.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});Ua.set(n,e)}var Ba={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ua.get(n);if(e==="objectStoreNames")return n.objectStoreNames||of.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return rt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function af(n){Ba=n(Ba)}function q_(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(ys(this),e,...t);return of.set(r,e.sort?e.sort():[e]),rt(r)}:U_().includes(n)?function(...e){return n.apply(ys(this),e),rt(sf.get(this))}:function(...e){return rt(n.apply(ys(this),e))}}function G_(n){return typeof n=="function"?q_(n):(n instanceof IDBTransaction&&j_(n),F_(n,L_())?new Proxy(n,Ba):n)}function rt(n){if(n instanceof IDBRequest)return B_(n);if(La.has(n))return La.get(n);let e=G_(n);return e!==n&&(La.set(n,e),ja.set(e,n)),e}var ys=n=>ja.get(n);function uf(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let a=indexedDB.open(n,e),u=rt(a);return r&&a.addEventListener("upgradeneeded",h=>{r(rt(a.result),h.oldVersion,h.newVersion,rt(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var $_=["get","getKey","getAll","getAllKeys","count"],z_=["put","add","delete","clear"],qa=new Map;function cf(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(qa.get(e))return qa.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=z_.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||$_.includes(t)))return;let o=function(a,...u){return A(this,null,function*(){let h=this.transaction(a,i?"readwrite":"readonly"),d=h.store;return r&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),i&&h.done]))[0]})};return qa.set(e,o),o}af(n=>Me(me({},n),{get:(e,t,r)=>cf(e,t)||n.get(e,t,r),has:(e,t)=>!!cf(e,t)||n.has(e,t)}));var $a=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(W_(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function W_(n){let e=n.getComponent();return e?.type==="VERSION"}var za="@firebase/app",lf="0.10.11";var vt=new xt("@firebase/app"),H_="@firebase/app-compat",K_="@firebase/analytics-compat",Q_="@firebase/analytics",J_="@firebase/app-check-compat",Y_="@firebase/app-check",X_="@firebase/auth",Z_="@firebase/auth-compat",ey="@firebase/database",ty="@firebase/database-compat",ny="@firebase/functions",ry="@firebase/functions-compat",iy="@firebase/installations",sy="@firebase/installations-compat",oy="@firebase/messaging",ay="@firebase/messaging-compat",cy="@firebase/performance",uy="@firebase/performance-compat",ly="@firebase/remote-config",hy="@firebase/remote-config-compat",dy="@firebase/storage",fy="@firebase/storage-compat",py="@firebase/firestore",my="@firebase/vertexai-preview",gy="@firebase/firestore-compat",_y="firebase",yy="10.13.2";var Wa="[DEFAULT]",vy={[za]:"fire-core",[H_]:"fire-core-compat",[Q_]:"fire-analytics",[K_]:"fire-analytics-compat",[Y_]:"fire-app-check",[J_]:"fire-app-check-compat",[X_]:"fire-auth",[Z_]:"fire-auth-compat",[ey]:"fire-rtdb",[ty]:"fire-rtdb-compat",[ny]:"fire-fn",[ry]:"fire-fn-compat",[iy]:"fire-iid",[sy]:"fire-iid-compat",[oy]:"fire-fcm",[ay]:"fire-fcm-compat",[cy]:"fire-perf",[uy]:"fire-perf-compat",[ly]:"fire-rc",[hy]:"fire-rc-compat",[dy]:"fire-gcs",[fy]:"fire-gcs-compat",[py]:"fire-fst",[gy]:"fire-fst-compat",[my]:"fire-vertex","fire-js":"fire-js",[_y]:"fire-js-all"};var Qr=new Map,Ey=new Map,Ha=new Map;function hf(n,e){try{n.container.addComponent(e)}catch(t){vt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Mt(n){let e=n.name;if(Ha.has(e))return vt.debug(`There were multiple attempts to register component ${e}.`),!1;Ha.set(e,n);for(let t of Qr.values())hf(t,n);for(let t of Ey.values())hf(t,n);return!0}function Ya(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Pn(n){return n.settings!==void 0}var Iy={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ot=new yt("app","Firebase",Iy);var Ka=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ke("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ot.create("app-deleted",{appName:this._name})}};var Nn=yy;function Xa(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Wa,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Ot.create("bad-app-name",{appName:String(i)});if(t||(t=xa()),!t)throw Ot.create("no-options");let o=Qr.get(i);if(o){if(Dn(t,o.options)&&Dn(r,o.config))return o;throw Ot.create("duplicate-app",{appName:i})}let a=new _s(i);for(let h of Ha.values())a.addComponent(h);let u=new Ka(t,r,a);return Qr.set(i,u),u}function Yr(n=Wa){let e=Qr.get(n);if(!e&&n===Wa&&xa())return Xa();if(!e)throw Ot.create("no-app",{appName:n});return e}function vs(){return Array.from(Qr.values())}function _e(n,e,t){var r;let i=(r=vy[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){let u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),vt.warn(u.join(" "));return}Mt(new Ke(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var wy="firebase-heartbeat-database",Ty=1,Jr="firebase-heartbeat-store",Ga=null;function mf(){return Ga||(Ga=uf(wy,Ty,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Jr)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ot.create("idb-open",{originalErrorMessage:n.message})})),Ga}function Ay(n){return A(this,null,function*(){try{let t=(yield mf()).transaction(Jr),r=yield t.objectStore(Jr).get(gf(n));return yield t.done,r}catch(e){if(e instanceof He)vt.warn(e.message);else{let t=Ot.create("idb-get",{originalErrorMessage:e?.message});vt.warn(t.message)}}})}function df(n,e){return A(this,null,function*(){try{let r=(yield mf()).transaction(Jr,"readwrite");yield r.objectStore(Jr).put(e,gf(n)),yield r.done}catch(t){if(t instanceof He)vt.warn(t.message);else{let r=Ot.create("idb-set",{originalErrorMessage:t?.message});vt.warn(r.message)}}})}function gf(n){return`${n.name}!${n.options.appId}`}var by=1024,Sy=30*24*60*60*1e3,Qa=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Ja(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return A(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=ff();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let u=new Date(a.date).valueOf();return Date.now()-u<=Sy}),this._storage.overwrite(this._heartbeatsCache))}catch(r){vt.warn(r)}})}getHeartbeatsHeader(){return A(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=ff(),{heartbeatsToSend:r,unsentEntries:i}=Cy(this._heartbeatsCache.heartbeats),o=Kr(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return vt.warn(t),""}})}};function ff(){return new Date().toISOString().substring(0,10)}function Cy(n,e=by){let t=[],r=n.slice();for(let i of n){let o=t.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),pf(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),pf(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Ja=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return A(this,null,function*(){return Oa()?ef().then(()=>!0).catch(()=>!1):!1})}read(){return A(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield Ay(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return A(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return df(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return A(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return df(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function pf(n){return Kr(JSON.stringify({version:2,heartbeats:n})).length}function Ry(n){Mt(new Ke("platform-logger",e=>new $a(e),"PRIVATE")),Mt(new Ke("heartbeat",e=>new Qa(e),"PRIVATE")),_e(za,lf,n),_e(za,lf,"esm2017"),_e("fire-js","")}Ry("");var Dy="firebase",Py="10.13.2";_e(Dy,Py,"app");var Vn=new ts("ANGULARFIRE2_VERSION");function ec(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(a=>a.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Zr=(n,e)=>{let t=e?[e]:vs(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},Xr=class{constructor(){return Zr(Ny)}},Ny="app-check";function kn(){}var Es=class{zone;delegate;constructor(e,t=xh){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(o,t,r)}},Za=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",kn,{},kn,kn)),t.pipe(Yi({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},ei=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Es(Zone.current)),this.insideAngular=t.run(()=>new Es(Zone.current,Vh)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(ce(xe))};static \u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Is(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function ky(n){return Is().ngZone.runOutsideAngular(()=>n())}function Xt(n){return Is().ngZone.run(()=>n())}function Vy(n){return xy(Is())(n)}function xy(n){return function(t){return t=t.lift(new Za(n.ngZone)),t.pipe(ea(n.outsideAngular),Zo(n.insideAngular))}}var Oy=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Xt(()=>n.apply(void 0,r))},et=(n,e)=>function(){let t,r=arguments;for(let o=0;o<arguments.length;o++)typeof r[o]=="function"&&(e&&(t||=Xt(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",kn,{},kn,kn))),r[o]=Oy(r[o],t));let i=ky(()=>n.apply(this,r));if(!e)if(i instanceof Ar){let o=Is();return i.pipe(ea(o.outsideAngular),Zo(o.insideAngular))}else return Xt(()=>i);return i instanceof Ar?i.pipe(Vy):i instanceof Promise?Xt(()=>new Promise((o,a)=>i.then(u=>Xt(()=>o(u)),u=>Xt(()=>a(u))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Xt(()=>i)};var Zt=class{constructor(e){return e}},ti=class{constructor(){return vs()}};function My(n){return n&&n.length===1?n[0]:new Zt(Yr())}var tc=new Ee("angularfire2._apps"),Fy={provide:Zt,useFactory:My,deps:[[new mt,tc]]},Ly={provide:ti,deps:[[new mt,tc]]};function Uy(n){return(e,t)=>{let r=t.get(nt);_e("angularfire",Vn.full,"core"),_e("angularfire",Vn.full,"app"),_e("angular",Jh.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Zt(i)}}function _f(n,...e){return gt([Fy,Ly,{provide:tc,useFactory:Uy(n),multi:!0,deps:[xe,Jt,ei,...e]}])}var yf=et(Xa,!0);function Sf(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Cf=Sf,Rf=new yt("auth","Firebase",Sf());var bs=new xt("@firebase/auth");function jy(n,...e){bs.logLevel<=W.WARN&&bs.warn(`Auth (${Nn}): ${n}`,...e)}function Ts(n,...e){bs.logLevel<=W.ERROR&&bs.error(`Auth (${Nn}): ${n}`,...e)}function vf(n,...e){throw fc(n,...e)}function dc(n,...e){return fc(n,...e)}function Df(n,e,t){let r=Object.assign(Object.assign({},Cf()),{[e]:t});return new yt("auth","Firebase",r).create(e,{appName:n.name})}function As(n){return Df(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function fc(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Rf.create(n,...e)}function te(n,e,...t){if(!n)throw fc(e,...t)}function ni(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Ts(e),new Error(e)}function Ss(n,e){n||ni(e)}function qy(){return Ef()==="http:"||Ef()==="https:"}function Ef(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function Gy(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(qy()||Yd()||"connection"in navigator)?navigator.onLine:!0}function $y(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var tn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ss(t>e,"Short delay should be less than long delay!"),this.isMobile=Qd()||Xd()}get(){return Gy()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function zy(n,e){Ss(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Cs=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ni("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ni("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ni("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var Wy={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var Hy=new tn(3e4,6e4);function Pf(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function Ns(o,a,u,h){return A(this,arguments,function*(n,e,t,r,i={}){return Nf(n,i,()=>A(this,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let I=Ma(Object.assign({key:n.config.apiKey},p)).slice(1),S=yield n._getAdditionalHeaders();S["Content-Type"]="application/json",n.languageCode&&(S["X-Firebase-Locale"]=n.languageCode);let C=Object.assign({method:e,headers:S},d);return Jd()||(C.referrerPolicy="no-referrer"),Cs.fetch()(kf(n,n.config.apiHost,t,I),C)}))})}function Nf(n,e,t){return A(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},Wy),e);try{let i=new ic(n),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield o.json();if("needConfirmation"in a)throw ws(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{let u=o.ok?a.errorMessage:a.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw ws(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw ws(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw ws(n,"user-disabled",a);let p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Df(n,p,d);vf(n,p)}}catch(i){if(i instanceof He)throw i;vf(n,"network-request-failed",{message:String(i)})}})}function kf(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?zy(n.config,i):`${n.config.apiScheme}://${i}`}var ic=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(dc(this.auth,"network-request-failed")),Hy.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function ws(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=dc(n,e,r);return i.customData._tokenResponse=t,i}function Ky(n,e){return A(this,null,function*(){return Ns(n,"POST","/v1/accounts:delete",e)})}function Vf(n,e){return A(this,null,function*(){return Ns(n,"POST","/v1/accounts:lookup",e)})}function ri(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function pc(n,e=!1){return A(this,null,function*(){let t=Oe(n),r=yield t.getIdToken(e),i=xf(r);te(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:r,authTime:ri(nc(i.auth_time)),issuedAtTime:ri(nc(i.iat)),expirationTime:ri(nc(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}})}function nc(n){return Number(n)*1e3}function xf(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ts("JWT malformed, contained fewer than 3 sections"),null;try{let i=Va(t);return i?JSON.parse(i):(Ts("Failed to decode base64 JWT payload"),null)}catch(i){return Ts("Caught error parsing JWT payload as JSON",i?.toString()),null}}function If(n){let e=xf(n);return te(e,"internal-error"),te(typeof e.exp<"u","internal-error"),te(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function sc(n,e,t=!1){return A(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof He&&Qy(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function Qy({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var oc=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>A(this,null,function*(){yield this.iteration()}),t)}iteration(){return A(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var si=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ri(this.lastLoginAt),this.creationTime=ri(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Rs(n){return A(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield sc(n,Vf(t,{idToken:r}));te(i?.users.length,t,"internal-error");let o=i.users[0];n._notifyReloadListener(o);let a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?Of(o.providerUserInfo):[],u=Jy(n.providerData,a),h=n.isAnonymous,d=!(n.email&&o.passwordHash)&&!u?.length,p=h?d:!1,I={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new si(o.createdAt,o.lastLoginAt),isAnonymous:p};Object.assign(n,I)})}function mc(n){return A(this,null,function*(){let e=Oe(n);yield Rs(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function Jy(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Of(n){return n.map(e=>{var{providerId:t}=e,r=Xo(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function Yy(n,e){return A(this,null,function*(){let t=yield Nf(n,{},()=>A(this,null,function*(){let r=Ma({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,a=kf(n,i,"/v1/token",`key=${o}`),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",Cs.fetch()(a,{method:"POST",headers:u,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function Xy(n,e){return A(this,null,function*(){return Ns(n,"POST","/v2/accounts:revokeToken",Pf(n,e))})}var ii=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){te(e.idToken,"internal-error"),te(typeof e.idToken<"u","internal-error"),te(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):If(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){te(e.length!==0,"internal-error");let t=If(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return A(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(te(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return A(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:o}=yield Yy(e,t);this.updateTokensAndExpiration(r,i,Number(o))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,a=new n;return r&&(te(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(te(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(te(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return ni("not implemented")}};function Ft(n,e){te(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var oi=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=Xo(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new oc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new si(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){return A(this,null,function*(){let t=yield sc(this,this.stsTokenManager.getToken(this.auth,e));return te(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return pc(this,e)}reload(){return mc(this)}_assign(e){this!==e&&(te(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){te(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return A(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Rs(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return A(this,null,function*(){if(Pn(this.auth.app))return Promise.reject(As(this.auth));let e=yield this.getIdToken();return yield sc(this,Ky(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,a,u,h,d,p;let I=(r=t.displayName)!==null&&r!==void 0?r:void 0,S=(i=t.email)!==null&&i!==void 0?i:void 0,C=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,k=(a=t.photoURL)!==null&&a!==void 0?a:void 0,x=(u=t.tenantId)!==null&&u!==void 0?u:void 0,N=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,z=(d=t.createdAt)!==null&&d!==void 0?d:void 0,K=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:Q,emailVerified:se,isAnonymous:Ne,providerData:ne,stsTokenManager:v}=t;te(Q&&v,e,"internal-error");let m=ii.fromJSON(this.name,v);te(typeof Q=="string",e,"internal-error"),Ft(I,e.name),Ft(S,e.name),te(typeof se=="boolean",e,"internal-error"),te(typeof Ne=="boolean",e,"internal-error"),Ft(C,e.name),Ft(k,e.name),Ft(x,e.name),Ft(N,e.name),Ft(z,e.name),Ft(K,e.name);let _=new n({uid:Q,auth:e,email:S,emailVerified:se,displayName:I,isAnonymous:Ne,photoURL:k,phoneNumber:C,tenantId:x,stsTokenManager:m,createdAt:z,lastLoginAt:K});return ne&&Array.isArray(ne)&&(_.providerData=ne.map(y=>Object.assign({},y))),N&&(_._redirectEventId=N),_}static _fromIdTokenResponse(e,t,r=!1){return A(this,null,function*(){let i=new ii;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Rs(o),o})}static _fromGetAccountInfoResponse(e,t,r){return A(this,null,function*(){let i=t.users[0];te(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?Of(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,u=new ii;u.updateFromIdToken(r);let h=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new si(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(h,d),h})}};var wf=new Map;function en(n){Ss(n instanceof Function,"Expected a class definition");let e=wf.get(n);return e?(Ss(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,wf.set(n,e),e)}var Zy=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return A(this,null,function*(){return!0})}_set(t,r){return A(this,null,function*(){this.storage[t]=r})}_get(t){return A(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return A(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),ac=Zy;function rc(n,e,t){return`firebase:${n}:${e}:${t}`}var Ds=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=rc(this.userKey,i.apiKey,o),this.fullPersistenceKey=rc("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return A(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?oi._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return A(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return A(this,null,function*(){if(!t.length)return new n(en(ac),e,r);let i=(yield Promise.all(t.map(d=>A(this,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),o=i[0]||en(ac),a=rc(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let p=yield d._get(a);if(p){let I=oi._fromJSON(e,p);d!==o&&(u=I),o=d;break}}catch{}let h=i.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new n(o,e,r):(o=h[0],u&&(yield o._set(a,u.toJSON())),yield Promise.all(t.map(d=>A(this,null,function*(){if(d!==o)try{yield d._remove(a)}catch{}}))),new n(o,e,r))})}};function Tf(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(rv(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ev(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(sv(e))return"Blackberry";if(ov(e))return"Webos";if(tv(e))return"Safari";if((e.includes("chrome/")||nv(e))&&!e.includes("edge/"))return"Chrome";if(iv(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function ev(n=je()){return/firefox\//i.test(n)}function tv(n=je()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function nv(n=je()){return/crios\//i.test(n)}function rv(n=je()){return/iemobile/i.test(n)}function iv(n=je()){return/android/i.test(n)}function sv(n=je()){return/blackberry/i.test(n)}function ov(n=je()){return/webos/i.test(n)}function Mf(n,e=[]){let t;switch(n){case"Browser":t=Tf(je());break;case"Worker":t=`${Tf(je())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Nn}/${r}`}var cc=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((a,u)=>{try{let h=e(o);a(h)}catch(h){u(h)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return A(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function av(t){return A(this,arguments,function*(n,e={}){return Ns(n,"GET","/v2/passwordPolicy",Pf(n,e))})}var cv=6,uc=class{constructor(e){var t,r,i,o;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:cv,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,a,u;let h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var lc=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ps(this),this.idTokenSubscription=new Ps(this),this.beforeStateQueue=new cc(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Rf,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=en(t)),this._initializationPromise=this.queue(()=>A(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Ds.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return A(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return A(this,null,function*(){try{let t=yield Vf(this,{idToken:e}),r=yield oi._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return A(this,null,function*(){var t;if(Pn(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,h=yield this.tryRedirectSignIn(e);(!a||a===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return te(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return A(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return A(this,null,function*(){try{yield Rs(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=$y()}_delete(){return A(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return A(this,null,function*(){if(Pn(this.app))return Promise.reject(As(this));let t=e?Oe(e):null;return t&&te(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return A(this,null,function*(){if(!this._deleted)return e&&te(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>A(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return A(this,null,function*(){return Pn(this.app)?Promise.reject(As(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Pn(this.app)?Promise.reject(As(this)):this.queue(()=>A(this,null,function*(){yield this.assertedPersistence.setPersistence(en(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return A(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return A(this,null,function*(){let e=yield av(this),t=new uc(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new yt("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return A(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield Xy(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return A(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return A(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&en(e)||this._popupRedirectResolver;te(t,this,"argument-error"),this.redirectPersistenceManager=yield Ds.create(this,[en(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return A(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>A(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return A(this,null,function*(){if(e===this.currentUser)return this.queue(()=>A(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(te(u,this,"internal-error"),u.then(()=>{a||o(this.currentUser)}),typeof t=="function"){let h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{let h=e.addObserver(t);return()=>{a=!0,h()}}}directlySetCurrentUser(e){return A(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return te(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Mf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return A(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return A(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&jy(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function uv(n){return Oe(n)}var Ps=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=tf(t=>this.observer=t)}get next(){return te(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var lv={loadJS(){return A(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function hv(n){lv=n}function dv(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function fv(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(en);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}var N0=dv("rcb"),k0=new tn(3e4,6e4);var V0=new tn(2e3,1e4);var x0=10*60*1e3;var O0=new tn(3e4,6e4);var M0=new tn(5e3,15e3);var F0=encodeURIComponent("fac");var Af="@firebase/auth",bf="1.7.9";var hc=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return A(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){te(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function pv(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function mv(n){Mt(new Ke("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;te(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let h={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Mf(n)},d=new lc(r,i,o,h);return fv(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Mt(new Ke("auth-internal",e=>{let t=uv(e.getProvider("auth").getImmediate());return(r=>new hc(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),_e(Af,bf,pv(n)),_e(Af,bf,"esm2017")}var gv=5*60,L0=Hd("authIdTokenMaxAge")||gv;function _v(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}hv({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=dc("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",_v().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});mv("Browser");var gE="auth";var ks=class{constructor(){return Zr(gE)}};var Ff=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Lf={};var Lt,gc;(function(){var n;function e(v,m){function _(){}_.prototype=m.prototype,v.D=m.prototype,v.prototype=new _,v.prototype.constructor=v,v.C=function(y,E,T){for(var g=Array(arguments.length-2),ht=2;ht<arguments.length;ht++)g[ht-2]=arguments[ht];return m.prototype[E].apply(y,g)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(v,m,_){_||(_=0);var y=Array(16);if(typeof m=="string")for(var E=0;16>E;++E)y[E]=m.charCodeAt(_++)|m.charCodeAt(_++)<<8|m.charCodeAt(_++)<<16|m.charCodeAt(_++)<<24;else for(E=0;16>E;++E)y[E]=m[_++]|m[_++]<<8|m[_++]<<16|m[_++]<<24;m=v.g[0],_=v.g[1],E=v.g[2];var T=v.g[3],g=m+(T^_&(E^T))+y[0]+3614090360&4294967295;m=_+(g<<7&4294967295|g>>>25),g=T+(E^m&(_^E))+y[1]+3905402710&4294967295,T=m+(g<<12&4294967295|g>>>20),g=E+(_^T&(m^_))+y[2]+606105819&4294967295,E=T+(g<<17&4294967295|g>>>15),g=_+(m^E&(T^m))+y[3]+3250441966&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(T^_&(E^T))+y[4]+4118548399&4294967295,m=_+(g<<7&4294967295|g>>>25),g=T+(E^m&(_^E))+y[5]+1200080426&4294967295,T=m+(g<<12&4294967295|g>>>20),g=E+(_^T&(m^_))+y[6]+2821735955&4294967295,E=T+(g<<17&4294967295|g>>>15),g=_+(m^E&(T^m))+y[7]+4249261313&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(T^_&(E^T))+y[8]+1770035416&4294967295,m=_+(g<<7&4294967295|g>>>25),g=T+(E^m&(_^E))+y[9]+2336552879&4294967295,T=m+(g<<12&4294967295|g>>>20),g=E+(_^T&(m^_))+y[10]+4294925233&4294967295,E=T+(g<<17&4294967295|g>>>15),g=_+(m^E&(T^m))+y[11]+2304563134&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(T^_&(E^T))+y[12]+1804603682&4294967295,m=_+(g<<7&4294967295|g>>>25),g=T+(E^m&(_^E))+y[13]+4254626195&4294967295,T=m+(g<<12&4294967295|g>>>20),g=E+(_^T&(m^_))+y[14]+2792965006&4294967295,E=T+(g<<17&4294967295|g>>>15),g=_+(m^E&(T^m))+y[15]+1236535329&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(E^T&(_^E))+y[1]+4129170786&4294967295,m=_+(g<<5&4294967295|g>>>27),g=T+(_^E&(m^_))+y[6]+3225465664&4294967295,T=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(T^m))+y[11]+643717713&4294967295,E=T+(g<<14&4294967295|g>>>18),g=_+(T^m&(E^T))+y[0]+3921069994&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^T&(_^E))+y[5]+3593408605&4294967295,m=_+(g<<5&4294967295|g>>>27),g=T+(_^E&(m^_))+y[10]+38016083&4294967295,T=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(T^m))+y[15]+3634488961&4294967295,E=T+(g<<14&4294967295|g>>>18),g=_+(T^m&(E^T))+y[4]+3889429448&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^T&(_^E))+y[9]+568446438&4294967295,m=_+(g<<5&4294967295|g>>>27),g=T+(_^E&(m^_))+y[14]+3275163606&4294967295,T=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(T^m))+y[3]+4107603335&4294967295,E=T+(g<<14&4294967295|g>>>18),g=_+(T^m&(E^T))+y[8]+1163531501&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^T&(_^E))+y[13]+2850285829&4294967295,m=_+(g<<5&4294967295|g>>>27),g=T+(_^E&(m^_))+y[2]+4243563512&4294967295,T=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(T^m))+y[7]+1735328473&4294967295,E=T+(g<<14&4294967295|g>>>18),g=_+(T^m&(E^T))+y[12]+2368359562&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(_^E^T)+y[5]+4294588738&4294967295,m=_+(g<<4&4294967295|g>>>28),g=T+(m^_^E)+y[8]+2272392833&4294967295,T=m+(g<<11&4294967295|g>>>21),g=E+(T^m^_)+y[11]+1839030562&4294967295,E=T+(g<<16&4294967295|g>>>16),g=_+(E^T^m)+y[14]+4259657740&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^T)+y[1]+2763975236&4294967295,m=_+(g<<4&4294967295|g>>>28),g=T+(m^_^E)+y[4]+1272893353&4294967295,T=m+(g<<11&4294967295|g>>>21),g=E+(T^m^_)+y[7]+4139469664&4294967295,E=T+(g<<16&4294967295|g>>>16),g=_+(E^T^m)+y[10]+3200236656&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^T)+y[13]+681279174&4294967295,m=_+(g<<4&4294967295|g>>>28),g=T+(m^_^E)+y[0]+3936430074&4294967295,T=m+(g<<11&4294967295|g>>>21),g=E+(T^m^_)+y[3]+3572445317&4294967295,E=T+(g<<16&4294967295|g>>>16),g=_+(E^T^m)+y[6]+76029189&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^T)+y[9]+3654602809&4294967295,m=_+(g<<4&4294967295|g>>>28),g=T+(m^_^E)+y[12]+3873151461&4294967295,T=m+(g<<11&4294967295|g>>>21),g=E+(T^m^_)+y[15]+530742520&4294967295,E=T+(g<<16&4294967295|g>>>16),g=_+(E^T^m)+y[2]+3299628645&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(E^(_|~T))+y[0]+4096336452&4294967295,m=_+(g<<6&4294967295|g>>>26),g=T+(_^(m|~E))+y[7]+1126891415&4294967295,T=m+(g<<10&4294967295|g>>>22),g=E+(m^(T|~_))+y[14]+2878612391&4294967295,E=T+(g<<15&4294967295|g>>>17),g=_+(T^(E|~m))+y[5]+4237533241&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~T))+y[12]+1700485571&4294967295,m=_+(g<<6&4294967295|g>>>26),g=T+(_^(m|~E))+y[3]+2399980690&4294967295,T=m+(g<<10&4294967295|g>>>22),g=E+(m^(T|~_))+y[10]+4293915773&4294967295,E=T+(g<<15&4294967295|g>>>17),g=_+(T^(E|~m))+y[1]+2240044497&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~T))+y[8]+1873313359&4294967295,m=_+(g<<6&4294967295|g>>>26),g=T+(_^(m|~E))+y[15]+4264355552&4294967295,T=m+(g<<10&4294967295|g>>>22),g=E+(m^(T|~_))+y[6]+2734768916&4294967295,E=T+(g<<15&4294967295|g>>>17),g=_+(T^(E|~m))+y[13]+1309151649&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~T))+y[4]+4149444226&4294967295,m=_+(g<<6&4294967295|g>>>26),g=T+(_^(m|~E))+y[11]+3174756917&4294967295,T=m+(g<<10&4294967295|g>>>22),g=E+(m^(T|~_))+y[2]+718787259&4294967295,E=T+(g<<15&4294967295|g>>>17),g=_+(T^(E|~m))+y[9]+3951481745&4294967295,v.g[0]=v.g[0]+m&4294967295,v.g[1]=v.g[1]+(E+(g<<21&4294967295|g>>>11))&4294967295,v.g[2]=v.g[2]+E&4294967295,v.g[3]=v.g[3]+T&4294967295}r.prototype.u=function(v,m){m===void 0&&(m=v.length);for(var _=m-this.blockSize,y=this.B,E=this.h,T=0;T<m;){if(E==0)for(;T<=_;)i(this,v,T),T+=this.blockSize;if(typeof v=="string"){for(;T<m;)if(y[E++]=v.charCodeAt(T++),E==this.blockSize){i(this,y),E=0;break}}else for(;T<m;)if(y[E++]=v[T++],E==this.blockSize){i(this,y),E=0;break}}this.h=E,this.o+=m},r.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var m=1;m<v.length-8;++m)v[m]=0;var _=8*this.o;for(m=v.length-8;m<v.length;++m)v[m]=_&255,_/=256;for(this.u(v),v=Array(16),m=_=0;4>m;++m)for(var y=0;32>y;y+=8)v[_++]=this.g[m]>>>y&255;return v};function o(v,m){var _=u;return Object.prototype.hasOwnProperty.call(_,v)?_[v]:_[v]=m(v)}function a(v,m){this.h=m;for(var _=[],y=!0,E=v.length-1;0<=E;E--){var T=v[E]|0;y&&T==m||(_[E]=T,y=!1)}this.g=_}var u={};function h(v){return-128<=v&&128>v?o(v,function(m){return new a([m|0],0>m?-1:0)}):new a([v|0],0>v?-1:0)}function d(v){if(isNaN(v)||!isFinite(v))return I;if(0>v)return N(d(-v));for(var m=[],_=1,y=0;v>=_;y++)m[y]=v/_|0,_*=4294967296;return new a(m,0)}function p(v,m){if(v.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(v.charAt(0)=="-")return N(p(v.substring(1),m));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(m,8)),y=I,E=0;E<v.length;E+=8){var T=Math.min(8,v.length-E),g=parseInt(v.substring(E,E+T),m);8>T?(T=d(Math.pow(m,T)),y=y.j(T).add(d(g))):(y=y.j(_),y=y.add(d(g)))}return y}var I=h(0),S=h(1),C=h(16777216);n=a.prototype,n.m=function(){if(x(this))return-N(this).m();for(var v=0,m=1,_=0;_<this.g.length;_++){var y=this.i(_);v+=(0<=y?y:4294967296+y)*m,m*=4294967296}return v},n.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(k(this))return"0";if(x(this))return"-"+N(this).toString(v);for(var m=d(Math.pow(v,6)),_=this,y="";;){var E=se(_,m).g;_=z(_,E.j(m));var T=((0<_.g.length?_.g[0]:_.h)>>>0).toString(v);if(_=E,k(_))return T+y;for(;6>T.length;)T="0"+T;y=T+y}},n.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function k(v){if(v.h!=0)return!1;for(var m=0;m<v.g.length;m++)if(v.g[m]!=0)return!1;return!0}function x(v){return v.h==-1}n.l=function(v){return v=z(this,v),x(v)?-1:k(v)?0:1};function N(v){for(var m=v.g.length,_=[],y=0;y<m;y++)_[y]=~v.g[y];return new a(_,~v.h).add(S)}n.abs=function(){return x(this)?N(this):this},n.add=function(v){for(var m=Math.max(this.g.length,v.g.length),_=[],y=0,E=0;E<=m;E++){var T=y+(this.i(E)&65535)+(v.i(E)&65535),g=(T>>>16)+(this.i(E)>>>16)+(v.i(E)>>>16);y=g>>>16,T&=65535,g&=65535,_[E]=g<<16|T}return new a(_,_[_.length-1]&-2147483648?-1:0)};function z(v,m){return v.add(N(m))}n.j=function(v){if(k(this)||k(v))return I;if(x(this))return x(v)?N(this).j(N(v)):N(N(this).j(v));if(x(v))return N(this.j(N(v)));if(0>this.l(C)&&0>v.l(C))return d(this.m()*v.m());for(var m=this.g.length+v.g.length,_=[],y=0;y<2*m;y++)_[y]=0;for(y=0;y<this.g.length;y++)for(var E=0;E<v.g.length;E++){var T=this.i(y)>>>16,g=this.i(y)&65535,ht=v.i(E)>>>16,sr=v.i(E)&65535;_[2*y+2*E]+=g*sr,K(_,2*y+2*E),_[2*y+2*E+1]+=T*sr,K(_,2*y+2*E+1),_[2*y+2*E+1]+=g*ht,K(_,2*y+2*E+1),_[2*y+2*E+2]+=T*ht,K(_,2*y+2*E+2)}for(y=0;y<m;y++)_[y]=_[2*y+1]<<16|_[2*y];for(y=m;y<2*m;y++)_[y]=0;return new a(_,0)};function K(v,m){for(;(v[m]&65535)!=v[m];)v[m+1]+=v[m]>>>16,v[m]&=65535,m++}function Q(v,m){this.g=v,this.h=m}function se(v,m){if(k(m))throw Error("division by zero");if(k(v))return new Q(I,I);if(x(v))return m=se(N(v),m),new Q(N(m.g),N(m.h));if(x(m))return m=se(v,N(m)),new Q(N(m.g),m.h);if(30<v.g.length){if(x(v)||x(m))throw Error("slowDivide_ only works with positive integers.");for(var _=S,y=m;0>=y.l(v);)_=Ne(_),y=Ne(y);var E=ne(_,1),T=ne(y,1);for(y=ne(y,2),_=ne(_,2);!k(y);){var g=T.add(y);0>=g.l(v)&&(E=E.add(_),T=g),y=ne(y,1),_=ne(_,1)}return m=z(v,E.j(m)),new Q(E,m)}for(E=I;0<=v.l(m);){for(_=Math.max(1,Math.floor(v.m()/m.m())),y=Math.ceil(Math.log(_)/Math.LN2),y=48>=y?1:Math.pow(2,y-48),T=d(_),g=T.j(m);x(g)||0<g.l(v);)_-=y,T=d(_),g=T.j(m);k(T)&&(T=S),E=E.add(T),v=z(v,g)}return new Q(E,v)}n.A=function(v){return se(this,v).h},n.and=function(v){for(var m=Math.max(this.g.length,v.g.length),_=[],y=0;y<m;y++)_[y]=this.i(y)&v.i(y);return new a(_,this.h&v.h)},n.or=function(v){for(var m=Math.max(this.g.length,v.g.length),_=[],y=0;y<m;y++)_[y]=this.i(y)|v.i(y);return new a(_,this.h|v.h)},n.xor=function(v){for(var m=Math.max(this.g.length,v.g.length),_=[],y=0;y<m;y++)_[y]=this.i(y)^v.i(y);return new a(_,this.h^v.h)};function Ne(v){for(var m=v.g.length+1,_=[],y=0;y<m;y++)_[y]=v.i(y)<<1|v.i(y-1)>>>31;return new a(_,v.h)}function ne(v,m){var _=m>>5;m%=32;for(var y=v.g.length-_,E=[],T=0;T<y;T++)E[T]=0<m?v.i(T+_)>>>m|v.i(T+_+1)<<32-m:v.i(T+_);return new a(E,v.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,gc=Lf.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,Lt=Lf.Integer=a}).apply(typeof Ff<"u"?Ff:typeof self<"u"?self:typeof window<"u"?window:{});var Vs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Et={};var _c,yc,xn,vc,ai,xs,Ec,Ic,wc;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(s,c,l){return s==Array.prototype||s==Object.prototype||(s[c]=l.value),s};function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof Vs=="object"&&Vs];for(var c=0;c<s.length;++c){var l=s[c];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}var r=t(this);function i(s,c){if(c)e:{var l=r;s=s.split(".");for(var f=0;f<s.length-1;f++){var w=s[f];if(!(w in l))break e;l=l[w]}s=s[s.length-1],f=l[s],c=c(f),c!=f&&c!=null&&e(l,s,{configurable:!0,writable:!0,value:c})}}function o(s,c){s instanceof String&&(s+="");var l=0,f=!1,w={next:function(){if(!f&&l<s.length){var b=l++;return{value:c(b,s[b]),done:!1}}return f=!0,{done:!0,value:void 0}}};return w[Symbol.iterator]=function(){return w},w}i("Array.prototype.values",function(s){return s||function(){return o(this,function(c,l){return l})}});var a=a||{},u=this||self;function h(s){var c=typeof s;return c=c!="object"?c:s?Array.isArray(s)?"array":c:"null",c=="array"||c=="object"&&typeof s.length=="number"}function d(s){var c=typeof s;return c=="object"&&s!=null||c=="function"}function p(s,c,l){return s.call.apply(s.bind,arguments)}function I(s,c,l){if(!s)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var w=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(w,f),s.apply(c,w)}}return function(){return s.apply(c,arguments)}}function S(s,c,l){return S=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:I,S.apply(null,arguments)}function C(s,c){var l=Array.prototype.slice.call(arguments,1);return function(){var f=l.slice();return f.push.apply(f,arguments),s.apply(this,f)}}function k(s,c){function l(){}l.prototype=c.prototype,s.aa=c.prototype,s.prototype=new l,s.prototype.constructor=s,s.Qb=function(f,w,b){for(var P=Array(arguments.length-2),re=2;re<arguments.length;re++)P[re-2]=arguments[re];return c.prototype[w].apply(f,P)}}function x(s){let c=s.length;if(0<c){let l=Array(c);for(let f=0;f<c;f++)l[f]=s[f];return l}return[]}function N(s,c){for(let l=1;l<arguments.length;l++){let f=arguments[l];if(h(f)){let w=s.length||0,b=f.length||0;s.length=w+b;for(let P=0;P<b;P++)s[w+P]=f[P]}else s.push(f)}}class z{constructor(c,l){this.i=c,this.j=l,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function K(s){return/^[\s\xa0]*$/.test(s)}function Q(){var s=u.navigator;return s&&(s=s.userAgent)?s:""}function se(s){return se[" "](s),s}se[" "]=function(){};var Ne=Q().indexOf("Gecko")!=-1&&!(Q().toLowerCase().indexOf("webkit")!=-1&&Q().indexOf("Edge")==-1)&&!(Q().indexOf("Trident")!=-1||Q().indexOf("MSIE")!=-1)&&Q().indexOf("Edge")==-1;function ne(s,c,l){for(let f in s)c.call(l,s[f],f,s)}function v(s,c){for(let l in s)c.call(void 0,s[l],l,s)}function m(s){let c={};for(let l in s)c[l]=s[l];return c}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function y(s,c){let l,f;for(let w=1;w<arguments.length;w++){f=arguments[w];for(l in f)s[l]=f[l];for(let b=0;b<_.length;b++)l=_[b],Object.prototype.hasOwnProperty.call(f,l)&&(s[l]=f[l])}}function E(s){var c=1;s=s.split(":");let l=[];for(;0<c&&s.length;)l.push(s.shift()),c--;return s.length&&l.push(s.join(":")),l}function T(s){u.setTimeout(()=>{throw s},0)}function g(){var s=Co;let c=null;return s.g&&(c=s.g,s.g=s.g.next,s.g||(s.h=null),c.next=null),c}class ht{constructor(){this.h=this.g=null}add(c,l){let f=sr.get();f.set(c,l),this.h?this.h.next=f:this.g=f,this.h=f}}var sr=new z(()=>new Um,s=>s.reset());class Um{constructor(){this.next=this.g=this.h=null}set(c,l){this.h=c,this.g=l,this.next=null}reset(){this.next=this.g=this.h=null}}let or,ar=!1,Co=new ht,kl=()=>{let s=u.Promise.resolve(void 0);or=()=>{s.then(Bm)}};var Bm=()=>{for(var s;s=g();){try{s.h.call(s.g)}catch(l){T(l)}var c=sr;c.j(s),100>c.h&&(c.h++,s.next=c.g,c.g=s)}ar=!1};function St(){this.s=this.s,this.C=this.C}St.prototype.s=!1,St.prototype.ma=function(){this.s||(this.s=!0,this.N())},St.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Te(s,c){this.type=s,this.g=this.target=c,this.defaultPrevented=!1}Te.prototype.h=function(){this.defaultPrevented=!0};var jm=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var s=!1,c=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let l=()=>{};u.addEventListener("test",l,c),u.removeEventListener("test",l,c)}catch{}return s}();function cr(s,c){if(Te.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s){var l=this.type=s.type,f=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;if(this.target=s.target||s.srcElement,this.g=c,c=s.relatedTarget){if(Ne){e:{try{se(c.nodeName);var w=!0;break e}catch{}w=!1}w||(c=null)}}else l=="mouseover"?c=s.fromElement:l=="mouseout"&&(c=s.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=typeof s.pointerType=="string"?s.pointerType:qm[s.pointerType]||"",this.state=s.state,this.i=s,s.defaultPrevented&&cr.aa.h.call(this)}}k(cr,Te);var qm={2:"touch",3:"pen",4:"mouse"};cr.prototype.h=function(){cr.aa.h.call(this);var s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var ur="closure_listenable_"+(1e6*Math.random()|0),Gm=0;function $m(s,c,l,f,w){this.listener=s,this.proxy=null,this.src=c,this.type=l,this.capture=!!f,this.ha=w,this.key=++Gm,this.da=this.fa=!1}function ki(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function Vi(s){this.src=s,this.g={},this.h=0}Vi.prototype.add=function(s,c,l,f,w){var b=s.toString();s=this.g[b],s||(s=this.g[b]=[],this.h++);var P=Do(s,c,f,w);return-1<P?(c=s[P],l||(c.fa=!1)):(c=new $m(c,this.src,b,!!f,w),c.fa=l,s.push(c)),c};function Ro(s,c){var l=c.type;if(l in s.g){var f=s.g[l],w=Array.prototype.indexOf.call(f,c,void 0),b;(b=0<=w)&&Array.prototype.splice.call(f,w,1),b&&(ki(c),s.g[l].length==0&&(delete s.g[l],s.h--))}}function Do(s,c,l,f){for(var w=0;w<s.length;++w){var b=s[w];if(!b.da&&b.listener==c&&b.capture==!!l&&b.ha==f)return w}return-1}var Po="closure_lm_"+(1e6*Math.random()|0),No={};function Vl(s,c,l,f,w){if(f&&f.once)return Ol(s,c,l,f,w);if(Array.isArray(c)){for(var b=0;b<c.length;b++)Vl(s,c[b],l,f,w);return null}return l=Oo(l),s&&s[ur]?s.K(c,l,d(f)?!!f.capture:!!f,w):xl(s,c,l,!1,f,w)}function xl(s,c,l,f,w,b){if(!c)throw Error("Invalid event type");var P=d(w)?!!w.capture:!!w,re=Vo(s);if(re||(s[Po]=re=new Vi(s)),l=re.add(c,l,f,P,b),l.proxy)return l;if(f=zm(),l.proxy=f,f.src=s,f.listener=l,s.addEventListener)jm||(w=P),w===void 0&&(w=!1),s.addEventListener(c.toString(),f,w);else if(s.attachEvent)s.attachEvent(Fl(c.toString()),f);else if(s.addListener&&s.removeListener)s.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return l}function zm(){function s(l){return c.call(s.src,s.listener,l)}let c=Wm;return s}function Ol(s,c,l,f,w){if(Array.isArray(c)){for(var b=0;b<c.length;b++)Ol(s,c[b],l,f,w);return null}return l=Oo(l),s&&s[ur]?s.L(c,l,d(f)?!!f.capture:!!f,w):xl(s,c,l,!0,f,w)}function Ml(s,c,l,f,w){if(Array.isArray(c))for(var b=0;b<c.length;b++)Ml(s,c[b],l,f,w);else f=d(f)?!!f.capture:!!f,l=Oo(l),s&&s[ur]?(s=s.i,c=String(c).toString(),c in s.g&&(b=s.g[c],l=Do(b,l,f,w),-1<l&&(ki(b[l]),Array.prototype.splice.call(b,l,1),b.length==0&&(delete s.g[c],s.h--)))):s&&(s=Vo(s))&&(c=s.g[c.toString()],s=-1,c&&(s=Do(c,l,f,w)),(l=-1<s?c[s]:null)&&ko(l))}function ko(s){if(typeof s!="number"&&s&&!s.da){var c=s.src;if(c&&c[ur])Ro(c.i,s);else{var l=s.type,f=s.proxy;c.removeEventListener?c.removeEventListener(l,f,s.capture):c.detachEvent?c.detachEvent(Fl(l),f):c.addListener&&c.removeListener&&c.removeListener(f),(l=Vo(c))?(Ro(l,s),l.h==0&&(l.src=null,c[Po]=null)):ki(s)}}}function Fl(s){return s in No?No[s]:No[s]="on"+s}function Wm(s,c){if(s.da)s=!0;else{c=new cr(c,this);var l=s.listener,f=s.ha||s.src;s.fa&&ko(s),s=l.call(f,c)}return s}function Vo(s){return s=s[Po],s instanceof Vi?s:null}var xo="__closure_events_fn_"+(1e9*Math.random()>>>0);function Oo(s){return typeof s=="function"?s:(s[xo]||(s[xo]=function(c){return s.handleEvent(c)}),s[xo])}function Ae(){St.call(this),this.i=new Vi(this),this.M=this,this.F=null}k(Ae,St),Ae.prototype[ur]=!0,Ae.prototype.removeEventListener=function(s,c,l,f){Ml(this,s,c,l,f)};function ke(s,c){var l,f=s.F;if(f)for(l=[];f;f=f.F)l.push(f);if(s=s.M,f=c.type||c,typeof c=="string")c=new Te(c,s);else if(c instanceof Te)c.target=c.target||s;else{var w=c;c=new Te(f,s),y(c,w)}if(w=!0,l)for(var b=l.length-1;0<=b;b--){var P=c.g=l[b];w=xi(P,f,!0,c)&&w}if(P=c.g=s,w=xi(P,f,!0,c)&&w,w=xi(P,f,!1,c)&&w,l)for(b=0;b<l.length;b++)P=c.g=l[b],w=xi(P,f,!1,c)&&w}Ae.prototype.N=function(){if(Ae.aa.N.call(this),this.i){var s=this.i,c;for(c in s.g){for(var l=s.g[c],f=0;f<l.length;f++)ki(l[f]);delete s.g[c],s.h--}}this.F=null},Ae.prototype.K=function(s,c,l,f){return this.i.add(String(s),c,!1,l,f)},Ae.prototype.L=function(s,c,l,f){return this.i.add(String(s),c,!0,l,f)};function xi(s,c,l,f){if(c=s.i.g[String(c)],!c)return!0;c=c.concat();for(var w=!0,b=0;b<c.length;++b){var P=c[b];if(P&&!P.da&&P.capture==l){var re=P.listener,ve=P.ha||P.src;P.fa&&Ro(s.i,P),w=re.call(ve,f)!==!1&&w}}return w&&!f.defaultPrevented}function Ll(s,c,l){if(typeof s=="function")l&&(s=S(s,l));else if(s&&typeof s.handleEvent=="function")s=S(s.handleEvent,s);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(s,c||0)}function Ul(s){s.g=Ll(()=>{s.g=null,s.i&&(s.i=!1,Ul(s))},s.l);let c=s.h;s.h=null,s.m.apply(null,c)}class Hm extends St{constructor(c,l){super(),this.m=c,this.l=l,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Ul(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function lr(s){St.call(this),this.h=s,this.g={}}k(lr,St);var Bl=[];function jl(s){ne(s.g,function(c,l){this.g.hasOwnProperty(l)&&ko(c)},s),s.g={}}lr.prototype.N=function(){lr.aa.N.call(this),jl(this)},lr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Mo=u.JSON.stringify,Km=u.JSON.parse,Qm=class{stringify(s){return u.JSON.stringify(s,void 0)}parse(s){return u.JSON.parse(s,void 0)}};function Fo(){}Fo.prototype.h=null;function ql(s){return s.h||(s.h=s.i())}function Gl(){}var hr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Lo(){Te.call(this,"d")}k(Lo,Te);function Uo(){Te.call(this,"c")}k(Uo,Te);var zt={},$l=null;function Oi(){return $l=$l||new Ae}zt.La="serverreachability";function zl(s){Te.call(this,zt.La,s)}k(zl,Te);function dr(s){let c=Oi();ke(c,new zl(c))}zt.STAT_EVENT="statevent";function Wl(s,c){Te.call(this,zt.STAT_EVENT,s),this.stat=c}k(Wl,Te);function Ve(s){let c=Oi();ke(c,new Wl(c,s))}zt.Ma="timingevent";function Hl(s,c){Te.call(this,zt.Ma,s),this.size=c}k(Hl,Te);function fr(s,c){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){s()},c)}function pr(){this.g=!0}pr.prototype.xa=function(){this.g=!1};function Jm(s,c,l,f,w,b){s.info(function(){if(s.g)if(b)for(var P="",re=b.split("&"),ve=0;ve<re.length;ve++){var Z=re[ve].split("=");if(1<Z.length){var be=Z[0];Z=Z[1];var Se=be.split("_");P=2<=Se.length&&Se[1]=="type"?P+(be+"="+Z+"&"):P+(be+"=redacted&")}}else P=null;else P=b;return"XMLHTTP REQ ("+f+") [attempt "+w+"]: "+c+`
`+l+`
`+P})}function Ym(s,c,l,f,w,b,P){s.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+w+"]: "+c+`
`+l+`
`+b+" "+P})}function gn(s,c,l,f){s.info(function(){return"XMLHTTP TEXT ("+c+"): "+Zm(s,l)+(f?" "+f:"")})}function Xm(s,c){s.info(function(){return"TIMEOUT: "+c})}pr.prototype.info=function(){};function Zm(s,c){if(!s.g)return c;if(!c)return null;try{var l=JSON.parse(c);if(l){for(s=0;s<l.length;s++)if(Array.isArray(l[s])){var f=l[s];if(!(2>f.length)){var w=f[1];if(Array.isArray(w)&&!(1>w.length)){var b=w[0];if(b!="noop"&&b!="stop"&&b!="close")for(var P=1;P<w.length;P++)w[P]=""}}}}return Mo(l)}catch{return c}}var Mi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Kl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Bo;function Fi(){}k(Fi,Fo),Fi.prototype.g=function(){return new XMLHttpRequest},Fi.prototype.i=function(){return{}},Bo=new Fi;function Ct(s,c,l,f){this.j=s,this.i=c,this.l=l,this.R=f||1,this.U=new lr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ql}function Ql(){this.i=null,this.g="",this.h=!1}var Jl={},jo={};function qo(s,c,l){s.L=1,s.v=ji(dt(c)),s.m=l,s.P=!0,Yl(s,null)}function Yl(s,c){s.F=Date.now(),Li(s),s.A=dt(s.v);var l=s.A,f=s.R;Array.isArray(f)||(f=[String(f)]),hh(l.i,"t",f),s.C=0,l=s.j.J,s.h=new Ql,s.g=Dh(s.j,l?c:null,!s.m),0<s.O&&(s.M=new Hm(S(s.Y,s,s.g),s.O)),c=s.U,l=s.g,f=s.ca;var w="readystatechange";Array.isArray(w)||(w&&(Bl[0]=w.toString()),w=Bl);for(var b=0;b<w.length;b++){var P=Vl(l,w[b],f||c.handleEvent,!1,c.h||c);if(!P)break;c.g[P.key]=P}c=s.H?m(s.H):{},s.m?(s.u||(s.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.A,s.u,s.m,c)):(s.u="GET",s.g.ea(s.A,s.u,null,c)),dr(),Jm(s.i,s.u,s.A,s.l,s.R,s.m)}Ct.prototype.ca=function(s){s=s.target;let c=this.M;c&&ft(s)==3?c.j():this.Y(s)},Ct.prototype.Y=function(s){try{if(s==this.g)e:{let Se=ft(this.g);var c=this.g.Ba();let vn=this.g.Z();if(!(3>Se)&&(Se!=3||this.g&&(this.h.h||this.g.oa()||yh(this.g)))){this.J||Se!=4||c==7||(c==8||0>=vn?dr(3):dr(2)),Go(this);var l=this.g.Z();this.X=l;t:if(Xl(this)){var f=yh(this.g);s="";var w=f.length,b=ft(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Wt(this),mr(this);var P="";break t}this.h.i=new u.TextDecoder}for(c=0;c<w;c++)this.h.h=!0,s+=this.h.i.decode(f[c],{stream:!(b&&c==w-1)});f.length=0,this.h.g+=s,this.C=0,P=this.h.g}else P=this.g.oa();if(this.o=l==200,Ym(this.i,this.u,this.A,this.l,this.R,Se,l),this.o){if(this.T&&!this.K){t:{if(this.g){var re,ve=this.g;if((re=ve.g?ve.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(re)){var Z=re;break t}}Z=null}if(l=Z)gn(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$o(this,l);else{this.o=!1,this.s=3,Ve(12),Wt(this),mr(this);break e}}if(this.P){l=!0;let Je;for(;!this.J&&this.C<P.length;)if(Je=eg(this,P),Je==jo){Se==4&&(this.s=4,Ve(14),l=!1),gn(this.i,this.l,null,"[Incomplete Response]");break}else if(Je==Jl){this.s=4,Ve(15),gn(this.i,this.l,P,"[Invalid Chunk]"),l=!1;break}else gn(this.i,this.l,Je,null),$o(this,Je);if(Xl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Se!=4||P.length!=0||this.h.h||(this.s=1,Ve(16),l=!1),this.o=this.o&&l,!l)gn(this.i,this.l,P,"[Invalid Chunked Response]"),Wt(this),mr(this);else if(0<P.length&&!this.W){this.W=!0;var be=this.j;be.g==this&&be.ba&&!be.M&&(be.j.info("Great, no buffering proxy detected. Bytes received: "+P.length),Jo(be),be.M=!0,Ve(11))}}else gn(this.i,this.l,P,null),$o(this,P);Se==4&&Wt(this),this.o&&!this.J&&(Se==4?bh(this.j,this):(this.o=!1,Li(this)))}else _g(this.g),l==400&&0<P.indexOf("Unknown SID")?(this.s=3,Ve(12)):(this.s=0,Ve(13)),Wt(this),mr(this)}}}catch{}finally{}};function Xl(s){return s.g?s.u=="GET"&&s.L!=2&&s.j.Ca:!1}function eg(s,c){var l=s.C,f=c.indexOf(`
`,l);return f==-1?jo:(l=Number(c.substring(l,f)),isNaN(l)?Jl:(f+=1,f+l>c.length?jo:(c=c.slice(f,f+l),s.C=f+l,c)))}Ct.prototype.cancel=function(){this.J=!0,Wt(this)};function Li(s){s.S=Date.now()+s.I,Zl(s,s.I)}function Zl(s,c){if(s.B!=null)throw Error("WatchDog timer not null");s.B=fr(S(s.ba,s),c)}function Go(s){s.B&&(u.clearTimeout(s.B),s.B=null)}Ct.prototype.ba=function(){this.B=null;let s=Date.now();0<=s-this.S?(Xm(this.i,this.A),this.L!=2&&(dr(),Ve(17)),Wt(this),this.s=2,mr(this)):Zl(this,this.S-s)};function mr(s){s.j.G==0||s.J||bh(s.j,s)}function Wt(s){Go(s);var c=s.M;c&&typeof c.ma=="function"&&c.ma(),s.M=null,jl(s.U),s.g&&(c=s.g,s.g=null,c.abort(),c.ma())}function $o(s,c){try{var l=s.j;if(l.G!=0&&(l.g==s||zo(l.h,s))){if(!s.K&&zo(l.h,s)&&l.G==3){try{var f=l.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var w=f;if(w[0]==0){e:if(!l.u){if(l.g)if(l.g.F+3e3<s.F)Wi(l),$i(l);else break e;Qo(l),Ve(18)}}else l.za=w[1],0<l.za-l.T&&37500>w[2]&&l.F&&l.v==0&&!l.C&&(l.C=fr(S(l.Za,l),6e3));if(1>=nh(l.h)&&l.ca){try{l.ca()}catch{}l.ca=void 0}}else Kt(l,11)}else if((s.K||l.g==s)&&Wi(l),!K(c))for(w=l.Da.g.parse(c),c=0;c<w.length;c++){let Z=w[c];if(l.T=Z[0],Z=Z[1],l.G==2)if(Z[0]=="c"){l.K=Z[1],l.ia=Z[2];let be=Z[3];be!=null&&(l.la=be,l.j.info("VER="+l.la));let Se=Z[4];Se!=null&&(l.Aa=Se,l.j.info("SVER="+l.Aa));let vn=Z[5];vn!=null&&typeof vn=="number"&&0<vn&&(f=1.5*vn,l.L=f,l.j.info("backChannelRequestTimeoutMs_="+f)),f=l;let Je=s.g;if(Je){let Ki=Je.g?Je.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ki){var b=f.h;b.g||Ki.indexOf("spdy")==-1&&Ki.indexOf("quic")==-1&&Ki.indexOf("h2")==-1||(b.j=b.l,b.g=new Set,b.h&&(Wo(b,b.h),b.h=null))}if(f.D){let Yo=Je.g?Je.g.getResponseHeader("X-HTTP-Session-Id"):null;Yo&&(f.ya=Yo,oe(f.I,f.D,Yo))}}l.G=3,l.l&&l.l.ua(),l.ba&&(l.R=Date.now()-s.F,l.j.info("Handshake RTT: "+l.R+"ms")),f=l;var P=s;if(f.qa=Rh(f,f.J?f.ia:null,f.W),P.K){rh(f.h,P);var re=P,ve=f.L;ve&&(re.I=ve),re.B&&(Go(re),Li(re)),f.g=P}else Th(f);0<l.i.length&&zi(l)}else Z[0]!="stop"&&Z[0]!="close"||Kt(l,7);else l.G==3&&(Z[0]=="stop"||Z[0]=="close"?Z[0]=="stop"?Kt(l,7):Ko(l):Z[0]!="noop"&&l.l&&l.l.ta(Z),l.v=0)}}dr(4)}catch{}}var tg=class{constructor(s,c){this.g=s,this.map=c}};function eh(s){this.l=s||10,u.PerformanceNavigationTiming?(s=u.performance.getEntriesByType("navigation"),s=0<s.length&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function th(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function nh(s){return s.h?1:s.g?s.g.size:0}function zo(s,c){return s.h?s.h==c:s.g?s.g.has(c):!1}function Wo(s,c){s.g?s.g.add(c):s.h=c}function rh(s,c){s.h&&s.h==c?s.h=null:s.g&&s.g.has(c)&&s.g.delete(c)}eh.prototype.cancel=function(){if(this.i=ih(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function ih(s){if(s.h!=null)return s.i.concat(s.h.D);if(s.g!=null&&s.g.size!==0){let c=s.i;for(let l of s.g.values())c=c.concat(l.D);return c}return x(s.i)}function ng(s){if(s.V&&typeof s.V=="function")return s.V();if(typeof Map<"u"&&s instanceof Map||typeof Set<"u"&&s instanceof Set)return Array.from(s.values());if(typeof s=="string")return s.split("");if(h(s)){for(var c=[],l=s.length,f=0;f<l;f++)c.push(s[f]);return c}c=[],l=0;for(f in s)c[l++]=s[f];return c}function rg(s){if(s.na&&typeof s.na=="function")return s.na();if(!s.V||typeof s.V!="function"){if(typeof Map<"u"&&s instanceof Map)return Array.from(s.keys());if(!(typeof Set<"u"&&s instanceof Set)){if(h(s)||typeof s=="string"){var c=[];s=s.length;for(var l=0;l<s;l++)c.push(l);return c}c=[],l=0;for(let f in s)c[l++]=f;return c}}}function sh(s,c){if(s.forEach&&typeof s.forEach=="function")s.forEach(c,void 0);else if(h(s)||typeof s=="string")Array.prototype.forEach.call(s,c,void 0);else for(var l=rg(s),f=ng(s),w=f.length,b=0;b<w;b++)c.call(void 0,f[b],l&&l[b],s)}var oh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ig(s,c){if(s){s=s.split("&");for(var l=0;l<s.length;l++){var f=s[l].indexOf("="),w=null;if(0<=f){var b=s[l].substring(0,f);w=s[l].substring(f+1)}else b=s[l];c(b,w?decodeURIComponent(w.replace(/\+/g," ")):"")}}}function Ht(s){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,s instanceof Ht){this.h=s.h,Ui(this,s.j),this.o=s.o,this.g=s.g,Bi(this,s.s),this.l=s.l;var c=s.i,l=new yr;l.i=c.i,c.g&&(l.g=new Map(c.g),l.h=c.h),ah(this,l),this.m=s.m}else s&&(c=String(s).match(oh))?(this.h=!1,Ui(this,c[1]||"",!0),this.o=gr(c[2]||""),this.g=gr(c[3]||"",!0),Bi(this,c[4]),this.l=gr(c[5]||"",!0),ah(this,c[6]||"",!0),this.m=gr(c[7]||"")):(this.h=!1,this.i=new yr(null,this.h))}Ht.prototype.toString=function(){var s=[],c=this.j;c&&s.push(_r(c,ch,!0),":");var l=this.g;return(l||c=="file")&&(s.push("//"),(c=this.o)&&s.push(_r(c,ch,!0),"@"),s.push(encodeURIComponent(String(l)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.s,l!=null&&s.push(":",String(l))),(l=this.l)&&(this.g&&l.charAt(0)!="/"&&s.push("/"),s.push(_r(l,l.charAt(0)=="/"?ag:og,!0))),(l=this.i.toString())&&s.push("?",l),(l=this.m)&&s.push("#",_r(l,ug)),s.join("")};function dt(s){return new Ht(s)}function Ui(s,c,l){s.j=l?gr(c,!0):c,s.j&&(s.j=s.j.replace(/:$/,""))}function Bi(s,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);s.s=c}else s.s=null}function ah(s,c,l){c instanceof yr?(s.i=c,lg(s.i,s.h)):(l||(c=_r(c,cg)),s.i=new yr(c,s.h))}function oe(s,c,l){s.i.set(c,l)}function ji(s){return oe(s,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),s}function gr(s,c){return s?c?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function _r(s,c,l){return typeof s=="string"?(s=encodeURI(s).replace(c,sg),l&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function sg(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var ch=/[#\/\?@]/g,og=/[#\?:]/g,ag=/[#\?]/g,cg=/[#\?@]/g,ug=/#/g;function yr(s,c){this.h=this.g=null,this.i=s||null,this.j=!!c}function Rt(s){s.g||(s.g=new Map,s.h=0,s.i&&ig(s.i,function(c,l){s.add(decodeURIComponent(c.replace(/\+/g," ")),l)}))}n=yr.prototype,n.add=function(s,c){Rt(this),this.i=null,s=_n(this,s);var l=this.g.get(s);return l||this.g.set(s,l=[]),l.push(c),this.h+=1,this};function uh(s,c){Rt(s),c=_n(s,c),s.g.has(c)&&(s.i=null,s.h-=s.g.get(c).length,s.g.delete(c))}function lh(s,c){return Rt(s),c=_n(s,c),s.g.has(c)}n.forEach=function(s,c){Rt(this),this.g.forEach(function(l,f){l.forEach(function(w){s.call(c,w,f,this)},this)},this)},n.na=function(){Rt(this);let s=Array.from(this.g.values()),c=Array.from(this.g.keys()),l=[];for(let f=0;f<c.length;f++){let w=s[f];for(let b=0;b<w.length;b++)l.push(c[f])}return l},n.V=function(s){Rt(this);let c=[];if(typeof s=="string")lh(this,s)&&(c=c.concat(this.g.get(_n(this,s))));else{s=Array.from(this.g.values());for(let l=0;l<s.length;l++)c=c.concat(s[l])}return c},n.set=function(s,c){return Rt(this),this.i=null,s=_n(this,s),lh(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[c]),this.h+=1,this},n.get=function(s,c){return s?(s=this.V(s),0<s.length?String(s[0]):c):c};function hh(s,c,l){uh(s,c),0<l.length&&(s.i=null,s.g.set(_n(s,c),x(l)),s.h+=l.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],c=Array.from(this.g.keys());for(var l=0;l<c.length;l++){var f=c[l];let b=encodeURIComponent(String(f)),P=this.V(f);for(f=0;f<P.length;f++){var w=b;P[f]!==""&&(w+="="+encodeURIComponent(String(P[f]))),s.push(w)}}return this.i=s.join("&")};function _n(s,c){return c=String(c),s.j&&(c=c.toLowerCase()),c}function lg(s,c){c&&!s.j&&(Rt(s),s.i=null,s.g.forEach(function(l,f){var w=f.toLowerCase();f!=w&&(uh(this,f),hh(this,w,l))},s)),s.j=c}function hg(s,c){let l=new pr;if(u.Image){let f=new Image;f.onload=C(Dt,l,"TestLoadImage: loaded",!0,c,f),f.onerror=C(Dt,l,"TestLoadImage: error",!1,c,f),f.onabort=C(Dt,l,"TestLoadImage: abort",!1,c,f),f.ontimeout=C(Dt,l,"TestLoadImage: timeout",!1,c,f),u.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=s}else c(!1)}function dg(s,c){let l=new pr,f=new AbortController,w=setTimeout(()=>{f.abort(),Dt(l,"TestPingServer: timeout",!1,c)},1e4);fetch(s,{signal:f.signal}).then(b=>{clearTimeout(w),b.ok?Dt(l,"TestPingServer: ok",!0,c):Dt(l,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(w),Dt(l,"TestPingServer: error",!1,c)})}function Dt(s,c,l,f,w){try{w&&(w.onload=null,w.onerror=null,w.onabort=null,w.ontimeout=null),f(l)}catch{}}function fg(){this.g=new Qm}function pg(s,c,l){let f=l||"";try{sh(s,function(w,b){let P=w;d(w)&&(P=Mo(w)),c.push(f+b+"="+encodeURIComponent(P))})}catch(w){throw c.push(f+"type="+encodeURIComponent("_badmap")),w}}function vr(s){this.l=s.Ub||null,this.j=s.eb||!1}k(vr,Fo),vr.prototype.g=function(){return new qi(this.l,this.j)},vr.prototype.i=function(s){return function(){return s}}({});function qi(s,c){Ae.call(this),this.D=s,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}k(qi,Ae),n=qi.prototype,n.open=function(s,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=s,this.A=c,this.readyState=1,Ir(this)},n.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};s&&(c.body=s),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Er(this)),this.readyState=0},n.Sa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,Ir(this)),this.g&&(this.readyState=3,Ir(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;dh(this)}else s.text().then(this.Ra.bind(this),this.ga.bind(this))};function dh(s){s.j.read().then(s.Pa.bind(s)).catch(s.ga.bind(s))}n.Pa=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var c=s.value?s.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!s.done}))&&(this.response=this.responseText+=c)}s.done?Er(this):Ir(this),this.readyState==3&&dh(this)}},n.Ra=function(s){this.g&&(this.response=this.responseText=s,Er(this))},n.Qa=function(s){this.g&&(this.response=s,Er(this))},n.ga=function(){this.g&&Er(this)};function Er(s){s.readyState=4,s.l=null,s.j=null,s.v=null,Ir(s)}n.setRequestHeader=function(s,c){this.u.append(s,c)},n.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],c=this.h.entries();for(var l=c.next();!l.done;)l=l.value,s.push(l[0]+": "+l[1]),l=c.next();return s.join(`\r
`)};function Ir(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(qi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function fh(s){let c="";return ne(s,function(l,f){c+=f,c+=":",c+=l,c+=`\r
`}),c}function Ho(s,c,l){e:{for(f in l){var f=!1;break e}f=!0}f||(l=fh(l),typeof s=="string"?l!=null&&encodeURIComponent(String(l)):oe(s,c,l))}function le(s){Ae.call(this),this.headers=new Map,this.o=s||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}k(le,Ae);var mg=/^https?$/i,gg=["POST","PUT"];n=le.prototype,n.Ha=function(s){this.J=s},n.ea=function(s,c,l,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);c=c?c.toUpperCase():"GET",this.D=s,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Bo.g(),this.v=this.o?ql(this.o):ql(Bo),this.g.onreadystatechange=S(this.Ea,this);try{this.B=!0,this.g.open(c,String(s),!0),this.B=!1}catch(b){ph(this,b);return}if(s=l||"",l=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var w in f)l.set(w,f[w]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let b of f.keys())l.set(b,f.get(b));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(l.keys()).find(b=>b.toLowerCase()=="content-type"),w=u.FormData&&s instanceof u.FormData,!(0<=Array.prototype.indexOf.call(gg,c,void 0))||f||w||l.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[b,P]of l)this.g.setRequestHeader(b,P);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{_h(this),this.u=!0,this.g.send(s),this.u=!1}catch(b){ph(this,b)}};function ph(s,c){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=c,s.m=5,mh(s),Gi(s)}function mh(s){s.A||(s.A=!0,ke(s,"complete"),ke(s,"error"))}n.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=s||7,ke(this,"complete"),ke(this,"abort"),Gi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gi(this,!0)),le.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?gh(this):this.bb())},n.bb=function(){gh(this)};function gh(s){if(s.h&&typeof a<"u"&&(!s.v[1]||ft(s)!=4||s.Z()!=2)){if(s.u&&ft(s)==4)Ll(s.Ea,0,s);else if(ke(s,"readystatechange"),ft(s)==4){s.h=!1;try{let P=s.Z();e:switch(P){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var l;if(!(l=c)){var f;if(f=P===0){var w=String(s.D).match(oh)[1]||null;!w&&u.self&&u.self.location&&(w=u.self.location.protocol.slice(0,-1)),f=!mg.test(w?w.toLowerCase():"")}l=f}if(l)ke(s,"complete"),ke(s,"success");else{s.m=6;try{var b=2<ft(s)?s.g.statusText:""}catch{b=""}s.l=b+" ["+s.Z()+"]",mh(s)}}finally{Gi(s)}}}}function Gi(s,c){if(s.g){_h(s);let l=s.g,f=s.v[0]?()=>{}:null;s.g=null,s.v=null,c||ke(s,"ready");try{l.onreadystatechange=f}catch{}}}function _h(s){s.I&&(u.clearTimeout(s.I),s.I=null)}n.isActive=function(){return!!this.g};function ft(s){return s.g?s.g.readyState:0}n.Z=function(){try{return 2<ft(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(s){if(this.g){var c=this.g.responseText;return s&&c.indexOf(s)==0&&(c=c.substring(s.length)),Km(c)}};function yh(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.H){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function _g(s){let c={};s=(s.g&&2<=ft(s)&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<s.length;f++){if(K(s[f]))continue;var l=E(s[f]);let w=l[0];if(l=l[1],typeof l!="string")continue;l=l.trim();let b=c[w]||[];c[w]=b,b.push(l)}v(c,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function wr(s,c,l){return l&&l.internalChannelParams&&l.internalChannelParams[s]||c}function vh(s){this.Aa=0,this.i=[],this.j=new pr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=wr("failFast",!1,s),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=wr("baseRetryDelayMs",5e3,s),this.cb=wr("retryDelaySeedMs",1e4,s),this.Wa=wr("forwardChannelMaxRetries",2,s),this.wa=wr("forwardChannelRequestTimeoutMs",2e4,s),this.pa=s&&s.xmlHttpFactory||void 0,this.Xa=s&&s.Tb||void 0,this.Ca=s&&s.useFetchStreams||!1,this.L=void 0,this.J=s&&s.supportsCrossDomainXhr||!1,this.K="",this.h=new eh(s&&s.concurrentRequestLimit),this.Da=new fg,this.P=s&&s.fastHandshake||!1,this.O=s&&s.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=s&&s.Rb||!1,s&&s.xa&&this.j.xa(),s&&s.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&s&&s.detectBufferingProxy||!1,this.ja=void 0,s&&s.longPollingTimeout&&0<s.longPollingTimeout&&(this.ja=s.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=vh.prototype,n.la=8,n.G=1,n.connect=function(s,c,l,f){Ve(0),this.W=s,this.H=c||{},l&&f!==void 0&&(this.H.OSID=l,this.H.OAID=f),this.F=this.X,this.I=Rh(this,null,this.W),zi(this)};function Ko(s){if(Eh(s),s.G==3){var c=s.U++,l=dt(s.I);if(oe(l,"SID",s.K),oe(l,"RID",c),oe(l,"TYPE","terminate"),Tr(s,l),c=new Ct(s,s.j,c),c.L=2,c.v=ji(dt(l)),l=!1,u.navigator&&u.navigator.sendBeacon)try{l=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!l&&u.Image&&(new Image().src=c.v,l=!0),l||(c.g=Dh(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Li(c)}Ch(s)}function $i(s){s.g&&(Jo(s),s.g.cancel(),s.g=null)}function Eh(s){$i(s),s.u&&(u.clearTimeout(s.u),s.u=null),Wi(s),s.h.cancel(),s.s&&(typeof s.s=="number"&&u.clearTimeout(s.s),s.s=null)}function zi(s){if(!th(s.h)&&!s.s){s.s=!0;var c=s.Ga;or||kl(),ar||(or(),ar=!0),Co.add(c,s),s.B=0}}function yg(s,c){return nh(s.h)>=s.h.j-(s.s?1:0)?!1:s.s?(s.i=c.D.concat(s.i),!0):s.G==1||s.G==2||s.B>=(s.Va?0:s.Wa)?!1:(s.s=fr(S(s.Ga,s,c),Sh(s,s.B)),s.B++,!0)}n.Ga=function(s){if(this.s)if(this.s=null,this.G==1){if(!s){this.U=Math.floor(1e5*Math.random()),s=this.U++;let w=new Ct(this,this.j,s),b=this.o;if(this.S&&(b?(b=m(b),y(b,this.S)):b=this.S),this.m!==null||this.O||(w.H=b,b=null),this.P)e:{for(var c=0,l=0;l<this.i.length;l++){t:{var f=this.i[l];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=l;break e}if(c===4096||l===this.i.length-1){c=l+1;break e}}c=1e3}else c=1e3;c=wh(this,w,c),l=dt(this.I),oe(l,"RID",s),oe(l,"CVER",22),this.D&&oe(l,"X-HTTP-Session-Id",this.D),Tr(this,l),b&&(this.O?c="headers="+encodeURIComponent(String(fh(b)))+"&"+c:this.m&&Ho(l,this.m,b)),Wo(this.h,w),this.Ua&&oe(l,"TYPE","init"),this.P?(oe(l,"$req",c),oe(l,"SID","null"),w.T=!0,qo(w,l,null)):qo(w,l,c),this.G=2}}else this.G==3&&(s?Ih(this,s):this.i.length==0||th(this.h)||Ih(this))};function Ih(s,c){var l;c?l=c.l:l=s.U++;let f=dt(s.I);oe(f,"SID",s.K),oe(f,"RID",l),oe(f,"AID",s.T),Tr(s,f),s.m&&s.o&&Ho(f,s.m,s.o),l=new Ct(s,s.j,l,s.B+1),s.m===null&&(l.H=s.o),c&&(s.i=c.D.concat(s.i)),c=wh(s,l,1e3),l.I=Math.round(.5*s.wa)+Math.round(.5*s.wa*Math.random()),Wo(s.h,l),qo(l,f,c)}function Tr(s,c){s.H&&ne(s.H,function(l,f){oe(c,f,l)}),s.l&&sh({},function(l,f){oe(c,f,l)})}function wh(s,c,l){l=Math.min(s.i.length,l);var f=s.l?S(s.l.Na,s.l,s):null;e:{var w=s.i;let b=-1;for(;;){let P=["count="+l];b==-1?0<l?(b=w[0].g,P.push("ofs="+b)):b=0:P.push("ofs="+b);let re=!0;for(let ve=0;ve<l;ve++){let Z=w[ve].g,be=w[ve].map;if(Z-=b,0>Z)b=Math.max(0,w[ve].g-100),re=!1;else try{pg(be,P,"req"+Z+"_")}catch{f&&f(be)}}if(re){f=P.join("&");break e}}}return s=s.i.splice(0,l),c.D=s,f}function Th(s){if(!s.g&&!s.u){s.Y=1;var c=s.Fa;or||kl(),ar||(or(),ar=!0),Co.add(c,s),s.v=0}}function Qo(s){return s.g||s.u||3<=s.v?!1:(s.Y++,s.u=fr(S(s.Fa,s),Sh(s,s.v)),s.v++,!0)}n.Fa=function(){if(this.u=null,Ah(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var s=2*this.R;this.j.info("BP detection timer enabled: "+s),this.A=fr(S(this.ab,this),s)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ve(10),$i(this),Ah(this))};function Jo(s){s.A!=null&&(u.clearTimeout(s.A),s.A=null)}function Ah(s){s.g=new Ct(s,s.j,"rpc",s.Y),s.m===null&&(s.g.H=s.o),s.g.O=0;var c=dt(s.qa);oe(c,"RID","rpc"),oe(c,"SID",s.K),oe(c,"AID",s.T),oe(c,"CI",s.F?"0":"1"),!s.F&&s.ja&&oe(c,"TO",s.ja),oe(c,"TYPE","xmlhttp"),Tr(s,c),s.m&&s.o&&Ho(c,s.m,s.o),s.L&&(s.g.I=s.L);var l=s.g;s=s.ia,l.L=1,l.v=ji(dt(c)),l.m=null,l.P=!0,Yl(l,s)}n.Za=function(){this.C!=null&&(this.C=null,$i(this),Qo(this),Ve(19))};function Wi(s){s.C!=null&&(u.clearTimeout(s.C),s.C=null)}function bh(s,c){var l=null;if(s.g==c){Wi(s),Jo(s),s.g=null;var f=2}else if(zo(s.h,c))l=c.D,rh(s.h,c),f=1;else return;if(s.G!=0){if(c.o)if(f==1){l=c.m?c.m.length:0,c=Date.now()-c.F;var w=s.B;f=Oi(),ke(f,new Hl(f,l)),zi(s)}else Th(s);else if(w=c.s,w==3||w==0&&0<c.X||!(f==1&&yg(s,c)||f==2&&Qo(s)))switch(l&&0<l.length&&(c=s.h,c.i=c.i.concat(l)),w){case 1:Kt(s,5);break;case 4:Kt(s,10);break;case 3:Kt(s,6);break;default:Kt(s,2)}}}function Sh(s,c){let l=s.Ta+Math.floor(Math.random()*s.cb);return s.isActive()||(l*=2),l*c}function Kt(s,c){if(s.j.info("Error code "+c),c==2){var l=S(s.fb,s),f=s.Xa;let w=!f;f=new Ht(f||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Ui(f,"https"),ji(f),w?hg(f.toString(),l):dg(f.toString(),l)}else Ve(2);s.G=0,s.l&&s.l.sa(c),Ch(s),Eh(s)}n.fb=function(s){s?(this.j.info("Successfully pinged google.com"),Ve(2)):(this.j.info("Failed to ping google.com"),Ve(1))};function Ch(s){if(s.G=0,s.ka=[],s.l){let c=ih(s.h);(c.length!=0||s.i.length!=0)&&(N(s.ka,c),N(s.ka,s.i),s.h.i.length=0,x(s.i),s.i.length=0),s.l.ra()}}function Rh(s,c,l){var f=l instanceof Ht?dt(l):new Ht(l);if(f.g!="")c&&(f.g=c+"."+f.g),Bi(f,f.s);else{var w=u.location;f=w.protocol,c=c?c+"."+w.hostname:w.hostname,w=+w.port;var b=new Ht(null);f&&Ui(b,f),c&&(b.g=c),w&&Bi(b,w),l&&(b.l=l),f=b}return l=s.D,c=s.ya,l&&c&&oe(f,l,c),oe(f,"VER",s.la),Tr(s,f),f}function Dh(s,c,l){if(c&&!s.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=s.Ca&&!s.pa?new le(new vr({eb:l})):new le(s.pa),c.Ha(s.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ph(){}n=Ph.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Hi(){}Hi.prototype.g=function(s,c){return new Be(s,c)};function Be(s,c){Ae.call(this),this.g=new vh(c),this.l=s,this.h=c&&c.messageUrlParams||null,s=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(s?s["X-WebChannel-Content-Type"]=c.messageContentType:s={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(s?s["X-WebChannel-Client-Profile"]=c.va:s={"X-WebChannel-Client-Profile":c.va}),this.g.S=s,(s=c&&c.Sb)&&!K(s)&&(this.g.m=s),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!K(c)&&(this.g.D=c,s=this.h,s!==null&&c in s&&(s=this.h,c in s&&delete s[c])),this.j=new yn(this)}k(Be,Ae),Be.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Be.prototype.close=function(){Ko(this.g)},Be.prototype.o=function(s){var c=this.g;if(typeof s=="string"){var l={};l.__data__=s,s=l}else this.u&&(l={},l.__data__=Mo(s),s=l);c.i.push(new tg(c.Ya++,s)),c.G==3&&zi(c)},Be.prototype.N=function(){this.g.l=null,delete this.j,Ko(this.g),delete this.g,Be.aa.N.call(this)};function Nh(s){Lo.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var c=s.__sm__;if(c){e:{for(let l in c){s=l;break e}s=void 0}(this.i=s)&&(s=this.i,c=c!==null&&s in c?c[s]:void 0),this.data=c}else this.data=s}k(Nh,Lo);function kh(){Uo.call(this),this.status=1}k(kh,Uo);function yn(s){this.g=s}k(yn,Ph),yn.prototype.ua=function(){ke(this.g,"a")},yn.prototype.ta=function(s){ke(this.g,new Nh(s))},yn.prototype.sa=function(s){ke(this.g,new kh)},yn.prototype.ra=function(){ke(this.g,"b")},Hi.prototype.createWebChannel=Hi.prototype.g,Be.prototype.send=Be.prototype.o,Be.prototype.open=Be.prototype.m,Be.prototype.close=Be.prototype.close,wc=Et.createWebChannelTransport=function(){return new Hi},Ic=Et.getStatEventTarget=function(){return Oi()},Ec=Et.Event=zt,xs=Et.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Mi.NO_ERROR=0,Mi.TIMEOUT=8,Mi.HTTP_ERROR=6,ai=Et.ErrorCode=Mi,Kl.COMPLETE="complete",vc=Et.EventType=Kl,Gl.EventType=hr,hr.OPEN="a",hr.CLOSE="b",hr.ERROR="c",hr.MESSAGE="d",Ae.prototype.listen=Ae.prototype.K,xn=Et.WebChannel=Gl,yc=Et.FetchXmlHttpFactory=vr,le.prototype.listenOnce=le.prototype.L,le.prototype.getLastError=le.prototype.Ka,le.prototype.getLastErrorCode=le.prototype.Ba,le.prototype.getStatus=le.prototype.Z,le.prototype.getResponseJson=le.prototype.Oa,le.prototype.getResponseText=le.prototype.oa,le.prototype.send=le.prototype.ea,le.prototype.setWithCredentials=le.prototype.Ha,_c=Et.XhrIo=le}).apply(typeof Vs<"u"?Vs:typeof self<"u"?self:typeof window<"u"?window:{});var Uf="@firebase/firestore";var ye=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ye.UNAUTHENTICATED=new ye(null),ye.GOOGLE_CREDENTIALS=new ye("google-credentials-uid"),ye.FIRST_PARTY=new ye("first-party-uid"),ye.MOCK_USER=new ye("mock-user");var tr="10.13.2";var on=new xt("@firebase/firestore");function ci(){return on.logLevel}function O(n,...e){if(on.logLevel<=W.DEBUG){let t=e.map(ol);on.debug(`Firestore (${tr}): ${n}`,...t)}}function Tt(n,...e){if(on.logLevel<=W.ERROR){let t=e.map(ol);on.error(`Firestore (${tr}): ${n}`,...t)}}function jn(n,...e){if(on.logLevel<=W.WARN){let t=e.map(ol);on.warn(`Firestore (${tr}): ${n}`,...t)}}function ol(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function U(n="Unexpected state"){let e=`FIRESTORE (${tr}) INTERNAL ASSERTION FAILED: `+n;throw Tt(e),new Error(e)}function ie(n,e){n||U()}function j(n,e){return n}var R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},F=class extends He{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var It=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Us=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Cc=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ye.UNAUTHENTICATED))}shutdown(){}},Rc=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Dc=class{constructor(e){this.t=e,this.currentUser=ye.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),o=new It;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new It,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let h=o;e.enqueueRetryable(()=>A(this,null,function*(){yield h.promise,yield i(this.currentUser)}))},u=h=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?u(h):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new It)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ie(typeof r.accessToken=="string"),new Us(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return ie(e===null||typeof e=="string"),new ye(e)}},Pc=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=ye.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Nc=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Pc(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ye.FIRST_PARTY))}shutdown(){}invalidateToken(){}},kc=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Vc=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=o=>{o.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.R;return this.R=o.token,O("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ie(typeof t.token=="string"),this.R=t.token,new kc(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function _E(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Bs=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=_E(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function ee(n,e){return n<e?-1:n>e?1:0}function qn(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var we=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new F(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new F(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new F(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new F(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var q=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new we(0,0))}static max(){return new n(new we(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var js=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&U(),r===void 0?r=e.length-t:r>e.length-t&&U(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=e.get(i),a=t.get(i);if(o<a)return-1;if(o>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},he=class n extends js{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new F(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},yE=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ge=class n extends js{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return yE.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new F(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new F(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new F(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(o(),i++)}if(o(),a)throw new F(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var L=class n{constructor(e){this.path=e}static fromPath(e){return new n(he.fromString(e))}static fromName(e){return new n(he.fromString(e).popFirst(5))}static empty(){return new n(he.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&he.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return he.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new he(e.slice()))}};var xc=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};xc.UNKNOWN_ID=-1;function vE(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=q.fromTimestamp(r===1e9?new we(t+1,0):new we(t,r));return new an(i,L.empty(),e)}function EE(n){return new an(n.readTime,n.key,-1)}var an=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(q.min(),L.empty(),-1)}static max(){return new n(q.max(),L.empty(),-1)}};function IE(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=L.comparator(n.documentKey,e.documentKey),t!==0?t:ee(n.largestBatchId,e.largestBatchId))}var wE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Oc=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Si(n){return A(this,null,function*(){if(n.code!==R.FAILED_PRECONDITION||n.message!==wE)throw n;O("LocalStore","Unexpectedly lost primary lease")})}var D=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&U(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++o,a&&o===i&&t()},h=>r(h))}),a=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,a=new Array(o),u=0;for(let h=0;h<o;h++){let d=h;t(e[d]).next(p=>{a[d]=p,++u,u===o&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function TE(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Ci(n){return n.name==="IndexedDbTransactionError"}var _p=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function _o(n){return n==null}function pi(n){return n===0&&1/n==-1/0}function AE(n){return typeof n=="number"&&Number.isInteger(n)&&!pi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var bE=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],UA=[...bE,"documentOverlays"],SE=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],CE=SE,RE=[...CE,"indexConfiguration","indexState","indexEntries"];var BA=[...RE,"globals"];function Bf(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function dn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function yp(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var de=class n{constructor(e,t){this.comparator=e,this.root=t||st.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,st.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,st.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ln(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ln(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ln(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ln(this.root,e,this.comparator,!0)}},Ln=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},st=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw U();let e=this.left.check();if(e!==this.right.check())throw U();return e+(this.isRed()?0:1)}};st.EMPTY=null,st.RED=!0,st.BLACK=!1;st.EMPTY=new class{constructor(){this.size=0}get key(){throw U()}get value(){throw U()}get color(){throw U()}get left(){throw U()}get right(){throw U()}copy(e,t,r,i,o){return this}insert(e,t,r){return new st(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var De=class n{constructor(e){this.comparator=e,this.data=new de(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new qs(this.data.getIterator())}getIteratorFrom(e){return new qs(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},qs=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Qe=class n{constructor(e){this.fields=e,e.sort(Ge.comparator)}static empty(){return new n([])}unionWith(e){let t=new De(Ge.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return qn(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Gs=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Pe=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Gs("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Pe.EMPTY_BYTE_STRING=new Pe("");var DE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function At(n){if(ie(!!n),typeof n=="string"){let e=0,t=DE.exec(n);if(ie(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ae(n.seconds),nanos:ae(n.nanos)}}function ae(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function jt(n){return typeof n=="string"?Pe.fromBase64String(n):Pe.fromUint8Array(n)}function al(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function cl(n){let e=n.mapValue.fields.__previous_value__;return al(e)?cl(e):e}function mi(n){let e=At(n.mapValue.fields.__local_write_time__.timestampValue);return new we(e.seconds,e.nanos)}var Mc=class{constructor(e,t,r,i,o,a,u,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d}},$s=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Os={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function cn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?al(n)?4:Ep(n)?9007199254740991:vp(n)?10:11:U()}function ct(n,e){if(n===e)return!0;let t=cn(n);if(t!==cn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return mi(n).isEqual(mi(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let a=At(i.timestampValue),u=At(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return jt(i.bytesValue).isEqual(jt(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return ae(i.geoPointValue.latitude)===ae(o.geoPointValue.latitude)&&ae(i.geoPointValue.longitude)===ae(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return ae(i.integerValue)===ae(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let a=ae(i.doubleValue),u=ae(o.doubleValue);return a===u?pi(a)===pi(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return qn(n.arrayValue.values||[],e.arrayValue.values||[],ct);case 10:case 11:return function(i,o){let a=i.mapValue.fields||{},u=o.mapValue.fields||{};if(Bf(a)!==Bf(u))return!1;for(let h in a)if(a.hasOwnProperty(h)&&(u[h]===void 0||!ct(a[h],u[h])))return!1;return!0}(n,e);default:return U()}}function gi(n,e){return(n.values||[]).find(t=>ct(t,e))!==void 0}function Gn(n,e){if(n===e)return 0;let t=cn(n),r=cn(e);if(t!==r)return ee(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ee(n.booleanValue,e.booleanValue);case 2:return function(o,a){let u=ae(o.integerValue||o.doubleValue),h=ae(a.integerValue||a.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(n,e);case 3:return jf(n.timestampValue,e.timestampValue);case 4:return jf(mi(n),mi(e));case 5:return ee(n.stringValue,e.stringValue);case 6:return function(o,a){let u=jt(o),h=jt(a);return u.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(o,a){let u=o.split("/"),h=a.split("/");for(let d=0;d<u.length&&d<h.length;d++){let p=ee(u[d],h[d]);if(p!==0)return p}return ee(u.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,a){let u=ee(ae(o.latitude),ae(a.latitude));return u!==0?u:ee(ae(o.longitude),ae(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return qf(n.arrayValue,e.arrayValue);case 10:return function(o,a){var u,h,d,p;let I=o.fields||{},S=a.fields||{},C=(u=I.value)===null||u===void 0?void 0:u.arrayValue,k=(h=S.value)===null||h===void 0?void 0:h.arrayValue,x=ee(((d=C?.values)===null||d===void 0?void 0:d.length)||0,((p=k?.values)===null||p===void 0?void 0:p.length)||0);return x!==0?x:qf(C,k)}(n.mapValue,e.mapValue);case 11:return function(o,a){if(o===Os.mapValue&&a===Os.mapValue)return 0;if(o===Os.mapValue)return 1;if(a===Os.mapValue)return-1;let u=o.fields||{},h=Object.keys(u),d=a.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let I=0;I<h.length&&I<p.length;++I){let S=ee(h[I],p[I]);if(S!==0)return S;let C=Gn(u[h[I]],d[p[I]]);if(C!==0)return C}return ee(h.length,p.length)}(n.mapValue,e.mapValue);default:throw U()}}function jf(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ee(n,e);let t=At(n),r=At(e),i=ee(t.seconds,r.seconds);return i!==0?i:ee(t.nanos,r.nanos)}function qf(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Gn(t[i],r[i]);if(o)return o}return ee(t.length,r.length)}function $n(n){return Fc(n)}function Fc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=At(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return jt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return L.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=Fc(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let a of r)o?o=!1:i+=",",i+=`${a}:${Fc(t.fields[a])}`;return i+"}"}(n.mapValue):U()}function Lc(n){return!!n&&"integerValue"in n}function ul(n){return!!n&&"arrayValue"in n}function Gf(n){return!!n&&"nullValue"in n}function $f(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Fs(n){return!!n&&"mapValue"in n}function vp(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function li(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return dn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=li(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=li(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Ep(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var qe=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Fs(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=li(t)}setAll(e){let t=Ge.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=li(a):i.push(u.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());Fs(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ct(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Fs(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){dn(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(li(this.value))}};function Ip(n){let e=[];return dn(n.fields,(t,r)=>{let i=new Ge([t]);if(Fs(r)){let o=Ip(r.mapValue).fields;if(o.length===0)e.push(i);else for(let a of o)e.push(i.child(a))}else e.push(i)}),new Qe(e)}var tt=class n{constructor(e,t,r,i,o,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,q.min(),q.min(),q.min(),qe.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,q.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,q.min(),q.min(),qe.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,q.min(),q.min(),qe.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qe.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qe.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var zn=class{constructor(e,t){this.position=e,this.inclusive=t}};function zf(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],a=n.position[i];if(o.field.isKeyField()?r=L.comparator(L.fromName(a.referenceValue),t.key):r=Gn(a,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function Wf(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ct(n.position[t],e.position[t]))return!1;return!0}var Wn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function PE(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var zs=class{},ge=class n extends zs{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Bc(e,t,r):t==="array-contains"?new Gc(e,r):t==="in"?new $c(e,r):t==="not-in"?new zc(e,r):t==="array-contains-any"?new Wc(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new jc(e,r):new qc(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Gn(t,this.value)):t!==null&&cn(this.value)===cn(t)&&this.matchesComparison(Gn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return U()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},ut=class n extends zs{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return wp(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function wp(n){return n.op==="and"}function Tp(n){return NE(n)&&wp(n)}function NE(n){for(let e of n.filters)if(e instanceof ut)return!1;return!0}function Uc(n){if(n instanceof ge)return n.field.canonicalString()+n.op.toString()+$n(n.value);if(Tp(n))return n.filters.map(e=>Uc(e)).join(",");{let e=n.filters.map(t=>Uc(t)).join(",");return`${n.op}(${e})`}}function Ap(n,e){return n instanceof ge?function(r,i){return i instanceof ge&&r.op===i.op&&r.field.isEqual(i.field)&&ct(r.value,i.value)}(n,e):n instanceof ut?function(r,i){return i instanceof ut&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,u)=>o&&Ap(a,i.filters[u]),!0):!1}(n,e):void U()}function bp(n){return n instanceof ge?function(t){return`${t.field.canonicalString()} ${t.op} ${$n(t.value)}`}(n):n instanceof ut?function(t){return t.op.toString()+" {"+t.getFilters().map(bp).join(" ,")+"}"}(n):"Filter"}var Bc=class extends ge{constructor(e,t,r){super(e,t,r),this.key=L.fromName(r.referenceValue)}matches(e){let t=L.comparator(e.key,this.key);return this.matchesComparison(t)}},jc=class extends ge{constructor(e,t){super(e,"in",t),this.keys=Sp("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},qc=class extends ge{constructor(e,t){super(e,"not-in",t),this.keys=Sp("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Sp(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>L.fromName(r.referenceValue))}var Gc=class extends ge{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return ul(t)&&gi(t.arrayValue,this.value)}},$c=class extends ge{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&gi(this.value.arrayValue,t)}},zc=class extends ge{constructor(e,t){super(e,"not-in",t)}matches(e){if(gi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!gi(this.value.arrayValue,t)}},Wc=class extends ge{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!ul(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>gi(this.value.arrayValue,r))}};var Hc=class{constructor(e,t=null,r=[],i=[],o=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.ue=null}};function Hf(n,e=null,t=[],r=[],i=null,o=null,a=null){return new Hc(n,e,t,r,i,o,a)}function ll(n){let e=j(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Uc(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),_o(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>$n(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>$n(r)).join(",")),e.ue=t}return e.ue}function hl(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!PE(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Ap(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Wf(n.startAt,e.startAt)&&Wf(n.endAt,e.endAt)}function Kc(n){return L.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Hn=class{constructor(e,t=null,r=[],i=[],o=null,a="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=h,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function kE(n,e,t,r,i,o,a,u){return new Hn(n,e,t,r,i,o,a,u)}function dl(n){return new Hn(n)}function Kf(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function VE(n){return n.collectionGroup!==null}function hi(n){let e=j(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new De(Ge.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Wn(o,r))}),t.has(Ge.keyField().canonicalString())||e.ce.push(new Wn(Ge.keyField(),r))}return e.ce}function ot(n){let e=j(n);return e.le||(e.le=xE(e,hi(n))),e.le}function xE(n,e){if(n.limitType==="F")return Hf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new Wn(i.field,o)});let t=n.endAt?new zn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new zn(n.startAt.position,n.startAt.inclusive):null;return Hf(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Qc(n,e,t){return new Hn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function yo(n,e){return hl(ot(n),ot(e))&&n.limitType===e.limitType}function Cp(n){return`${ll(ot(n))}|lt:${n.limitType}`}function On(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>bp(i)).join(", ")}]`),_o(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>$n(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>$n(i)).join(",")),`Target(${r})`}(ot(n))}; limitType=${n.limitType})`}function vo(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):L.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of hi(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,u,h){let d=zf(a,u,h);return a.inclusive?d<=0:d<0}(r.startAt,hi(r),i)||r.endAt&&!function(a,u,h){let d=zf(a,u,h);return a.inclusive?d>=0:d>0}(r.endAt,hi(r),i))}(n,e)}function OE(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Rp(n){return(e,t)=>{let r=!1;for(let i of hi(n)){let o=ME(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function ME(n,e,t){let r=n.field.isKeyField()?L.comparator(e.key,t.key):function(o,a,u){let h=a.data.field(o),d=u.data.field(o);return h!==null&&d!==null?Gn(h,d):U()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return U()}}var qt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){dn(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return yp(this.inner)}size(){return this.innerSize}};var FE=new de(L.comparator);function bt(){return FE}var Dp=new de(L.comparator);function ui(...n){let e=Dp;for(let t of n)e=e.insert(t.key,t);return e}function Pp(n){let e=Dp;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function nn(){return di()}function Np(){return di()}function di(){return new qt(n=>n.toString(),(n,e)=>n.isEqual(e))}var LE=new de(L.comparator),UE=new De(L.comparator);function H(...n){let e=UE;for(let t of n)e=e.add(t);return e}var BE=new De(ee);function jE(){return BE}function fl(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pi(e)?"-0":e}}function kp(n){return{integerValue:""+n}}function qE(n,e){return AE(e)?kp(e):fl(n,e)}var Kn=class{constructor(){this._=void 0}};function GE(n,e,t){return n instanceof Qn?function(i,o){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&al(o)&&(o=cl(o)),o&&(a.fields.__previous_value__=o),{mapValue:a}}(t,e):n instanceof un?xp(n,e):n instanceof ln?Op(n,e):function(i,o){let a=Vp(i,o),u=Qf(a)+Qf(i.Pe);return Lc(a)&&Lc(i.Pe)?kp(u):fl(i.serializer,u)}(n,e)}function $E(n,e,t){return n instanceof un?xp(n,e):n instanceof ln?Op(n,e):t}function Vp(n,e){return n instanceof Jn?function(r){return Lc(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var Qn=class extends Kn{},un=class extends Kn{constructor(e){super(),this.elements=e}};function xp(n,e){let t=Mp(e);for(let r of n.elements)t.some(i=>ct(i,r))||t.push(r);return{arrayValue:{values:t}}}var ln=class extends Kn{constructor(e){super(),this.elements=e}};function Op(n,e){let t=Mp(e);for(let r of n.elements)t=t.filter(i=>!ct(i,r));return{arrayValue:{values:t}}}var Jn=class extends Kn{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function Qf(n){return ae(n.integerValue||n.doubleValue)}function Mp(n){return ul(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function zE(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof un&&i instanceof un||r instanceof ln&&i instanceof ln?qn(r.elements,i.elements,ct):r instanceof Jn&&i instanceof Jn?ct(r.Pe,i.Pe):r instanceof Qn&&i instanceof Qn}(n.transform,e.transform)}var Jc=class{constructor(e,t){this.version=e,this.transformResults=t}},wt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Ls(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Yn=class{};function Fp(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new _i(n.key,wt.none()):new hn(n.key,n.data,wt.none());{let t=n.data,r=qe.empty(),i=new De(Ge.comparator);for(let o of e.fields)if(!i.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new lt(n.key,r,new Qe(i.toArray()),wt.none())}}function WE(n,e,t){n instanceof hn?function(i,o,a){let u=i.value.clone(),h=Yf(i.fieldTransforms,o,a.transformResults);u.setAll(h),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof lt?function(i,o,a){if(!Ls(i.precondition,o))return void o.convertToUnknownDocument(a.version);let u=Yf(i.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(Lp(i)),h.setAll(u),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function fi(n,e,t,r){return n instanceof hn?function(o,a,u,h){if(!Ls(o.precondition,a))return u;let d=o.value.clone(),p=Xf(o.fieldTransforms,h,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof lt?function(o,a,u,h){if(!Ls(o.precondition,a))return u;let d=Xf(o.fieldTransforms,h,a),p=a.data;return p.setAll(Lp(o)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(I=>I.field))}(n,e,t,r):function(o,a,u){return Ls(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function HE(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=Vp(r.transform,i||null);o!=null&&(t===null&&(t=qe.empty()),t.set(r.field,o))}return t||null}function Jf(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&qn(r,i,(o,a)=>zE(o,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var hn=class extends Yn{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},lt=class extends Yn{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function Lp(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Yf(n,e,t){let r=new Map;ie(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],a=o.transform,u=e.data.field(o.field);r.set(o.field,$E(a,u,t[i]))}return r}function Xf(n,e,t){let r=new Map;for(let i of n){let o=i.transform,a=t.data.field(i.field);r.set(i.field,GE(o,a,e))}return r}var _i=class extends Yn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Yc=class extends Yn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Xc=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&WE(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=fi(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=fi(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Np();return this.mutations.forEach(i=>{let o=e.get(i.key),a=o.overlayedDocument,u=this.applyToLocalView(a,o.mutatedFields);u=t.has(i.key)?null:u;let h=Fp(a,u);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(q.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),H())}isEqual(e){return this.batchId===e.batchId&&qn(this.mutations,e.mutations,(t,r)=>Jf(t,r))&&qn(this.baseMutations,e.baseMutations,(t,r)=>Jf(t,r))}},Zc=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ie(e.mutations.length===r.length);let i=function(){return LE}(),o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new n(e,t,r,i)}};var eu=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var tu=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var fe,J;function KE(n){switch(n){default:return U();case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0}}function Up(n){if(n===void 0)return Tt("GRPC error has no .code"),R.UNKNOWN;switch(n){case fe.OK:return R.OK;case fe.CANCELLED:return R.CANCELLED;case fe.UNKNOWN:return R.UNKNOWN;case fe.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case fe.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case fe.INTERNAL:return R.INTERNAL;case fe.UNAVAILABLE:return R.UNAVAILABLE;case fe.UNAUTHENTICATED:return R.UNAUTHENTICATED;case fe.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case fe.NOT_FOUND:return R.NOT_FOUND;case fe.ALREADY_EXISTS:return R.ALREADY_EXISTS;case fe.PERMISSION_DENIED:return R.PERMISSION_DENIED;case fe.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case fe.ABORTED:return R.ABORTED;case fe.OUT_OF_RANGE:return R.OUT_OF_RANGE;case fe.UNIMPLEMENTED:return R.UNIMPLEMENTED;case fe.DATA_LOSS:return R.DATA_LOSS;default:return U()}}(J=fe||(fe={}))[J.OK=0]="OK",J[J.CANCELLED=1]="CANCELLED",J[J.UNKNOWN=2]="UNKNOWN",J[J.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",J[J.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",J[J.NOT_FOUND=5]="NOT_FOUND",J[J.ALREADY_EXISTS=6]="ALREADY_EXISTS",J[J.PERMISSION_DENIED=7]="PERMISSION_DENIED",J[J.UNAUTHENTICATED=16]="UNAUTHENTICATED",J[J.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",J[J.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",J[J.ABORTED=10]="ABORTED",J[J.OUT_OF_RANGE=11]="OUT_OF_RANGE",J[J.UNIMPLEMENTED=12]="UNIMPLEMENTED",J[J.INTERNAL=13]="INTERNAL",J[J.UNAVAILABLE=14]="UNAVAILABLE",J[J.DATA_LOSS=15]="DATA_LOSS";var Zf=null;function QE(){return new TextEncoder}var JE=new Lt([4294967295,4294967295],0);function ep(n){let e=QE().encode(n),t=new gc;return t.update(e),new Uint8Array(t.digest())}function tp(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Lt([t,r],0),new Lt([i,o],0)]}var nu=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new rn(`Invalid padding: ${t}`);if(r<0)throw new rn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new rn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new rn(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Lt.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Lt.fromNumber(r)));return i.compare(JE)===1&&(i=new Lt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=ep(e),[r,i]=tp(t);for(let o=0;o<this.hashCount;o++){let a=this.Ee(r,i,o);if(!this.de(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new n(o,i,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.Ie===0)return;let t=ep(e),[r,i]=tp(t);for(let o=0;o<this.hashCount;o++){let a=this.Ee(r,i,o);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},rn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Ws=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,yi.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(q.min(),i,new de(ee),bt(),H())}},yi=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,H(),H(),H())}};var Un=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Hs=class{constructor(e,t){this.targetId=e,this.me=t}},Ks=class{constructor(e,t,r=Pe.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Qs=class{constructor(){this.fe=0,this.ge=rp(),this.pe=Pe.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=H(),t=H(),r=H();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:U()}}),new yi(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=rp()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ie(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},ru=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=bt(),this.qe=np(),this.Qe=new de(ee)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:U()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let o=i.target;if(Kc(o))if(r===0){let a=new L(o.path);this.Ue(t,a,tt.newNoDocument(a,q.min()))}else ie(r===1);else{let a=this.Ye(t);if(a!==r){let u=this.Ze(e),h=u?this.Xe(u,e,a):1;if(h!==0){this.je(t);let d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}Zf?.et(function(p,I,S,C,k){var x,N,z,K,Q,se;let Ne={localCacheCount:p,existenceFilterCount:I.count,databaseId:S.database,projectId:S.projectId},ne=I.unchangedNames;return ne&&(Ne.bloomFilter={applied:k===0,hashCount:(x=ne?.hashCount)!==null&&x!==void 0?x:0,bitmapLength:(K=(z=(N=ne?.bits)===null||N===void 0?void 0:N.bitmap)===null||z===void 0?void 0:z.length)!==null&&K!==void 0?K:0,padding:(se=(Q=ne?.bits)===null||Q===void 0?void 0:Q.padding)!==null&&se!==void 0?se:0,mightContain:v=>{var m;return(m=C?.mightContain(v))!==null&&m!==void 0&&m}}),Ne}(a,e.me,this.Le.tt(),u,h))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,a,u;try{a=jt(r).toUint8Array()}catch(h){if(h instanceof Gs)return jn("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new nu(a,i,o)}catch(h){return jn(h instanceof rn?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.Ie===0?null:u}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let a=this.Le.tt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Ue(t,o,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((o,a)=>{let u=this.Je(a);if(u){if(o.current&&Kc(u.target)){let h=new L(u.target.path);this.ke.get(h)!==null||this.it(a,h)||this.Ue(a,h,tt.newNoDocument(h,e))}o.be&&(t.set(a,o.ve()),o.Ce())}});let r=H();this.qe.forEach((o,a)=>{let u=!0;a.forEachWhile(h=>{let d=this.Je(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(o))}),this.ke.forEach((o,a)=>a.setReadTime(e));let i=new Ws(e,t,this.Qe,this.ke,r);return this.ke=bt(),this.qe=np(),this.Qe=new de(ee),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Qs,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new De(ee),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||O("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Qs),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function np(){return new de(L.comparator)}function rp(){return new de(L.comparator)}var YE={asc:"ASCENDING",desc:"DESCENDING"},XE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ZE={and:"AND",or:"OR"},iu=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function su(n,e){return n.useProto3Json||_o(e)?e:{value:e}}function Js(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Bp(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function eI(n,e){return Js(n,e.toTimestamp())}function at(n){return ie(!!n),q.fromTimestamp(function(t){let r=At(t);return new we(r.seconds,r.nanos)}(n))}function pl(n,e){return ou(n,e).canonicalString()}function ou(n,e){let t=function(i){return new he(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function jp(n){let e=he.fromString(n);return ie(Wp(e)),e}function au(n,e){return pl(n.databaseId,e.path)}function Tc(n,e){let t=jp(e);if(t.get(1)!==n.databaseId.projectId)throw new F(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new F(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new L(Gp(t))}function qp(n,e){return pl(n.databaseId,e)}function tI(n){let e=jp(n);return e.length===4?he.emptyPath():Gp(e)}function cu(n){return new he(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Gp(n){return ie(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function ip(n,e,t){return{name:au(n,e),fields:t.value.mapValue.fields}}function nI(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:U()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(d,p){return d.useProto3Json?(ie(p===void 0||typeof p=="string"),Pe.fromBase64String(p||"")):(ie(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Pe.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(d){let p=d.code===void 0?R.UNKNOWN:Up(d.code);return new F(p,d.message||"")}(a);t=new Ks(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Tc(n,r.document.name),o=at(r.document.updateTime),a=r.document.createTime?at(r.document.createTime):q.min(),u=new qe({mapValue:{fields:r.document.fields}}),h=tt.newFoundDocument(i,o,a,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new Un(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Tc(n,r.document),o=r.readTime?at(r.readTime):q.min(),a=tt.newNoDocument(i,o),u=r.removedTargetIds||[];t=new Un([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Tc(n,r.document),o=r.removedTargetIds||[];t=new Un([],o,i,null)}else{if(!("filter"in e))return U();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,a=new tu(i,o),u=r.targetId;t=new Hs(u,a)}}return t}function rI(n,e){let t;if(e instanceof hn)t={update:ip(n,e.key,e.value)};else if(e instanceof _i)t={delete:au(n,e.key)};else if(e instanceof lt)t={update:ip(n,e.key,e.data),updateMask:dI(e.fieldMask)};else{if(!(e instanceof Yc))return U();t={verify:au(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,a){let u=a.transform;if(u instanceof Qn)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof un)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof ln)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Jn)return{fieldPath:a.field.canonicalString(),increment:u.Pe};throw U()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:eI(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:U()}(n,e.precondition)),t}function iI(n,e){return n&&n.length>0?(ie(e!==void 0),n.map(t=>function(i,o){let a=i.updateTime?at(i.updateTime):at(o);return a.isEqual(q.min())&&(a=at(o)),new Jc(a,i.transformResults||[])}(t,e))):[]}function sI(n,e){return{documents:[qp(n,e.path)]}}function oI(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=qp(n,i);let o=function(d){if(d.length!==0)return zp(ut.create(d,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let a=function(d){if(d.length!==0)return d.map(p=>function(S){return{field:Mn(S.field),direction:uI(S.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=su(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:i}}function aI(n){let e=tI(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ie(r===1);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let o=[];t.where&&(o=function(I){let S=$p(I);return S instanceof ut&&Tp(S)?S.getFilters():[S]}(t.where));let a=[];t.orderBy&&(a=function(I){return I.map(S=>function(k){return new Wn(Fn(k.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(k.direction))}(S))}(t.orderBy));let u=null;t.limit&&(u=function(I){let S;return S=typeof I=="object"?I.value:I,_o(S)?null:S}(t.limit));let h=null;t.startAt&&(h=function(I){let S=!!I.before,C=I.values||[];return new zn(C,S)}(t.startAt));let d=null;return t.endAt&&(d=function(I){let S=!I.before,C=I.values||[];return new zn(C,S)}(t.endAt)),kE(e,i,a,o,u,"F",h,d)}function cI(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return U()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function $p(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Fn(t.unaryFilter.field);return ge.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Fn(t.unaryFilter.field);return ge.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Fn(t.unaryFilter.field);return ge.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Fn(t.unaryFilter.field);return ge.create(a,"!=",{nullValue:"NULL_VALUE"});default:return U()}}(n):n.fieldFilter!==void 0?function(t){return ge.create(Fn(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return U()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return ut.create(t.compositeFilter.filters.map(r=>$p(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return U()}}(t.compositeFilter.op))}(n):U()}function uI(n){return YE[n]}function lI(n){return XE[n]}function hI(n){return ZE[n]}function Mn(n){return{fieldPath:n.canonicalString()}}function Fn(n){return Ge.fromServerFormat(n.fieldPath)}function zp(n){return n instanceof ge?function(t){if(t.op==="=="){if($f(t.value))return{unaryFilter:{field:Mn(t.field),op:"IS_NAN"}};if(Gf(t.value))return{unaryFilter:{field:Mn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if($f(t.value))return{unaryFilter:{field:Mn(t.field),op:"IS_NOT_NAN"}};if(Gf(t.value))return{unaryFilter:{field:Mn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mn(t.field),op:lI(t.op),value:t.value}}}(n):n instanceof ut?function(t){let r=t.getFilters().map(i=>zp(i));return r.length===1?r[0]:{compositeFilter:{op:hI(t.op),filters:r}}}(n):U()}function dI(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Wp(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var vi=class n{constructor(e,t,r,i,o=q.min(),a=q.min(),u=Pe.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var uu=class{constructor(e){this.ct=e}};function fI(n){let e=aI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Qc(e,e.limit,"L"):e}var Ys=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(ae(e.integerValue));else if("doubleValue"in e){let r=ae(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),pi(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=At(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(jt(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?Ep(e)?this.dt(t,Number.MAX_SAFE_INTEGER):vp(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):U()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let o=e.fields||{};this.dt(t,53);let a="value",u=((i=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(ae(u)),this.Vt(a,t),this.Tt(o[a],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),L.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Ys.vt=new Ys;var lu=class{constructor(){this.un=new hu}addToCollectionParentIndex(e,t){return this.un.add(t),D.resolve()}getCollectionParents(e,t){return D.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return D.resolve()}deleteFieldIndex(e,t){return D.resolve()}deleteAllFieldIndexes(e){return D.resolve()}createTargetIndexes(e,t){return D.resolve()}getDocumentsMatchingTarget(e,t){return D.resolve(null)}getIndexType(e,t){return D.resolve(0)}getFieldIndexes(e,t){return D.resolve([])}getNextCollectionGroupToUpdate(e){return D.resolve(null)}getMinOffset(e,t){return D.resolve(an.min())}getMinOffsetFromCollectionGroup(e,t){return D.resolve(an.min())}updateCollectionGroup(e,t,r){return D.resolve()}updateIndexEntries(e,t){return D.resolve()}},hu=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new De(he.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new De(he.comparator)).toArray()}};var qA=new Uint8Array(0);var it=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};it.DEFAULT_COLLECTION_PERCENTILE=10,it.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,it.DEFAULT=new it(41943040,it.DEFAULT_COLLECTION_PERCENTILE,it.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),it.DISABLED=new it(-1,0,0);var Ei=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var du=class{constructor(){this.changes=new qt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,tt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?D.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var fu=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var pu=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&fi(r.mutation,i,Qe.empty(),we.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,H()).next(()=>r))}getLocalViewOfDocuments(e,t,r=H()){let i=nn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let a=ui();return o.forEach((u,h)=>{a=a.insert(u,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=nn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,H()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let o=bt(),a=di(),u=function(){return di()}();return t.forEach((h,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof lt)?o=o.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),fi(p.mutation,d,p.mutation.getFieldMask(),we.now())):a.set(d.key,Qe.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var I;return u.set(d,new fu(p,(I=a.get(d))!==null&&I!==void 0?I:null))}),u))}recalculateAndSaveOverlays(e,t){let r=di(),i=new de((a,u)=>a-u),o=H();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(h=>{let d=t.get(h);if(d===null)return;let p=r.get(h)||Qe.empty();p=u.applyToLocalView(d,p),r.set(h,p);let I=(i.get(u.batchId)||H()).add(h);i=i.insert(u.batchId,I)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let h=u.getNext(),d=h.key,p=h.value,I=Np();p.forEach(S=>{if(!o.has(S)){let C=Fp(t.get(S),r.get(S));C!==null&&I.set(S,C),o=o.add(S)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,I))}return D.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return L.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):VE(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):D.resolve(nn()),u=-1,h=o;return a.next(d=>D.forEach(d,(p,I)=>(u<I.largestBatchId&&(u=I.largestBatchId),o.get(p)?D.resolve():this.remoteDocumentCache.getEntry(e,p).next(S=>{h=h.insert(p,S)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,h,d,H())).next(p=>({batchId:u,changes:Pp(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new L(t)).next(r=>{let i=ui();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,a=ui();return this.indexManager.getCollectionParents(e,o).next(u=>D.forEach(u,h=>{let d=function(I,S){return new Hn(S,null,I.explicitOrderBy.slice(),I.filters.slice(),I.limit,I.limitType,I.startAt,I.endAt)}(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((I,S)=>{a=a.insert(I,S)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(a=>{o.forEach((h,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,tt.newInvalidDocument(p)))});let u=ui();return a.forEach((h,d)=>{let p=o.get(h);p!==void 0&&fi(p.mutation,d,Qe.empty(),we.now()),vo(t,d)&&(u=u.insert(h,d))}),u})}};var mu=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return D.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:at(i.createTime)}}(t)),D.resolve()}getNamedQuery(e,t){return D.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:fI(i.bundledQuery),readTime:at(i.readTime)}}(t)),D.resolve()}};var gu=class{constructor(){this.overlays=new de(L.comparator),this.Ir=new Map}getOverlay(e,t){return D.resolve(this.overlays.get(t))}getOverlays(e,t){let r=nn();return D.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ht(e,t,o)}),D.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),D.resolve()}getOverlaysForCollection(e,t,r){let i=nn(),o=t.length+1,a=new L(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let h=u.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return D.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new de((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=o.get(d.largestBatchId);p===null&&(p=nn(),o=o.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=nn(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return D.resolve(u)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new eu(t,r));let o=this.Ir.get(t);o===void 0&&(o=H(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}};var _u=class{constructor(){this.sessionToken=Pe.EMPTY_BYTE_STRING}getSessionToken(e){return D.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,D.resolve()}};var Ii=class{constructor(){this.Tr=new De(pe.Er),this.dr=new De(pe.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new pe(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new pe(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new L(new he([])),r=new pe(t,e),i=new pe(t,e+1),o=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),o.push(a.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new L(new he([])),r=new pe(t,e),i=new pe(t,e+1),o=H();return this.dr.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){let t=new pe(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},pe=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return L.comparator(e.key,t.key)||ee(e.wr,t.wr)}static Ar(e,t){return ee(e.wr,t.wr)||L.comparator(e.key,t.key)}};var yu=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new De(pe.Er)}checkEmpty(e){return D.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new Xc(o,t,r,i);this.mutationQueue.push(a);for(let u of i)this.br=this.br.add(new pe(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return D.resolve(a)}lookupMutationBatch(e,t){return D.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),o=i<0?0:i;return D.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return D.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return D.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new pe(t,0),i=new pe(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],a=>{let u=this.Dr(a.wr);o.push(u)}),D.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new De(ee);return t.forEach(i=>{let o=new pe(i,0),a=new pe(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,a],u=>{r=r.add(u.wr)})}),D.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;L.isDocumentKey(o)||(o=o.child(""));let a=new pe(new L(o),0),u=new De(ee);return this.br.forEachWhile(h=>{let d=h.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(h.wr)),!0)},a),D.resolve(this.Cr(u))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ie(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return D.forEach(t.mutations,i=>{let o=new pe(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new pe(t,0),i=this.br.firstAfterOrEqual(r);return D.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,D.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var vu=class{constructor(e){this.Mr=e,this.docs=function(){return new de(L.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return D.resolve(r?r.document.mutableCopy():tt.newInvalidDocument(t))}getEntries(e,t){let r=bt();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():tt.newInvalidDocument(i))}),D.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=bt(),a=t.path,u=new L(a.child("")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){let{key:d,value:{document:p}}=h.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||IE(EE(p),r)<=0||(i.has(p.key)||vo(t,p))&&(o=o.insert(p.key,p.mutableCopy()))}return D.resolve(o)}getAllFromCollectionGroup(e,t,r,i){U()}Or(e,t){return D.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Eu(this)}getSize(e){return D.resolve(this.size)}},Eu=class extends du{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),D.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var Iu=class{constructor(e){this.persistence=e,this.Nr=new qt(t=>ll(t),hl),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Ii,this.targetCount=0,this.kr=Ei.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),D.resolve()}getLastRemoteSnapshotVersion(e){return D.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return D.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),D.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),D.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Ei(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,D.resolve()}updateTargetData(e,t){return this.Kn(t),D.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,D.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Nr.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.Nr.delete(a),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),D.waitFor(o).next(()=>i)}getTargetCount(e){return D.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return D.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),D.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),D.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),D.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return D.resolve(r)}containsKey(e,t){return D.resolve(this.Br.containsKey(t))}};var wu=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new _p(0),this.Kr=!1,this.Kr=!0,this.$r=new _u,this.referenceDelegate=e(this),this.Ur=new Iu(this),this.indexManager=new lu,this.remoteDocumentCache=function(i){return new vu(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new uu(t),this.Gr=new mu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new gu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new yu(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){O("MemoryPersistence","Starting transaction:",e);let i=new Tu(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,t){return D.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},Tu=class extends Oc{constructor(e){super(),this.currentSequenceNumber=e}},Au=class n{constructor(e){this.persistence=e,this.Jr=new Ii,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw U()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),D.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),D.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),D.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return D.forEach(this.Xr,r=>{let i=L.fromPath(r);return this.ei(e,i).next(o=>{o||t.removeEntry(i,q.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return D.or([()=>D.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var bu=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=H(),i=H();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var Su=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Cu=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Zd()?8:TE(je())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Yi(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.Zi(e,t,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;let a=new Su;return this.Xi(e,t,a).next(u=>{if(o.result=u,this.zi)return this.es(e,t,a,u.size)})}).next(()=>o.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(ci()<=W.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",On(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),D.resolve()):(ci()<=W.DEBUG&&O("QueryEngine","Query:",On(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(ci()<=W.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",On(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ot(t))):D.resolve())}Yi(e,t){if(Kf(t))return D.resolve(null);let r=ot(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Qc(t,null,"F"),r=ot(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let a=H(...o);return this.Ji.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(h=>{let d=this.ts(t,u);return this.ns(t,d,a,h.readTime)?this.Yi(e,Qc(t,null,"F")):this.rs(e,d,t,h)}))})))}Zi(e,t,r,i){return Kf(t)||i.isEqual(q.min())?D.resolve(null):this.Ji.getDocuments(e,r).next(o=>{let a=this.ts(t,o);return this.ns(t,a,r,i)?D.resolve(null):(ci()<=W.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),On(t)),this.rs(e,a,t,vE(i,-1)).next(u=>u))})}ts(e,t){let r=new De(Rp(e));return t.forEach((i,o)=>{vo(e,o)&&(r=r.add(o))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,t,r){return ci()<=W.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",On(t)),this.Ji.getDocumentsMatchingQuery(e,t,an.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}};var Ru=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new de(ee),this._s=new qt(o=>ll(o),hl),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new pu(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function pI(n,e,t,r){return new Ru(n,e,t,r)}function Hp(n,e){return A(this,null,function*(){let t=j(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],u=[],h=H();for(let d of i){a.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}for(let d of o){u.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:u}))})})})}function mI(n,e){let t=j(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(u,h,d,p){let I=d.batch,S=I.keys(),C=D.resolve();return S.forEach(k=>{C=C.next(()=>p.getEntry(h,k)).next(x=>{let N=d.docVersions.get(k);ie(N!==null),x.version.compareTo(N)<0&&(I.applyToRemoteDocument(x,d),x.isValidDocument()&&(x.setReadTime(d.commitVersion),p.addEntry(x)))})}),C.next(()=>u.mutationQueue.removeMutationBatch(h,I))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let h=H();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Kp(n){let e=j(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function gI(n,e){let t=j(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let a=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let u=[];e.targetChanges.forEach((p,I)=>{let S=i.get(I);if(!S)return;u.push(t.Ur.removeMatchingKeys(o,p.removedDocuments,I).next(()=>t.Ur.addMatchingKeys(o,p.addedDocuments,I)));let C=S.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(I)!==null?C=C.withResumeToken(Pe.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):p.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(p.resumeToken,r)),i=i.insert(I,C),function(x,N,z){return x.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0}(S,C,p)&&u.push(t.Ur.updateTargetData(o,C))});let h=bt(),d=H();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(o,p))}),u.push(_I(o,a,e.documentUpdates).next(p=>{h=p.Ps,d=p.Is})),!r.isEqual(q.min())){let p=t.Ur.getLastRemoteSnapshotVersion(o).next(I=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));u.push(p)}return D.waitFor(u).next(()=>a.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,h,d)).next(()=>h)}).then(o=>(t.os=i,o))}function _I(n,e,t){let r=H(),i=H();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let a=bt();return t.forEach((u,h)=>{let d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(q.min())?(e.removeEntry(u,h.readTime),a=a.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),a=a.insert(u,h)):O("LocalStore","Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)}),{Ps:a,Is:i}})}function yI(n,e){let t=j(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function vI(n,e){let t=j(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(o=>o?(i=o,D.resolve(i)):t.Ur.allocateTargetId(r).next(a=>(i=new vi(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function Du(n,e,t){return A(this,null,function*(){let r=j(n),i=r.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!Ci(a))throw a;O("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function sp(n,e,t){let r=j(n),i=q.min(),o=H();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,d,p){let I=j(h),S=I._s.get(p);return S!==void 0?D.resolve(I.os.get(S)):I.Ur.getTargetData(d,p)}(r,a,ot(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,u.targetId).next(h=>{o=h})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,t?i:q.min(),t?o:H())).next(u=>(EI(r,OE(e),u),{documents:u,Ts:o})))}function EI(n,e,t){let r=n.us.get(e)||q.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.us.set(e,r)}var Xs=class{constructor(){this.activeTargetIds=jE()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Pu=class{constructor(){this.so=new Xs,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Xs,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Nu=class{_o(e){}shutdown(){}};var Zs=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){O("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){O("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Ms=null;function Ac(){return Ms===null?Ms=function(){return 268435456+Math.round(2147483648*Math.random())}():Ms++,"0x"+Ms.toString(16)}var II={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var ku=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Re="WebChannelConnection",Vu=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(t,r,i,o,a){let u=Ac(),h=this.xo(t,r.toUriEncodedString());O("RestConnection",`Sending RPC '${t}' ${u}:`,h,i);let d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,o,a),this.No(t,h,d,i).then(p=>(O("RestConnection",`Received RPC '${t}' ${u}: `,p),p),p=>{throw jn("RestConnection",`RPC '${t}' ${u} failed with error: `,p,"url: ",h,"request:",i),p})}Lo(t,r,i,o,a,u){return this.Mo(t,r,i,o,a)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+tr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,a)=>t[a]=o),i&&i.headers.forEach((o,a)=>t[a]=o)}xo(t,r){let i=II[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let o=Ac();return new Promise((a,u)=>{let h=new _c;h.setWithCredentials(!0),h.listenOnce(vc.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case ai.NO_ERROR:let p=h.getResponseJson();O(Re,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),a(p);break;case ai.TIMEOUT:O(Re,`RPC '${e}' ${o} timed out`),u(new F(R.DEADLINE_EXCEEDED,"Request time out"));break;case ai.HTTP_ERROR:let I=h.getStatus();if(O(Re,`RPC '${e}' ${o} failed with status:`,I,"response text:",h.getResponseText()),I>0){let S=h.getResponseJson();Array.isArray(S)&&(S=S[0]);let C=S?.error;if(C&&C.status&&C.message){let k=function(N){let z=N.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(z)>=0?z:R.UNKNOWN}(C.status);u(new F(k,C.message))}else u(new F(R.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new F(R.UNAVAILABLE,"Connection failed."));break;default:U()}}finally{O(Re,`RPC '${e}' ${o} completed.`)}});let d=JSON.stringify(i);O(Re,`RPC '${e}' ${o} sending request:`,i),h.send(t,"POST",d,r,15)})}Bo(e,t,r){let i=Ac(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=wc(),u=Ic(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.xmlHttpFactory=new yc({})),this.Oo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;let p=o.join("");O(Re,`Creating RPC '${e}' stream ${i}: ${p}`,h);let I=a.createWebChannel(p,h),S=!1,C=!1,k=new ku({Io:N=>{C?O(Re,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(S||(O(Re,`Opening RPC '${e}' stream ${i} transport.`),I.open(),S=!0),O(Re,`RPC '${e}' stream ${i} sending:`,N),I.send(N))},To:()=>I.close()}),x=(N,z,K)=>{N.listen(z,Q=>{try{K(Q)}catch(se){setTimeout(()=>{throw se},0)}})};return x(I,xn.EventType.OPEN,()=>{C||(O(Re,`RPC '${e}' stream ${i} transport opened.`),k.yo())}),x(I,xn.EventType.CLOSE,()=>{C||(C=!0,O(Re,`RPC '${e}' stream ${i} transport closed`),k.So())}),x(I,xn.EventType.ERROR,N=>{C||(C=!0,jn(Re,`RPC '${e}' stream ${i} transport errored:`,N),k.So(new F(R.UNAVAILABLE,"The operation could not be completed")))}),x(I,xn.EventType.MESSAGE,N=>{var z;if(!C){let K=N.data[0];ie(!!K);let Q=K,se=Q.error||((z=Q[0])===null||z===void 0?void 0:z.error);if(se){O(Re,`RPC '${e}' stream ${i} received error:`,se);let Ne=se.status,ne=function(_){let y=fe[_];if(y!==void 0)return Up(y)}(Ne),v=se.message;ne===void 0&&(ne=R.INTERNAL,v="Unknown error status: "+Ne+" with message "+se.message),C=!0,k.So(new F(ne,v)),I.close()}else O(Re,`RPC '${e}' stream ${i} received:`,K),k.bo(K)}}),x(u,Ec.STAT_EVENT,N=>{N.stat===xs.PROXY?O(Re,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===xs.NOPROXY&&O(Re,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{k.wo()},0),k}};function bc(){return typeof document<"u"?document:null}function Eo(n){return new iu(n,!0)}var eo=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&O("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var to=class{constructor(e,t,r,i,o,a,u,h){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new eo(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return A(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return A(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return A(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(Tt(t.toString()),Tt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new F(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>A(this,null,function*(){this.state=0,this.start()}))}I_(e){return O("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(O("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},xu=class extends to{constructor(e,t,r,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=nI(this.serializer,e),r=function(o){if(!("targetChange"in o))return q.min();let a=o.targetChange;return a.targetIds&&a.targetIds.length?q.min():a.readTime?at(a.readTime):q.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=cu(this.serializer),t.addTarget=function(o,a){let u,h=a.target;if(u=Kc(h)?{documents:sI(o,h)}:{query:oI(o,h)._t},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=Bp(o,a.resumeToken);let d=su(o,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo(q.min())>0){u.readTime=Js(o,a.snapshotVersion.toTimestamp());let d=su(o,a.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);let r=cI(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=cu(this.serializer),t.removeTarget=e,this.a_(t)}},Ou=class extends to{constructor(e,t,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return ie(!!e.streamToken),this.lastStreamToken=e.streamToken,ie(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ie(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=iI(e.writeResults,e.commitTime),r=at(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=cu(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>rI(this.serializer,r))};this.a_(t)}};var Mu=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new F(R.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,ou(t,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new F(R.UNKNOWN,o.toString())})}Lo(e,t,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Lo(e,ou(t,r),i,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new F(R.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},Fu=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Tt(t),this.D_=!1):O("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var Lu=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(a=>{r.enqueueAndForget(()=>A(this,null,function*(){fn(this)&&(O("RemoteStore","Restarting streams for network reachability change."),yield function(h){return A(this,null,function*(){let d=j(h);d.L_.add(4),yield Ri(d),d.q_.set("Unknown"),d.L_.delete(4),yield Io(d)})}(this))}))}),this.q_=new Fu(r,i)}};function Io(n){return A(this,null,function*(){if(fn(n))for(let e of n.B_)yield e(!0)})}function Ri(n){return A(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Qp(n,e){let t=j(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),yl(t)?_l(t):nr(t).r_()&&gl(t,e))}function ml(n,e){let t=j(n),r=nr(t);t.N_.delete(e),r.r_()&&Jp(t,e),t.N_.size===0&&(r.r_()?r.o_():fn(t)&&t.q_.set("Unknown"))}function gl(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(q.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}nr(n).A_(e)}function Jp(n,e){n.Q_.xe(e),nr(n).R_(e)}function _l(n){n.Q_=new ru({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),nr(n).start(),n.q_.v_()}function yl(n){return fn(n)&&!nr(n).n_()&&n.N_.size>0}function fn(n){return j(n).L_.size===0}function Yp(n){n.Q_=void 0}function wI(n){return A(this,null,function*(){n.q_.set("Online")})}function TI(n){return A(this,null,function*(){n.N_.forEach((e,t)=>{gl(n,e)})})}function AI(n,e){return A(this,null,function*(){Yp(n),yl(n)?(n.q_.M_(e),_l(n)):n.q_.set("Unknown")})}function bI(n,e,t){return A(this,null,function*(){if(n.q_.set("Online"),e instanceof Ks&&e.state===2&&e.cause)try{yield function(i,o){return A(this,null,function*(){let a=o.cause;for(let u of o.targetIds)i.N_.has(u)&&(yield i.remoteSyncer.rejectListen(u,a),i.N_.delete(u),i.Q_.removeTarget(u))})}(n,e)}catch(r){O("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield no(n,r)}else if(e instanceof Un?n.Q_.Ke(e):e instanceof Hs?n.Q_.He(e):n.Q_.We(e),!t.isEqual(q.min()))try{let r=yield Kp(n.localStore);t.compareTo(r)>=0&&(yield function(o,a){let u=o.Q_.rt(a);return u.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){let p=o.N_.get(d);p&&o.N_.set(d,p.withResumeToken(h.resumeToken,a))}}),u.targetMismatches.forEach((h,d)=>{let p=o.N_.get(h);if(!p)return;o.N_.set(h,p.withResumeToken(Pe.EMPTY_BYTE_STRING,p.snapshotVersion)),Jp(o,h);let I=new vi(p.target,h,d,p.sequenceNumber);gl(o,I)}),o.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){O("RemoteStore","Failed to raise snapshot:",r),yield no(n,r)}})}function no(n,e,t){return A(this,null,function*(){if(!Ci(e))throw e;n.L_.add(1),yield Ri(n),n.q_.set("Offline"),t||(t=()=>Kp(n.localStore)),n.asyncQueue.enqueueRetryable(()=>A(this,null,function*(){O("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Io(n)}))})}function Xp(n,e){return e().catch(t=>no(n,t,e))}function wo(n){return A(this,null,function*(){let e=j(n),t=Gt(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;SI(e);)try{let i=yield yI(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,CI(e,i)}catch(i){yield no(e,i)}Zp(e)&&em(e)})}function SI(n){return fn(n)&&n.O_.length<10}function CI(n,e){n.O_.push(e);let t=Gt(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Zp(n){return fn(n)&&!Gt(n).n_()&&n.O_.length>0}function em(n){Gt(n).start()}function RI(n){return A(this,null,function*(){Gt(n).p_()})}function DI(n){return A(this,null,function*(){let e=Gt(n);for(let t of n.O_)e.m_(t.mutations)})}function PI(n,e,t){return A(this,null,function*(){let r=n.O_.shift(),i=Zc.from(r,e,t);yield Xp(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield wo(n)})}function NI(n,e){return A(this,null,function*(){e&&Gt(n).V_&&(yield function(r,i){return A(this,null,function*(){if(function(a){return KE(a)&&a!==R.ABORTED}(i.code)){let o=r.O_.shift();Gt(r).s_(),yield Xp(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield wo(r)}})}(n,e)),Zp(n)&&em(n)})}function op(n,e){return A(this,null,function*(){let t=j(n);t.asyncQueue.verifyOperationInProgress(),O("RemoteStore","RemoteStore received new credentials");let r=fn(t);t.L_.add(3),yield Ri(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Io(t)})}function kI(n,e){return A(this,null,function*(){let t=j(n);e?(t.L_.delete(2),yield Io(t)):e||(t.L_.add(2),yield Ri(t),t.q_.set("Unknown"))})}function nr(n){return n.K_||(n.K_=function(t,r,i){let o=j(t);return o.w_(),new xu(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:wI.bind(null,n),Ro:TI.bind(null,n),mo:AI.bind(null,n),d_:bI.bind(null,n)}),n.B_.push(e=>A(this,null,function*(){e?(n.K_.s_(),yl(n)?_l(n):n.q_.set("Unknown")):(yield n.K_.stop(),Yp(n))}))),n.K_}function Gt(n){return n.U_||(n.U_=function(t,r,i){let o=j(t);return o.w_(),new Ou(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:RI.bind(null,n),mo:NI.bind(null,n),f_:DI.bind(null,n),g_:PI.bind(null,n)}),n.B_.push(e=>A(this,null,function*(){e?(n.U_.s_(),yield wo(n)):(yield n.U_.stop(),n.O_.length>0&&(O("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var Uu=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new It,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let a=Date.now()+r,u=new n(e,t,a,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new F(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function vl(n,e){if(Tt("AsyncQueue",`${e}: ${n}`),Ci(n))return new F(R.UNAVAILABLE,`${e}: ${n}`);throw n}var ro=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||L.comparator(t.key,r.key):(t,r)=>L.comparator(t.key,r.key),this.keyedMap=ui(),this.sortedSet=new de(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var io=class{constructor(){this.W_=new de(L.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):U():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},Xn=class n{constructor(e,t,r,i,o,a,u,h,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,o){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,ro.emptySet(t),a,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Bu=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},ju=class{constructor(){this.queries=ap(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=j(t),o=i.queries;i.queries=ap(),o.forEach((a,u)=>{for(let h of u.j_)h.onError(r)})})(this,new F(R.ABORTED,"Firestore shutting down"))}};function ap(){return new qt(n=>Cp(n),yo)}function VI(n,e){return A(this,null,function*(){let t=j(n),r=3,i=e.query,o=t.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new Bu,r=e.J_()?0:1);try{switch(r){case 0:o.z_=yield t.onListen(i,!0);break;case 1:o.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let u=vl(a,`Initialization of query '${On(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&El(t)})}function xI(n,e){return A(this,null,function*(){let t=j(n),r=e.query,i=3,o=t.queries.get(r);if(o){let a=o.j_.indexOf(e);a>=0&&(o.j_.splice(a,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function OI(n,e){let t=j(n),r=!1;for(let i of e){let o=i.query,a=t.queries.get(o);if(a){for(let u of a.j_)u.X_(i)&&(r=!0);a.z_=i}}r&&El(t)}function MI(n,e,t){let r=j(n),i=r.queries.get(e);if(i)for(let o of i.j_)o.onError(t);r.queries.delete(e)}function El(n){n.Y_.forEach(e=>{e.next()})}var qu,cp;(cp=qu||(qu={})).ea="default",cp.Cache="cache";var Gu=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Xn(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Xn.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==qu.Cache}};var so=class{constructor(e){this.key=e}},oo=class{constructor(e){this.key=e}},$u=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=H(),this.mutatedKeys=H(),this.Aa=Rp(e),this.Ra=new ro(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new io,i=t?t.Ra:this.Ra,o=t?t.mutatedKeys:this.mutatedKeys,a=i,u=!1,h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,I)=>{let S=i.get(p),C=vo(this.query,I)?I:null,k=!!S&&this.mutatedKeys.has(S.key),x=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations),N=!1;S&&C?S.data.isEqual(C.data)?k!==x&&(r.track({type:3,doc:C}),N=!0):this.ga(S,C)||(r.track({type:2,doc:C}),N=!0,(h&&this.Aa(C,h)>0||d&&this.Aa(C,d)<0)&&(u=!0)):!S&&C?(r.track({type:0,doc:C}),N=!0):S&&!C&&(r.track({type:1,doc:S}),N=!0,(h||d)&&(u=!0)),N&&(C?(a=a.add(C),o=x?o.add(p):o.delete(p)):(a=a.delete(p),o=o.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),o=o.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:u,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let a=e.fa.G_();a.sort((p,I)=>function(C,k){let x=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return U()}};return x(C)-x(k)}(p.type,I.type)||this.Aa(p.doc,I.doc)),this.pa(r),i=i!=null&&i;let u=t&&!i?this.ya():[],h=this.da.size===0&&this.current&&!i?1:0,d=h!==this.Ea;return this.Ea=h,a.length!==0||d?{snapshot:new Xn(this.query,e.Ra,o,a,e.mutatedKeys,h===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new io,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=H(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new oo(r))}),this.da.forEach(r=>{e.has(r)||t.push(new so(r))}),t}ba(e){this.Ta=e.Ts,this.da=H();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Xn.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},zu=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Wu=class{constructor(e){this.key=e,this.va=!1}},Hu=class{constructor(e,t,r,i,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new qt(u=>Cp(u),yo),this.Ma=new Map,this.xa=new Set,this.Oa=new de(L.comparator),this.Na=new Map,this.La=new Ii,this.Ba={},this.ka=new Map,this.qa=Ei.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function FI(n,e,t=!0){return A(this,null,function*(){let r=om(n),i,o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=yield tm(r,e,t,!0),i})}function LI(n,e){return A(this,null,function*(){let t=om(n);yield tm(t,e,!0,!1)})}function tm(n,e,t,r){return A(this,null,function*(){let i=yield vI(n.localStore,ot(e)),o=i.targetId,a=n.sharedClientState.addLocalQueryTarget(o,t),u;return r&&(u=yield UI(n,e,o,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&Qp(n.remoteStore,i),u})}function UI(n,e,t,r,i){return A(this,null,function*(){n.Ka=(I,S,C)=>function(x,N,z,K){return A(this,null,function*(){let Q=N.view.ma(z);Q.ns&&(Q=yield sp(x.localStore,N.query,!1).then(({documents:v})=>N.view.ma(v,Q)));let se=K&&K.targetChanges.get(N.targetId),Ne=K&&K.targetMismatches.get(N.targetId)!=null,ne=N.view.applyChanges(Q,x.isPrimaryClient,se,Ne);return lp(x,N.targetId,ne.wa),ne.snapshot})}(n,I,S,C);let o=yield sp(n.localStore,e,!0),a=new $u(e,o.Ts),u=a.ma(o.documents),h=yi.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(u,n.isPrimaryClient,h);lp(n,t,d.wa);let p=new zu(e,t,a);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot})}function BI(n,e,t){return A(this,null,function*(){let r=j(n),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(a=>!yo(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Du(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&ml(r.remoteStore,i.targetId),Ku(r,i.targetId)}).catch(Si))):(Ku(r,i.targetId),yield Du(r.localStore,i.targetId,!0))})}function jI(n,e){return A(this,null,function*(){let t=j(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),ml(t.remoteStore,r.targetId))})}function qI(n,e,t){return A(this,null,function*(){let r=QI(n);try{let i=yield function(a,u){let h=j(a),d=we.now(),p=u.reduce((C,k)=>C.add(k.key),H()),I,S;return h.persistence.runTransaction("Locally write mutations","readwrite",C=>{let k=bt(),x=H();return h.cs.getEntries(C,p).next(N=>{k=N,k.forEach((z,K)=>{K.isValidDocument()||(x=x.add(z))})}).next(()=>h.localDocuments.getOverlayedDocuments(C,k)).next(N=>{I=N;let z=[];for(let K of u){let Q=HE(K,I.get(K.key).overlayedDocument);Q!=null&&z.push(new lt(K.key,Q,Ip(Q.value.mapValue),wt.exists(!0)))}return h.mutationQueue.addMutationBatch(C,d,z,u)}).next(N=>{S=N;let z=N.applyToLocalDocumentSet(I,x);return h.documentOverlayCache.saveOverlays(C,N.batchId,z)})}).then(()=>({batchId:S.batchId,changes:Pp(I)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,h){let d=a.Ba[a.currentUser.toKey()];d||(d=new de(ee)),d=d.insert(u,h),a.Ba[a.currentUser.toKey()]=d}(r,i.batchId,t),yield Di(r,i.changes),yield wo(r.remoteStore)}catch(i){let o=vl(i,"Failed to persist write");t.reject(o)}})}function nm(n,e){return A(this,null,function*(){let t=j(n);try{let r=yield gI(t.localStore,e);e.targetChanges.forEach((i,o)=>{let a=t.Na.get(o);a&&(ie(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?ie(a.va):i.removedDocuments.size>0&&(ie(a.va),a.va=!1))}),yield Di(t,r,e)}catch(r){yield Si(r)}})}function up(n,e,t){let r=j(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((o,a)=>{let u=a.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){let h=j(a);h.onlineState=u;let d=!1;h.queries.forEach((p,I)=>{for(let S of I.j_)S.Z_(u)&&(d=!0)}),d&&El(h)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function GI(n,e,t){return A(this,null,function*(){let r=j(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),o=i&&i.key;if(o){let a=new de(L.comparator);a=a.insert(o,tt.newNoDocument(o,q.min()));let u=H().add(o),h=new Ws(q.min(),new Map,new de(ee),a,u);yield nm(r,h),r.Oa=r.Oa.remove(o),r.Na.delete(e),Il(r)}else yield Du(r.localStore,e,!1).then(()=>Ku(r,e,t)).catch(Si)})}function $I(n,e){return A(this,null,function*(){let t=j(n),r=e.batch.batchId;try{let i=yield mI(t.localStore,e);im(t,r,null),rm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Di(t,i)}catch(i){yield Si(i)}})}function zI(n,e,t){return A(this,null,function*(){let r=j(n);try{let i=yield function(a,u){let h=j(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return h.mutationQueue.lookupMutationBatch(d,u).next(I=>(ie(I!==null),p=I.keys(),h.mutationQueue.removeMutationBatch(d,I))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>h.localDocuments.getDocuments(d,p))})}(r.localStore,e);im(r,e,t),rm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Di(r,i)}catch(i){yield Si(i)}})}function rm(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function im(n,e,t){let r=j(n),i=r.Ba[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Ku(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||sm(n,r)})}function sm(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(ml(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Il(n))}function lp(n,e,t){for(let r of t)r instanceof so?(n.La.addReference(r.key,e),WI(n,r)):r instanceof oo?(O("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||sm(n,r.key)):U()}function WI(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(O("SyncEngine","New document in limbo: "+t),n.xa.add(r),Il(n))}function Il(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new L(he.fromString(e)),r=n.qa.next();n.Na.set(r,new Wu(t)),n.Oa=n.Oa.insert(t,r),Qp(n.remoteStore,new vi(ot(dl(t.path)),r,"TargetPurposeLimboResolution",_p.oe))}}function Di(n,e,t){return A(this,null,function*(){let r=j(n),i=[],o=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((u,h)=>{a.push(r.Ka(h,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let I=d?!d.fromCache:(p=t?.targetChanges.get(h.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(h.targetId,I?"current":"not-current")}if(d){i.push(d);let I=bu.Wi(h.targetId,d);o.push(I)}}))}),yield Promise.all(a),r.Ca.d_(i),yield function(h,d){return A(this,null,function*(){let p=j(h);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",I=>D.forEach(d,S=>D.forEach(S.$i,C=>p.persistence.referenceDelegate.addReference(I,S.targetId,C)).next(()=>D.forEach(S.Ui,C=>p.persistence.referenceDelegate.removeReference(I,S.targetId,C)))))}catch(I){if(!Ci(I))throw I;O("LocalStore","Failed to update sequence numbers: "+I)}for(let I of d){let S=I.targetId;if(!I.fromCache){let C=p.os.get(S),k=C.snapshotVersion,x=C.withLastLimboFreeSnapshotVersion(k);p.os=p.os.insert(S,x)}}})}(r.localStore,o))})}function HI(n,e){return A(this,null,function*(){let t=j(n);if(!t.currentUser.isEqual(e)){O("SyncEngine","User change. New user:",e.toKey());let r=yield Hp(t.localStore,e);t.currentUser=e,function(o,a){o.ka.forEach(u=>{u.forEach(h=>{h.reject(new F(R.CANCELLED,a))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Di(t,r.hs)}})}function KI(n,e){let t=j(n),r=t.Na.get(e);if(r&&r.va)return H().add(r.key);{let i=H(),o=t.Ma.get(e);if(!o)return i;for(let a of o){let u=t.Fa.get(a);i=i.unionWith(u.view.Va)}return i}}function om(n){let e=j(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=nm.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=KI.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=GI.bind(null,e),e.Ca.d_=OI.bind(null,e.eventManager),e.Ca.$a=MI.bind(null,e.eventManager),e}function QI(n){let e=j(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$I.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zI.bind(null,e),e}var ao=class{constructor(){this.synchronizeTabs=!1}initialize(e){return A(this,null,function*(){this.serializer=Eo(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return pI(this.persistence,new Cu,e.initialUser,this.serializer)}createPersistence(e){return new wu(Au.Zr,this.serializer)}createSharedClientState(e){return new Pu}terminate(){return A(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Qu=class{initialize(e,t){return A(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>up(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=HI.bind(null,this.syncEngine),yield kI(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new ju}()}createDatastore(e){let t=Eo(e.databaseInfo.databaseId),r=function(o){return new Vu(o)}(e.databaseInfo);return function(o,a,u,h){return new Mu(o,a,u,h)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,o,a,u){return new Lu(r,i,o,a,u)}(this.localStore,this.datastore,e.asyncQueue,t=>up(this.syncEngine,t,0),function(){return Zs.D()?new Zs:new Nu}())}createSyncEngine(e,t){return function(i,o,a,u,h,d,p){let I=new Hu(i,o,a,u,h,d);return p&&(I.Qa=!0),I}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return A(this,null,function*(){var e,t;yield function(i){return A(this,null,function*(){let o=j(i);O("RemoteStore","RemoteStore shutting down."),o.L_.add(5),yield Ri(o),o.k_.shutdown(),o.q_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()})}};var Ju=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ga(this.observer.next,e)}error(e){this.observer.error?this.Ga(this.observer.error,e):Tt("Uncaught Error in snapshot listener:",e.toString())}za(){this.muted=!0}Ga(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var Yu=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ye.UNAUTHENTICATED,this.clientId=Bs.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,o=>A(this,null,function*(){O("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(O("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new F(R.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new It;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>A(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=vl(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Sc(n,e){return A(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),O("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>A(this,null,function*(){r.isEqual(i)||(yield Hp(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function hp(n,e){return A(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield YI(n);O("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>op(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>op(e.remoteStore,i)),n._onlineComponents=e})}function JI(n){return n.name==="FirebaseError"?n.code===R.FAILED_PRECONDITION||n.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function YI(n){return A(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){O("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Sc(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!JI(t))throw t;jn("Error using user provided cache. Falling back to memory cache: "+t),yield Sc(n,new ao)}}else O("FirestoreClient","Using default OfflineComponentProvider"),yield Sc(n,new ao);return n._offlineComponents})}function am(n){return A(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(O("FirestoreClient","Using user provided OnlineComponentProvider"),yield hp(n,n._uninitializedComponentsProvider._online)):(O("FirestoreClient","Using default OnlineComponentProvider"),yield hp(n,new Qu))),n._onlineComponents})}function XI(n){return am(n).then(e=>e.syncEngine)}function dp(n){return A(this,null,function*(){let e=yield am(n),t=e.eventManager;return t.onListen=FI.bind(null,e.syncEngine),t.onUnlisten=BI.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=LI.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=jI.bind(null,e.syncEngine),t})}function cm(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var fp=new Map;function um(n,e,t){if(!t)throw new F(R.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function ZI(n,e,t,r){if(e===!0&&r===!0)throw new F(R.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function pp(n){if(!L.isDocumentKey(n))throw new F(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function mp(n){if(L.isDocumentKey(n))throw new F(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function wl(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":U()}function Ut(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new F(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=wl(n);throw new F(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var co=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new F(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new F(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ZI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=cm((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new F(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new F(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new F(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Zn=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new co({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new F(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new F(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new co(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Cc;switch(r.type){case"firstParty":return new Nc(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new F(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=fp.get(t);r&&(O("ComponentProvider","Removing Datastore"),fp.delete(t),r.terminate())}(this),Promise.resolve()}};function lm(n,e,t,r={}){var i;let o=(n=Ut(n,Zn))._getSettings(),a=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==a&&jn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),r.mockUserToken){let u,h;if(typeof r.mockUserToken=="string")u=r.mockUserToken,h=ye.MOCK_USER;else{u=Kd(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new F(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new ye(d)}n._authCredentials=new Rc(new Us(u,h))}}var uo=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},$e=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Bt=class n extends uo{constructor(e,t,r){super(e,t,dl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new $e(this.firestore,null,new L(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function hm(n,e,...t){if(n=Oe(n),um("collection","path",e),n instanceof Zn){let r=he.fromString(e,...t);return mp(r),new Bt(n,null,r)}{if(!(n instanceof $e||n instanceof Bt))throw new F(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(he.fromString(e,...t));return mp(r),new Bt(n.firestore,null,r)}}function Tl(n,e,...t){if(n=Oe(n),arguments.length===1&&(e=Bs.newId()),um("doc","path",e),n instanceof Zn){let r=he.fromString(e,...t);return pp(r),new $e(n,null,new L(r))}{if(!(n instanceof $e||n instanceof Bt))throw new F(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(he.fromString(e,...t));return pp(r),new $e(n.firestore,n instanceof Bt?n.converter:null,new L(r))}}var Xu=class{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new eo(this,"async_queue_retry"),this.Eu=()=>{let t=bc();t&&O("AsyncQueue","Visibility state changed to "+t.visibilityState),this.t_.jo()};let e=bc();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.du(),this.Au(e)}enterRestrictedMode(e){if(!this.cu){this.cu=!0,this.Iu=e||!1;let t=bc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Eu)}}enqueue(e){if(this.du(),this.cu)return new Promise(()=>{});let t=new It;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.uu.push(e),this.Ru()))}Ru(){return A(this,null,function*(){if(this.uu.length!==0){try{yield this.uu[0](),this.uu.shift(),this.t_.reset()}catch(e){if(!Ci(e))throw e;O("AsyncQueue","Operation failed with retryable error: "+e)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}})}Au(e){let t=this.au.then(()=>(this.Pu=!0,e().catch(r=>{this.hu=r,this.Pu=!1;let i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(r);throw Tt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Pu=!1,r))));return this.au=t,t}enqueueAfterDelay(e,t,r){this.du(),this.Tu.indexOf(e)>-1&&(t=0);let i=Uu.createAndSchedule(this,e,t,r,o=>this.Vu(o));return this.lu.push(i),i}du(){this.hu&&U()}verifyOperationInProgress(){}mu(){return A(this,null,function*(){let e;do e=this.au,yield e;while(e!==this.au)})}fu(e){for(let t of this.lu)if(t.timerId===e)return!0;return!1}gu(e){return this.mu().then(()=>{this.lu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.lu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.mu()})}pu(e){this.Tu.push(e)}Vu(e){let t=this.lu.indexOf(e);this.lu.splice(t,1)}};function gp(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var $t=class extends Zn{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new Xu}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||pm(this),this._firestoreClient.terminate()}};function dm(n,e){let t=typeof n=="object"?n:Yr(),r=typeof n=="string"?n:e||"(default)",i=Ya(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=Wd("firestore");o&&lm(i,...o)}return i}function fm(n){return n._firestoreClient||pm(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function pm(n){var e,t,r;let i=n._freezeSettings(),o=function(u,h,d,p){return new Mc(u,h,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,cm(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new Yu(n._authCredentials,n._appCheckCredentials,n._queue,o),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var wi=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Pe.fromBase64String(e))}catch(t){throw new F(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Pe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var er=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new F(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ge(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Ti=class{constructor(e){this._methodName=e}};var Ai=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new F(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new F(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}};var bi=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var ew=/^__.*__$/,Zu=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new lt(e,this.data,this.fieldMask,t,this.fieldTransforms):new hn(e,this.data,t,this.fieldTransforms)}},lo=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new lt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function mm(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw U()}}var el=class n{constructor(e,t,r,i,o,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.yu(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.vu(e),i}Cu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.yu(),i}Fu(e){return this.Su({path:void 0,Du:!0})}Mu(e){return fo(e,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}yu(){if(this.path)for(let e=0;e<this.path.length;e++)this.vu(this.path.get(e))}vu(e){if(e.length===0)throw this.Mu("Document fields must not be empty");if(mm(this.wu)&&ew.test(e))throw this.Mu('Document fields cannot begin and end with "__"')}},tl=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Eo(e)}Nu(e,t,r,i=!1){return new el({wu:e,methodName:t,Ou:r,path:Ge.emptyPath(),Du:!1,xu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function gm(n){let e=n._freezeSettings(),t=Eo(n._databaseId);return new tl(n._databaseId,!!e.ignoreUndefinedProperties,t)}function tw(n,e,t,r,i,o={}){let a=n.Nu(o.merge||o.mergeFields?2:0,e,t,i);Al("Data must be an object, but it was:",a,r);let u=_m(r,a),h,d;if(o.merge)h=new Qe(a.fieldMask),d=a.fieldTransforms;else if(o.mergeFields){let p=[];for(let I of o.mergeFields){let S=nl(e,I,t);if(!a.contains(S))throw new F(R.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);vm(p,S)||p.push(S)}h=new Qe(p),d=a.fieldTransforms.filter(I=>h.covers(I.field))}else h=null,d=a.fieldTransforms;return new Zu(new qe(u),h,d)}var ho=class n extends Ti{_toFieldTransform(e){if(e.wu!==2)throw e.wu===1?e.Mu(`${this._methodName}() can only appear at the top level of your update data`):e.Mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function nw(n,e,t,r){let i=n.Nu(1,e,t);Al("Data must be an object, but it was:",i,r);let o=[],a=qe.empty();dn(r,(h,d)=>{let p=bl(e,h,t);d=Oe(d);let I=i.Cu(p);if(d instanceof ho)o.push(p);else{let S=To(d,I);S!=null&&(o.push(p),a.set(p,S))}});let u=new Qe(o);return new lo(a,u,i.fieldTransforms)}function rw(n,e,t,r,i,o){let a=n.Nu(1,e,t),u=[nl(e,r,t)],h=[i];if(o.length%2!=0)throw new F(R.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let S=0;S<o.length;S+=2)u.push(nl(e,o[S])),h.push(o[S+1]);let d=[],p=qe.empty();for(let S=u.length-1;S>=0;--S)if(!vm(d,u[S])){let C=u[S],k=h[S];k=Oe(k);let x=a.Cu(C);if(k instanceof ho)d.push(C);else{let N=To(k,x);N!=null&&(d.push(C),p.set(C,N))}}let I=new Qe(d);return new lo(p,I,a.fieldTransforms)}function To(n,e){if(ym(n=Oe(n)))return Al("Unsupported field value:",e,n),_m(n,e);if(n instanceof Ti)return function(r,i){if(!mm(i.wu))throw i.Mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Mu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Du&&e.wu!==4)throw e.Mu("Nested arrays are not supported");return function(r,i){let o=[],a=0;for(let u of r){let h=To(u,i.Fu(a));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),a++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=Oe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return qE(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=we.fromDate(r);return{timestampValue:Js(i.serializer,o)}}if(r instanceof we){let o=new we(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Js(i.serializer,o)}}if(r instanceof Ai)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof wi)return{bytesValue:Bp(i.serializer,r._byteString)};if(r instanceof $e){let o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.Mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:pl(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof bi)return function(a,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw u.Mu("VectorValues must only contain numeric values.");return fl(u.serializer,h)})}}}}}}(r,i);throw i.Mu(`Unsupported field value: ${wl(r)}`)}(n,e)}function _m(n,e){let t={};return yp(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):dn(n,(r,i)=>{let o=To(i,e.bu(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function ym(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof we||n instanceof Ai||n instanceof wi||n instanceof $e||n instanceof Ti||n instanceof bi)}function Al(n,e,t){if(!ym(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=wl(t);throw r==="an object"?e.Mu(n+" a custom object"):e.Mu(n+" "+r)}}function nl(n,e,t){if((e=Oe(e))instanceof er)return e._internalPath;if(typeof e=="string")return bl(n,e);throw fo("Field path arguments must be of type string or ",n,!1,void 0,t)}var iw=new RegExp("[~\\*/\\[\\]]");function bl(n,e,t){if(e.search(iw)>=0)throw fo(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new er(...e.split("."))._internalPath}catch{throw fo(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function fo(n,e,t,r,i){let o=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new F(R.INVALID_ARGUMENT,u+n+h)}function vm(n,e){return n.some(t=>t.isEqual(e))}var po=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new $e(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new rl(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Em("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},rl=class extends po{data(){return super.data()}};function Em(n,e){return typeof e=="string"?bl(n,e):e instanceof er?e._internalPath:e._delegate._internalPath}function sw(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new F(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var il=class{convertValue(e,t="none"){switch(cn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ae(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(jt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw U()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return dn(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>ae(a.doubleValue));return new bi(o)}convertGeoPoint(e){return new Ai(ae(e.latitude),ae(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=cl(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(mi(e));default:return null}}convertTimestamp(e){let t=At(e);return new we(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=he.fromString(e);ie(Wp(r));let i=new $s(r.get(1),r.get(3)),o=new L(r.popFirst(5));return i.isEqual(t)||Tt(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function ow(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var sn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},mo=class extends po{constructor(e,t,r,i,o,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Bn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Em("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Bn=class extends mo{data(e={}){return super.data(e)}},sl=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new sn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Bn(this._firestore,this._userDataWriter,r.key,r,new sn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new F(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let h=new Bn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new sn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{let h=new Bn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new sn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),p=a.indexOf(u.doc.key)),{type:aw(u.type),doc:h,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function aw(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return U()}}var go=class extends il{constructor(e){super(),this.firestore=e}convertBytes(e){return new wi(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new $e(this.firestore,null,t)}};function Im(n,e,t,...r){n=Ut(n,$e);let i=Ut(n.firestore,$t),o=gm(i),a;return a=typeof(e=Oe(e))=="string"||e instanceof er?rw(o,"updateDoc",n._key,e,t,r):nw(o,"updateDoc",n._key,e),Cl(i,[a.toMutation(n._key,wt.exists(!0))])}function wm(n){return Cl(Ut(n.firestore,$t),[new _i(n._key,wt.none())])}function Tm(n,e){let t=Ut(n.firestore,$t),r=Tl(n),i=ow(n.converter,e);return Cl(t,[tw(gm(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,wt.exists(!1))]).then(()=>r)}function Sl(n,...e){var t,r,i;n=Oe(n);let o={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||gp(e[a])||(o=e[a],a++);let u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(gp(e[a])){let I=e[a];e[a]=(t=I.next)===null||t===void 0?void 0:t.bind(I),e[a+1]=(r=I.error)===null||r===void 0?void 0:r.bind(I),e[a+2]=(i=I.complete)===null||i===void 0?void 0:i.bind(I)}let h,d,p;if(n instanceof $e)d=Ut(n.firestore,$t),p=dl(n._key.path),h={next:I=>{e[a]&&e[a](cw(d,n,I))},error:e[a+1],complete:e[a+2]};else{let I=Ut(n,uo);d=Ut(I.firestore,$t),p=I._query;let S=new go(d);h={next:C=>{e[a]&&e[a](new sl(d,S,I,C))},error:e[a+1],complete:e[a+2]},sw(n._query)}return function(S,C,k,x){let N=new Ju(x),z=new Gu(C,N,k);return S.asyncQueue.enqueueAndForget(()=>A(this,null,function*(){return VI(yield dp(S),z)})),()=>{N.za(),S.asyncQueue.enqueueAndForget(()=>A(this,null,function*(){return xI(yield dp(S),z)}))}}(fm(d),p,u,h)}function Cl(n,e){return function(r,i){let o=new It;return r.asyncQueue.enqueueAndForget(()=>A(this,null,function*(){return qI(yield XI(r),i,o)})),o.promise}(fm(n),e)}function cw(n,e,t){let r=t.docs.get(e._key),i=new go(n);return new mo(n,i,e._key,r,new sn(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){tr=i})(Nn),Mt(new Ke("firestore",(r,{instanceIdentifier:i,options:o})=>{let a=r.getProvider("app").getImmediate(),u=new $t(new Dc(r.getProvider("auth-internal")),new Vc(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new F(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $s(d.options.projectId,p)}(a,i),a);return o=Object.assign({useFetchStreams:t},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),_e(Uf,"4.7.2",e),_e(Uf,"4.7.2","esm2017")})();var Ao=function(){return Ao=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ao.apply(this,arguments)};var hw={includeMetadataChanges:!1};function Am(n,e){return e===void 0&&(e=hw),new Ar(function(t){var r=Sl(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function bm(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:Ao(Ao({},r),(t={},t[e.idField]=n.id,t))}function Sm(n){return Am(n,{includeMetadataChanges:!0}).pipe(ze(function(e){return e.docs}))}function Cm(n,e){return e===void 0&&(e={}),Sm(n).pipe(ze(function(t){return t.map(function(r){return bm(r,e)})}))}var pn=class{constructor(e){return e}},Rm="firestore",Rl=class{constructor(){return Zr(Rm)}};var Dl=new Ee("angularfire2.firestore-instances");function dw(n,e){let t=ec(Rm,n,e);return t&&new pn(t)}function fw(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new pn(r)}}var pw={provide:Rl,deps:[[new mt,Dl]]},mw={provide:pn,useFactory:dw,deps:[[new mt,Dl],Zt]};function Dm(n,...e){return _e("angularfire",Vn.full,"fst"),gt([mw,pw,{provide:Dl,useFactory:fw(n),multi:!0,deps:[xe,Jt,ei,ti,[new mt,ks],[new mt,Xr],...e]}])}var Pm=et(Cm,!0);var rr=et(Tm,!0);var mn=et(hm,!0);var Nm=et(wm,!0);var Pl=et(Tl,!0);var km=et(dm,!0);var Vm=et(Im,!0);function _w(n,e){if(n&1){let t=We();V(0,"div",11)(1,"h2"),B(2,"Lebensmittel Eintragen"),M(),V(3,"form",15),ue("ngSubmit",function(){Y(t);let i=$(2);return X(i.addFood())}),V(4,"div",16)(5,"label",17),B(6,"Lebensmittel:"),M(),V(7,"input",18),Ue("ngModelChange",function(i){Y(t);let o=$(2);return Le(o.foodName,i)||(o.foodName=i),X(i)}),M()(),V(8,"div",16)(9,"label",19),B(10,"Menge:"),M(),V(11,"input",20),Ue("ngModelChange",function(i){Y(t);let o=$(2);return Le(o.amount,i)||(o.amount=i),X(i)}),M()(),V(12,"div",16)(13,"label",21),B(14,"Getr\xE4nke:"),M(),V(15,"input",22),Ue("ngModelChange",function(i){Y(t);let o=$(2);return Le(o.beverages,i)||(o.beverages=i),X(i)}),M()(),V(16,"div",16)(17,"label",23),B(18,"Uhrzeit:"),M(),V(19,"input",24),Ue("ngModelChange",function(i){Y(t);let o=$(2);return Le(o.time,i)||(o.time=i),X(i)}),M()(),V(20,"button",25),B(21,"Hinzuf\xFCgen"),M()()()}if(n&2){let t=$(2);G(7),Fe("ngModel",t.foodName),G(4),Fe("ngModel",t.amount),G(4),Fe("ngModel",t.beverages),G(4),Fe("ngModel",t.time)}}function yw(n,e){if(n&1){let t=We();V(0,"div",11)(1,"h2"),B(2,"Symptome Eintragen"),M(),V(3,"form",15),ue("ngSubmit",function(){Y(t);let i=$(2);return X(i.addSymptoms())}),V(4,"div",16)(5,"label",26),B(6,"Symptome:"),M(),V(7,"input",27),Ue("ngModelChange",function(i){Y(t);let o=$(2);return Le(o.symptoms,i)||(o.symptoms=i),X(i)}),M()(),V(8,"div",16)(9,"label",23),B(10,"Uhrzeit:"),M(),V(11,"input",24),Ue("ngModelChange",function(i){Y(t);let o=$(2);return Le(o.time,i)||(o.time=i),X(i)}),M()(),V(12,"button",25),B(13,"Hinzuf\xFCgen"),M()()()}if(n&2){let t=$(2);G(7),Fe("ngModel",t.symptoms),G(4),Fe("ngModel",t.time)}}function vw(n,e){if(n&1){let t=We();V(0,"div",11)(1,"h2"),B(2,"Pollenbelastung Eintragen"),M(),V(3,"form",15),ue("ngSubmit",function(){Y(t);let i=$(2);return X(i.addPollen())}),V(4,"div",16)(5,"label",28),B(6,"Pollenbelastung:"),M(),V(7,"input",29),Ue("ngModelChange",function(i){Y(t);let o=$(2);return Le(o.pollen,i)||(o.pollen=i),X(i)}),M()(),V(8,"div",16)(9,"label",23),B(10,"Uhrzeit:"),M(),V(11,"input",24),Ue("ngModelChange",function(i){Y(t);let o=$(2);return Le(o.time,i)||(o.time=i),X(i)}),M()(),V(12,"button",25),B(13,"Hinzuf\xFCgen"),M()()()}if(n&2){let t=$(2);G(7),Fe("ngModel",t.pollen),G(4),Fe("ngModel",t.time)}}function Ew(n,e){if(n&1){let t=We();V(0,"div",11)(1,"h2"),B(2,"Sportaktivit\xE4ten Eintragen"),M(),V(3,"form",15),ue("ngSubmit",function(){Y(t);let i=$(2);return X(i.addSports())}),V(4,"div",16)(5,"label",30),B(6,"Sportaktivit\xE4ten:"),M(),V(7,"input",31),Ue("ngModelChange",function(i){Y(t);let o=$(2);return Le(o.sport,i)||(o.sport=i),X(i)}),M()(),V(8,"div",16)(9,"label",23),B(10,"Uhrzeit:"),M(),V(11,"input",24),Ue("ngModelChange",function(i){Y(t);let o=$(2);return Le(o.time,i)||(o.time=i),X(i)}),M()(),V(12,"button",25),B(13,"Hinzuf\xFCgen"),M()()()}if(n&2){let t=$(2);G(7),Fe("ngModel",t.sport),G(4),Fe("ngModel",t.time)}}function Iw(n,e){if(n&1){let t=We();V(0,"div",11)(1,"h2"),B(2,"Infektionen Eintragen"),M(),V(3,"form",15),ue("ngSubmit",function(){Y(t);let i=$(2);return X(i.addInfections())}),V(4,"div",16)(5,"label",32),B(6,"Infektionen:"),M(),V(7,"input",33),Ue("ngModelChange",function(i){Y(t);let o=$(2);return Le(o.infections,i)||(o.infections=i),X(i)}),M()(),V(8,"div",16)(9,"label",23),B(10,"Uhrzeit:"),M(),V(11,"input",24),Ue("ngModelChange",function(i){Y(t);let o=$(2);return Le(o.time,i)||(o.time=i),X(i)}),M()(),V(12,"button",25),B(13,"Hinzuf\xFCgen"),M()()()}if(n&2){let t=$(2);G(7),Fe("ngModel",t.infections),G(4),Fe("ngModel",t.time)}}function ww(n,e){if(n&1){let t=We();V(0,"li",34),B(1),V(2,"button",35),ue("click",function(){let i=Y(t).$implicit,o=$(2);return X(o.editEntry(i))}),B(3,"Bearbeiten"),M(),V(4,"button",36),ue("click",function(){let i=Y(t).$implicit,o=$(2);return X(o.deleteEntry(i.id))}),B(5,"L\xF6schen"),M()()}if(n&2){let t=e.$implicit;G(),Qh(" ",t.time," - ",t.name," - ",t.amount," - ",t.beverages," ")}}function Tw(n,e){if(n&1){let t=We();V(0,"li",34),B(1),V(2,"button",36),ue("click",function(){let i=Y(t).$implicit,o=$(2);return X(o.deleteEntry(i.id))}),B(3,"L\xF6schen"),M()()}if(n&2){let t=e.$implicit;G(),Or(" ",t.time," - ",t.symptoms," ")}}function Aw(n,e){if(n&1){let t=We();V(0,"li",34),B(1),V(2,"button",36),ue("click",function(){let i=Y(t).$implicit,o=$(2);return X(o.deleteEntry(i.id))}),B(3,"L\xF6schen"),M()()}if(n&2){let t=e.$implicit;G(),Or(" ",t.time," - ",t.pollen," ")}}function bw(n,e){if(n&1){let t=We();V(0,"li",34),B(1),V(2,"button",36),ue("click",function(){let i=Y(t).$implicit,o=$(2);return X(o.deleteEntry(i.id))}),B(3,"L\xF6schen"),M()()}if(n&2){let t=e.$implicit;G(),Or(" ",t.time," - ",t.sport," ")}}function Sw(n,e){if(n&1){let t=We();V(0,"li",34),B(1),V(2,"button",36),ue("click",function(){let i=Y(t).$implicit,o=$(2);return X(o.deleteEntry(i.id))}),B(3,"L\xF6schen"),M()()}if(n&2){let t=e.$implicit;G(),Or(" ",t.time," - ",t.infections," ")}}function Cw(n,e){if(n&1){let t=We();V(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),ue("click",function(){Y(t);let i=$();return X(i.changeDate(-1))}),xr(4,"i",4),M(),V(5,"input",5),Ue("ngModelChange",function(i){Y(t);let o=$();return Le(o.date,i)||(o.date=i),X(i)}),ue("change",function(i){Y(t);let o=$();return X(o.onDateChange(i))}),M(),V(6,"button",3),ue("click",function(){Y(t);let i=$();return X(i.changeDate(1))}),xr(7,"i",6),M()(),V(8,"ul",7)(9,"li",8)(10,"a",9),ue("click",function(){Y(t);let i=$();return X(i.selectTab("food"))}),B(11,"Lebensmittel"),M()(),V(12,"li",8)(13,"a",9),ue("click",function(){Y(t);let i=$();return X(i.selectTab("symptoms"))}),B(14,"Symptome"),M()(),V(15,"li",8)(16,"a",9),ue("click",function(){Y(t);let i=$();return X(i.selectTab("pollen"))}),B(17,"Pollenbelastung"),M()(),V(18,"li",8)(19,"a",9),ue("click",function(){Y(t);let i=$();return X(i.selectTab("sport"))}),B(20,"Sport"),M()(),V(21,"li",8)(22,"a",9),ue("click",function(){Y(t);let i=$();return X(i.selectTab("infections"))}),B(23,"Infektionen"),M()()(),kt(24,_w,22,4,"div",10)(25,yw,14,2,"div",10)(26,vw,14,2,"div",10)(27,Ew,14,2,"div",10)(28,Iw,14,2,"div",10),V(29,"div",11)(30,"h3",12),B(31),M(),V(32,"ul",13),kt(33,ww,6,4,"li",14),M()(),V(34,"div",11)(35,"h3",12),B(36),M(),V(37,"ul",13),kt(38,Tw,4,2,"li",14),M()(),V(39,"div",11)(40,"h3",12),B(41),M(),V(42,"ul",13),kt(43,Aw,4,2,"li",14),M()(),V(44,"div",11)(45,"h3",12),B(46),M(),V(47,"ul",13),kt(48,bw,4,2,"li",14),M()(),V(49,"div",11)(50,"h3",12),B(51),M(),V(52,"ul",13),kt(53,Sw,4,2,"li",14),M()()()()}if(n&2){let t=$();G(5),Fe("ngModel",t.date),G(5),_t("active",t.selectedTab==="food"),G(3),_t("active",t.selectedTab==="symptoms"),G(3),_t("active",t.selectedTab==="pollen"),G(3),_t("active",t.selectedTab==="sport"),G(3),_t("active",t.selectedTab==="infections"),G(2),Xe("ngIf",t.selectedTab==="food"),G(),Xe("ngIf",t.selectedTab==="symptoms"),G(),Xe("ngIf",t.selectedTab==="pollen"),G(),Xe("ngIf",t.selectedTab==="sport"),G(),Xe("ngIf",t.selectedTab==="infections"),G(3),wn("Gespeicherte Lebensmittel (",t.date,"):"),G(2),Xe("ngForOf",t.filteredFoodEntries),G(3),wn("Gespeicherte Symptome (",t.date,"):"),G(2),Xe("ngForOf",t.filteredSymptomEntries),G(3),wn("Gespeicherte Pollenbelastung (",t.date,"):"),G(2),Xe("ngForOf",t.filteredPollenEntries),G(3),wn("Gespeicherte Sportaktivit\xE4ten (",t.date,"):"),G(2),Xe("ngForOf",t.filteredSportEntries),G(3),wn("Gespeicherte Infektionen (",t.date,"):"),G(2),Xe("ngForOf",t.filteredInfectionEntries)}}var bo=class n{foodDrink=window.prompt("Enter Password");foodName="";amount="";time=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});date=new Date().toISOString().split("T")[0];symptoms="";pollen="";newMedications="";sport="";infections="";beverages="";editingEntryId=null;selectedTab="food";firestore=Pt(pn);foodEntries$;filteredFoodEntries=[];filteredSymptomEntries=[];filteredPollenEntries=[];filteredSportEntries=[];filteredInfectionEntries=[];constructor(){let e=mn(this.firestore,"food");this.foodEntries$=Pm(e,{idField:"id"}),this.foodEntries$.subscribe(t=>{this.filterEntries(t)})}filterEntries(e){this.filteredFoodEntries=e.filter(t=>t.date===this.date&&t.type==="food"),this.filteredSymptomEntries=e.filter(t=>t.date===this.date&&t.type==="symptoms"),this.filteredPollenEntries=e.filter(t=>t.date===this.date&&t.type==="pollen"),this.filteredSportEntries=e.filter(t=>t.date===this.date&&t.type==="sport"),this.filteredInfectionEntries=e.filter(t=>t.date===this.date&&t.type==="infections")}selectTab(e){this.selectedTab=e}addFood(){return A(this,null,function*(){let e=mn(this.firestore,"food");try{if(this.editingEntryId){let t=Pl(this.firestore,`food/${this.editingEntryId}`);yield Vm(t,{name:this.foodName,amount:this.amount,date:this.date,time:this.time,beverages:this.beverages,type:"food"}),this.editingEntryId=null}else yield rr(e,{name:this.foodName,amount:this.amount,date:this.date,time:this.time,beverages:this.beverages,type:"food"});this.resetForm()}catch(t){console.error("Fehler beim Hinzuf\xFCgen: ",t)}})}addSymptoms(){return A(this,null,function*(){let e=mn(this.firestore,"food");try{yield rr(e,{symptoms:this.symptoms,date:this.date,time:this.time,type:"symptoms"}),this.symptoms=""}catch(t){console.error("Fehler beim Hinzuf\xFCgen: ",t)}})}addPollen(){return A(this,null,function*(){let e=mn(this.firestore,"food");try{yield rr(e,{pollen:this.pollen,date:this.date,time:this.time,type:"pollen"}),this.pollen=""}catch(t){console.error("Fehler beim Hinzuf\xFCgen: ",t)}})}addSports(){return A(this,null,function*(){let e=mn(this.firestore,"food");try{yield rr(e,{sport:this.sport,date:this.date,time:this.time,type:"sport"}),this.sport=""}catch(t){console.error("Fehler beim Hinzuf\xFCgen: ",t)}})}addInfections(){return A(this,null,function*(){let e=mn(this.firestore,"food");try{yield rr(e,{infections:this.infections,date:this.date,time:this.time,type:"infections"}),this.infections=""}catch(t){console.error("Fehler beim Hinzuf\xFCgen: ",t)}})}changeDate(e){let t=new Date(this.date);t.setDate(t.getDate()+e),this.date=t.toISOString().split("T")[0],this.foodEntries$.subscribe(r=>{this.filterEntries(r)})}onDateChange(e){this.date=e.target.value,this.foodEntries$.subscribe(t=>{this.filterEntries(t)})}resetForm(){this.foodName="",this.amount="",this.time=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),this.beverages="",this.sport="",this.infections="",this.editingEntryId=null}editEntry(e){this.foodName=e.name,this.amount=e.amount,this.time=e.time,this.date=e.date,this.beverages=e.beverages,this.symptoms=e.symptoms,this.pollen=e.pollen,this.sport=e.sport,this.infections=e.infections,this.editingEntryId=e.id}deleteEntry(e){return A(this,null,function*(){let t=Pl(this.firestore,`food/${e}`);yield Nm(t)})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Xi({type:n,selectors:[["app-food-entry"]],standalone:!0,features:[es],decls:1,vars:1,consts:[[1,"password"],[1,"container","mt-4"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"btn","btn-outline-secondary","btn-sm","date-button",3,"click"],[1,"bi","bi-chevron-left"],["type","date",1,"form-control","text-center","date-input",3,"ngModelChange","change","ngModel"],[1,"bi","bi-chevron-right"],[1,"nav","nav-tabs","justify-content-center"],[1,"nav-item"],[1,"nav-link",3,"click"],["class","mt-4",4,"ngIf"],[1,"mt-4"],[1,"entry-title"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"needs-validation",3,"ngSubmit"],[1,"form-group","mb-3"],["for","name"],["name","name","id","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","amount"],["name","amount","id","amount","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","beverages"],["name","beverages","id","beverages","placeholder","z.B. Wasser, Saft",1,"form-control",3,"ngModelChange","ngModel"],["for","time"],["type","time","name","time","id","time","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary","btn-block"],["for","symptoms"],["name","symptoms","id","symptoms","placeholder","z.B. Husten, Juckreiz",1,"form-control",3,"ngModelChange","ngModel"],["for","pollen"],["name","pollen","id","pollen","placeholder","z.B. Hoch, Mittel, Niedrig",1,"form-control",3,"ngModelChange","ngModel"],["for","sport"],["name","sport","id","sport","placeholder","z.B. Laufen, Schwimmen",1,"form-control",3,"ngModelChange","ngModel"],["for","infections"],["name","infections","id","infections","placeholder","z.B. Erk\xE4ltung, Grippe",1,"form-control",3,"ngModelChange","ngModel"],[1,"list-group-item"],[1,"btn","btn-sm","btn-warning",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"]],template:function(t,r){t&1&&kt(0,Cw,54,26,"div",0),t&2&&Kh(r.foodDrink=="mahlzeit"?0:-1)},dependencies:[da,od,ad,jd,Bd,fs,Vd,xd,Da,Ra,Ca],styles:['@charset "UTF-8";.full-width-input[_ngcontent-%COMP%]{width:100%}.date-button[_ngcontent-%COMP%]{padding:5px 10px;font-size:1.2rem}@media (max-width: 768px){.date-button[_ngcontent-%COMP%]{width:40px}.date-input[_ngcontent-%COMP%]{width:100%;font-size:.9rem}.form-control[_ngcontent-%COMP%]{font-size:1rem;padding:10px}.btn-block[_ngcontent-%COMP%]{width:100%;font-size:1.2rem}.nav-tabs[_ngcontent-%COMP%]{display:flex;justify-content:space-around}.nav-link[_ngcontent-%COMP%]{font-size:.9rem;padding:8px 5px}.entry-title[_ngcontent-%COMP%]{font-size:1rem}.list-group-item[_ngcontent-%COMP%]{font-size:.9rem}}']})};var So=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Xi({type:n,selectors:[["app-root"]],standalone:!0,features:[es],decls:1,vars:0,template:function(t,r){t&1&&xr(0,"app-food-entry")},dependencies:[bo]})};var xm={production:!1,firebaseConfig:{apiKey:"AIzaSyAf89VEdALukrh9ejFkRg97-zqgudo81Ro",authDomain:"anapylaxy-ki.firebaseapp.com",projectId:"anapylaxy-ki",storageBucket:"anapylaxy-ki.appspot.com",messagingSenderId:"501932509629",appId:"1:501932509629:web:a8a4c393dbe42269e76ad4",measurementId:"G-BPCFRMQXSF"}};var Rw="@",Dw=(()=>{class n{constructor(t,r,i,o,a){this.doc=t,this.delegate=r,this.zone=i,this.animationType=o,this.moduleImpl=a,this._rendererFactoryPromise=null,this.scheduler=Pt(zh,{optional:!0}),this.loadingSchedulerFn=Pt(Pw,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){let t=()=>this.moduleImpl??import("./chunk-VAORFM77.js").then(i=>i),r;return this.loadingSchedulerFn?r=this.loadingSchedulerFn(t):r=t(),r.catch(i=>{throw new pt(5300,!1)}).then(({\u0275createEngine:i,\u0275AnimationRendererFactory:o})=>{this._engine=i(this.animationType,this.doc);let a=new o(this.delegate,this._engine,this.zone);return this.delegate=a,a})}createRenderer(t,r){let i=this.delegate.createRenderer(t,r);if(i.\u0275type===0)return i;typeof i.throwOnSyntheticProps=="boolean"&&(i.throwOnSyntheticProps=!1);let o=new Nl(i);return r?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(a=>{let u=a.createRenderer(t,r);o.use(u),this.scheduler?.notify(10)}).catch(a=>{o.use(i)}),o}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static{this.\u0275fac=function(r){$h()}}static{this.\u0275prov=Ce({token:n,factory:n.\u0275fac})}}return n})(),Nl=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let t of this.replay)t(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,t){this.delegate.appendChild(e,t)}insertBefore(e,t,r,i){this.delegate.insertBefore(e,t,r,i)}removeChild(e,t,r){this.delegate.removeChild(e,t,r)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,r,i){this.delegate.setAttribute(e,t,r,i)}removeAttribute(e,t,r){this.delegate.removeAttribute(e,t,r)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,r,i){this.delegate.setStyle(e,t,r,i)}removeStyle(e,t,r){this.delegate.removeStyle(e,t,r)}setProperty(e,t,r){this.shouldReplay(t)&&this.replay.push(i=>i.setProperty(e,t,r)),this.delegate.setProperty(e,t,r)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,r){return this.shouldReplay(t)&&this.replay.push(i=>i.listen(e,t,r)),this.delegate.listen(e,t,r)}shouldReplay(e){return this.replay!==null&&e.startsWith(Rw)}},Pw=new Ee("");function Om(n="animations"){return Wh("NgAsyncAnimations"),gt([{provide:Zi,useFactory:(e,t,r)=>new Dw(e,t,r,n),deps:[Ze,is,xe]},{provide:Gh,useValue:n==="noop"?"NoopAnimations":"BrowserAnimations"}])}var Ni="Service workers are disabled or not supported by this browser";function Nw(n){return ta(()=>Oh(new Error(n)))}var ir=class{constructor(e){if(this.serviceWorker=e,!e)this.worker=this.events=this.registration=Nw(Ni);else{let r=na(e,"controllerchange").pipe(ze(()=>e.controller)),i=ta(()=>Ji(e.controller)),o=Mh(i,r);this.worker=o.pipe(In(p=>!!p)),this.registration=this.worker.pipe(Sr(()=>e.getRegistration()));let d=na(e,"message").pipe(ze(p=>p.data)).pipe(In(p=>p&&p.type)).pipe(Uh());d.connect(),this.events=d}}postMessage(e,t){return this.worker.pipe(Qt(1),Yi(r=>{r.postMessage(me({action:e},t))})).toPromise().then(()=>{})}postMessageWithOperation(e,t,r){let i=this.waitForOperationCompleted(r),o=this.postMessage(e,t);return Promise.all([o,i]).then(([,a])=>a)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(e){let t;return typeof e=="string"?t=r=>r.type===e:t=r=>e.includes(r.type),this.events.pipe(In(t))}nextEventOfType(e){return this.eventsOfType(e).pipe(Qt(1))}waitForOperationCompleted(e){return this.eventsOfType("OPERATION_COMPLETED").pipe(In(t=>t.nonce===e),Qt(1),ze(t=>{if(t.result!==void 0)return t.result;throw new Error(t.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}},kw=(()=>{class n{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,this.pushManager=null,this.subscriptionChanges=new Qi,!t.isEnabled){this.messages=En,this.notificationClicks=En,this.subscription=En;return}this.messages=this.sw.eventsOfType("PUSH").pipe(ze(i=>i.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(ze(i=>i.data)),this.pushManager=this.sw.registration.pipe(ze(i=>i.pushManager));let r=this.pushManager.pipe(Sr(i=>i.getSubscription()));this.subscription=ra(r,this.subscriptionChanges)}requestSubscription(t){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(Ni));let r={userVisibleOnly:!0},i=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),o=new Uint8Array(new ArrayBuffer(i.length));for(let a=0;a<i.length;a++)o[a]=i.charCodeAt(a);return r.applicationServerKey=o,this.pushManager.pipe(Sr(a=>a.subscribe(r)),Qt(1)).toPromise().then(a=>(this.subscriptionChanges.next(a),a))}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(Ni));let t=r=>{if(r===null)throw new Error("Not subscribed to push notifications.");return r.unsubscribe().then(i=>{if(!i)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})};return this.subscription.pipe(Qt(1),Sr(t)).toPromise()}decodeBase64(t){return atob(t)}static{this.\u0275fac=function(r){return new(r||n)(ce(ir))}}static{this.\u0275prov=Ce({token:n,factory:n.\u0275fac})}}return n})(),Vw=(()=>{class n{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,!t.isEnabled){this.versionUpdates=En,this.unrecoverable=En;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Ni));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Ni));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t)}static{this.\u0275fac=function(r){return new(r||n)(ce(ir))}}static{this.\u0275prov=Ce({token:n,factory:n.\u0275fac})}}return n})();var Mm=new Ee("");function xw(n,e,t,r){return()=>{if(!(fa(r)&&"serviceWorker"in navigator&&t.enabled!==!1))return;let i=n.get(xe),o=n.get(ns);i.runOutsideAngular(()=>{let u=navigator.serviceWorker,h=()=>u.controller?.postMessage({action:"INITIALIZE"});u.addEventListener("controllerchange",h),o.onDestroy(()=>{u.removeEventListener("controllerchange",h)})});let a;if(typeof t.registrationStrategy=="function")a=t.registrationStrategy();else{let[u,...h]=(t.registrationStrategy||"registerWhenStable:30000").split(":");switch(u){case"registerImmediately":a=Ji(null);break;case"registerWithDelay":a=Fm(+h[0]||0);break;case"registerWhenStable":let d=br(n.get(ns).whenStable());a=h[0]?ra(d,Fm(+h[0])):d;break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${t.registrationStrategy}`)}}i.runOutsideAngular(()=>a.pipe(Qt(1)).subscribe(()=>navigator.serviceWorker.register(e,{scope:t.scope}).catch(u=>console.error("Service worker registration failed with:",u))))}}function Fm(n){return Ji(null).pipe(Lh(n))}function Ow(n,e){return new ir(fa(e)&&n.enabled!==!1?navigator.serviceWorker:void 0)}var Pi=class{};function Lm(n,e={}){return gt([kw,Vw,{provide:Mm,useValue:n},{provide:Pi,useValue:e},{provide:ir,useFactory:Ow,deps:[Pi,nt]},{provide:Xh,useFactory:xw,deps:[Jt,Mm,Pi,nt],multi:!0}])}gd(So,{providers:[_f(()=>yf(xm.firebaseConfig)),Dm(()=>km()),Om("noop"),Lm("ngsw-worker.js",{enabled:!Zh(),registrationStrategy:"registerWhenStable:30000"})]}).catch(n=>console.error(n));
